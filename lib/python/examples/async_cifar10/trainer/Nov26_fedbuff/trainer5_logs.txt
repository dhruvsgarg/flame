2023-11-26 00:27:23,241 | metric_collector.py:52 | DEBUG | Thread-2 | gather_gpu_stats | could not start gpustat.nvml.pynvml; no GPU metrics will be collected
2023-11-26 00:27:23,247 | fedadagrad.py:27 | DEBUG | MainThread | FedAdaGrad | Initializing fedadagrad
2023-11-26 00:27:23,247 | fedadam.py:27 | DEBUG | MainThread | FedAdam | Initializing fedadam
2023-11-26 00:27:23,249 | fedyogi.py:27 | DEBUG | MainThread | FedYogi | Initializing fedyogi
2023-11-26 00:27:26,207 | channel_manager.py:72 | INFO | MainThread | __new__ | creating a ChannelManager instance
2023-11-26 00:27:26,207 | selector_events.py:54 | DEBUG | MainThread | __init__ | Using selector: EpollSelector
2023-11-26 00:27:26,210 | mqtt.py:514 | DEBUG | Thread-3 | on_socket_open | Socket opened
2023-11-26 00:27:26,210 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,210 | mqtt.py:546 | DEBUG | Thread-3 | misc_loop | misc_loop started
2023-11-26 00:27:26,210 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,210 | channel_manager.py:146 | INFO | MainThread | join | no backend found for channel param-channel; use default
2023-11-26 00:27:26,210 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,211 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,211 | mqtt.py:294 | DEBUG | Thread-3 | on_connect | calling on_connect
2023-11-26 00:27:26,211 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,211 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,211 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,212 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,212 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/+
2023-11-26 00:27:26,212 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,212 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/+/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375
2023-11-26 00:27:26,212 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,213 | mqtt.py:349 | DEBUG | MainThread | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375
2023-11-26 00:27:26,213 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[internal_init.runtime] = 0.005958080291748047
2023-11-26 00:27:26,213 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,213 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of internal_init is 0.005958080291748047
2023-11-26 00:27:26,213 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,214 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,214 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580375, status: online
2023-11-26 00:27:26,214 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,214 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,255 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,256 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,256 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,256 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,256 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,257 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,257 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580377, status: online
2023-11-26 00:27:26,257 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,257 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,257 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580373, status: online
2023-11-26 00:27:26,258 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,299 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,300 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,300 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580379, status: online
2023-11-26 00:27:26,303 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,303 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,304 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,304 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,306 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,314 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,314 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,314 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,320 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,320 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,321 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,321 | mqtt.py:234 | DEBUG | Thread-3 | _handle_notification | acknowledge notification
2023-11-26 00:27:26,321 | mqtt.py:349 | DEBUG | Thread-3 | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375
2023-11-26 00:27:26,321 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,321 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,322 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:26,322 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:26,323 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,325 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:26,326 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,326 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,327 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,327 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:26,327 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,327 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:26,328 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580380, status: online
2023-11-26 00:27:26,330 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:26,330 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,331 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:26,331 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,331 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,331 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,331 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:26,331 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,332 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,332 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:26,332 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,332 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,332 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,332 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,333 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,336 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:26,337 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,337 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,337 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580378, status: online
2023-11-26 00:27:26,380 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,380 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,380 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580372, status: online
2023-11-26 00:27:26,381 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,381 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,381 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,382 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,382 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,382 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,382 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,382 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,383 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,383 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,383 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,383 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,383 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,422 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,423 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,423 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580376, status: online
2023-11-26 00:27:26,467 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,467 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,468 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,468 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,468 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,468 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,469 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,469 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,469 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,469 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,472 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,473 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,473 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,473 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,473 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,473 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,474 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,474 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,474 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,474 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,475 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,475 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,476 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,476 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,476 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,476 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,476 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,476 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,477 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,477 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
Files already downloaded and verified
2023-11-26 00:27:26,622 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,623 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,623 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580374, status: online
2023-11-26 00:27:26,714 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,714 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,715 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,716 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,716 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,716 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,717 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,717 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,022 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,025 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:27,025 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580371, status: online
2023-11-26 00:27:27,106 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,106 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,107 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,107 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,107 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,107 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,107 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,108 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,108 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,108 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
indices:  tensor([39720, 12022,  8254,  ..., 30671,  6726, 39796])
2023-11-26 00:27:27,173 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[load_data.runtime] = 0.9592506885528564
2023-11-26 00:27:27,173 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of load_data is 0.9592506885528564
2023-11-26 00:27:29,083 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[init.runtime] = 1.9100608825683594
2023-11-26 00:27:29,084 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of init is 1.9100608825683594
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:29,084 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958449.0846736, tag: fetch
2023-11-26 00:27:29,084 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:29,085 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:29,086 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:29,086 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:29,087 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:29,087 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:29,087 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:29,087 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:29,087 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': set()}
2023-11-26 00:27:29,087 | fedbuff.py:165 | DEBUG | Thread-3 | _handle_recv_state | let's select 1 ends
2023-11-26 00:27:29,088 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:29,088 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:29,089 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:29,089 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:29,089 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:29,098 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 1
2023-11-26 00:27:29,098 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:29,098 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 0.014052867889404297
2023-11-26 00:27:29,098 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 0.014052867889404297
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:29,526 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.329067
2023-11-26 00:27:30,248 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.726466
==== completed _train_epoch train()
2023-11-26 00:27:30,425 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3262534141540527
2023-11-26 00:27:30,425 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3262534141540527
2023-11-26 00:27:30,426 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.76837158203125e-06
2023-11-26 00:27:30,426 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.76837158203125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:30,426 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958450.4264486, tag: upload
2023-11-26 00:27:30,426 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:30,427 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:30,427 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:30,428 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:30,428 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:30,428 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:30,428 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:30,429 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:30,429 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:30,429 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:30,429 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:30,429 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:30,429 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:30,429 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:30,446 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:30,446 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:30,447 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:30,447 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:30,454 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,455 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,457 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,457 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,457 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,461 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,461 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,461 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,461 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,462 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,462 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,462 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,462 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:30,462 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:30,464 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,464 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,465 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,465 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,465 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,465 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,465 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,465 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,465 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,466 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,466 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,466 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,466 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:30,466 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:30,466 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,466 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,466 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,467 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,467 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,469 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,469 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,469 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,469 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,469 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,469 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:30,469 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:30,469 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:30,470 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:30,470 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04412555694580078
2023-11-26 00:27:30,470 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04412555694580078
2023-11-26 00:27:30,471 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:30,471 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 131.6
2023-11-26 00:27:30,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 74.8
2023-11-26 00:27:30,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 50.849999999999994
2023-11-26 00:27:30,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 86.9
2023-11-26 00:27:30,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 101.69999999999999
2023-11-26 00:27:30,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 42.04986835379427
2023-11-26 00:27:30,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 68034560
2023-11-26 00:27:30,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1136861184
2023-11-26 00:27:30,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 666423296.0
2023-11-26 00:27:30,476 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 478529536.0
2023-11-26 00:27:30,476 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 577490944.0
2023-11-26 00:27:30,477 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 962758656.0
2023-11-26 00:27:30,477 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 345748689.39653444
2023-11-26 00:27:30,477 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 1881817088
2023-11-26 00:27:30,477 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13703417856
2023-11-26 00:27:30,478 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 8715316662.857143
2023-11-26 00:27:30,478 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 6971234304.0
2023-11-26 00:27:30,478 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 7253139456.0
2023-11-26 00:27:30,479 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 12113186816.0
2023-11-26 00:27:30,479 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 3833982474.8329115
2023-11-26 00:27:30,479 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 0.014052867889404297, 'train.runtime': 1.3262534141540527, 'evaluate.runtime': 4.76837158203125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04412555694580078, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 131.6, 'mean.cpu_utilization': 74.8, '25th_prcntl.cpu_utilization': 50.849999999999994, '50th_prcntl.cpu_utilization': 86.9, '75th_prcntl.cpu_utilization': 101.69999999999999, 'std.cpu_utilization': 42.04986835379427, 'min.cpu_memory_rss': 68034560, 'max.cpu_memory_rss': 1136861184, 'mean.cpu_memory_rss': 666423296.0, '25th_prcntl.cpu_memory_rss': 478529536.0, '50th_prcntl.cpu_memory_rss': 577490944.0, '75th_prcntl.cpu_memory_rss': 962758656.0, 'std.cpu_memory_rss': 345748689.39653444, 'min.cpu_memory_vsz': 1881817088, 'max.cpu_memory_vsz': 13703417856, 'mean.cpu_memory_vsz': 8715316662.857143, '25th_prcntl.cpu_memory_vsz': 6971234304.0, '50th_prcntl.cpu_memory_vsz': 7253139456.0, '75th_prcntl.cpu_memory_vsz': 12113186816.0, 'std.cpu_memory_vsz': 3833982474.8329115}
2023-11-26 00:27:30,480 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:30,480 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009387016296386719
2023-11-26 00:27:30,480 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009387016296386719
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:30,480 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958450.4807336, tag: fetch
2023-11-26 00:27:30,480 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:30,481 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:30,481 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:30,481 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:30,481 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:30,481 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:30,482 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:30,482 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:30,482 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:30,482 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:30,482 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:30,482 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:30,482 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:30,482 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:30,564 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,567 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,568 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,568 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,568 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,568 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:30,569 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,569 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:30,570 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,572 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:30,572 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,574 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,579 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,580 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,580 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,581 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,581 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,581 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:30,581 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,581 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:30,582 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:30,583 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:30,585 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:30,586 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,586 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:30,587 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,592 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:30,592 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:30,602 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 1
2023-11-26 00:27:30,603 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:30,603 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 0.12241625785827637
2023-11-26 00:27:30,603 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 0.12241625785827637
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:30,747 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.340736
2023-11-26 00:27:31,595 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.488916
==== completed _train_epoch train()
2023-11-26 00:27:31,801 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1976318359375
2023-11-26 00:27:31,801 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1976318359375
2023-11-26 00:27:31,801 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:27:31,801 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:31,802 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958451.8020604, tag: upload
2023-11-26 00:27:31,802 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:31,803 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:31,803 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:31,803 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:31,804 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:31,804 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:31,804 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:31,805 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:31,805 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:31,805 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:31,805 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:31,805 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:31,806 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:31,806 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:31,820 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:31,820 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:31,821 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:31,821 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:31,827 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:31,827 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,829 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:31,829 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,829 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,832 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:31,832 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,832 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,833 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:31,833 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,833 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,833 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,833 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:31,834 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:31,835 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:31,835 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,836 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:31,836 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,836 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,837 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:31,837 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,837 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,837 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:31,837 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,837 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,837 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,837 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:31,838 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:31,838 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:31,838 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,838 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:31,838 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,838 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,840 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:31,840 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,840 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,840 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:31,840 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,840 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:31,841 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:31,841 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:31,841 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:31,841 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.039819955825805664
2023-11-26 00:27:31,842 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.039819955825805664
2023-11-26 00:27:31,842 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 65.8
2023-11-26 00:27:31,842 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 65.8
2023-11-26 00:27:31,842 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 65.8
2023-11-26 00:27:31,843 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 65.8
2023-11-26 00:27:31,844 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 65.8
2023-11-26 00:27:31,844 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 65.8
2023-11-26 00:27:31,845 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 0.0
2023-11-26 00:27:31,845 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149829120
2023-11-26 00:27:31,845 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149829120
2023-11-26 00:27:31,845 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149829120.0
2023-11-26 00:27:31,846 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149829120.0
2023-11-26 00:27:31,846 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149829120.0
2023-11-26 00:27:31,846 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149829120.0
2023-11-26 00:27:31,847 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 0.0
2023-11-26 00:27:31,847 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13708099584
2023-11-26 00:27:31,847 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708099584
2023-11-26 00:27:31,847 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13708099584.0
2023-11-26 00:27:31,848 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13708099584.0
2023-11-26 00:27:31,848 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13708099584.0
2023-11-26 00:27:31,849 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13708099584.0
2023-11-26 00:27:31,849 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 0.0
2023-11-26 00:27:31,849 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 0.12241625785827637, 'train.runtime': 1.1976318359375, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.039819955825805664, 'min.cpu_utilization': 65.8, 'max.cpu_utilization': 65.8, 'mean.cpu_utilization': 65.8, '25th_prcntl.cpu_utilization': 65.8, '50th_prcntl.cpu_utilization': 65.8, '75th_prcntl.cpu_utilization': 65.8, 'std.cpu_utilization': 0.0, 'min.cpu_memory_rss': 1149829120, 'max.cpu_memory_rss': 1149829120, 'mean.cpu_memory_rss': 1149829120.0, '25th_prcntl.cpu_memory_rss': 1149829120.0, '50th_prcntl.cpu_memory_rss': 1149829120.0, '75th_prcntl.cpu_memory_rss': 1149829120.0, 'std.cpu_memory_rss': 0.0, 'min.cpu_memory_vsz': 13708099584, 'max.cpu_memory_vsz': 13708099584, 'mean.cpu_memory_vsz': 13708099584.0, '25th_prcntl.cpu_memory_vsz': 13708099584.0, '50th_prcntl.cpu_memory_vsz': 13708099584.0, '75th_prcntl.cpu_memory_vsz': 13708099584.0, 'std.cpu_memory_vsz': 0.0, 'save_metrics.runtime': 0.009387016296386719}
2023-11-26 00:27:31,849 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:31,849 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007759571075439453
2023-11-26 00:27:31,850 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007759571075439453
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:31,850 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958451.8504078, tag: fetch
2023-11-26 00:27:31,850 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:31,850 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:31,851 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:31,851 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:31,851 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:31,851 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:31,851 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:31,851 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:31,851 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:31,852 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:31,852 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:31,852 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:31,852 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:31,852 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:38,878 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:38,882 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:38,882 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:38,882 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:38,883 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:38,886 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:38,886 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:38,887 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:38,887 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:38,887 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:38,887 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:38,889 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:38,890 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:38,891 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:38,891 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:38,891 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:38,891 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:38,892 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:38,892 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:38,893 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:38,894 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:38,894 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:38,895 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:38,895 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:38,895 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:38,895 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:38,895 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:38,897 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:38,897 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:38,907 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 2
2023-11-26 00:27:38,908 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:38,908 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 7.0577943325042725
2023-11-26 00:27:38,908 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 7.0577943325042725
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:39,003 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 0.514203
2023-11-26 00:27:39,828 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.441573
==== completed _train_epoch train()
2023-11-26 00:27:40,009 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1004819869995117
2023-11-26 00:27:40,009 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1004819869995117
2023-11-26 00:27:40,010 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 5.0067901611328125e-06
2023-11-26 00:27:40,010 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 5.0067901611328125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:40,010 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958460.0107572, tag: upload
2023-11-26 00:27:40,011 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:40,012 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:40,012 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:40,012 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:40,012 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:40,013 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:40,013 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:40,013 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:40,013 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:40,013 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:40,013 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:40,013 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:40,013 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:40,013 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:40,025 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154213
2023-11-26 00:27:40,025 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154213
2023-11-26 00:27:40,025 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154213
2023-11-26 00:27:40,026 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:40,028 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:40,029 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,030 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:40,030 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,030 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,033 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:40,033 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,033 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,033 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:40,033 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,033 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,033 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,033 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:40,034 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:40,035 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:40,035 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,036 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:40,036 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,036 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,036 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:40,037 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,037 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,037 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:40,037 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,037 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,037 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,037 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:40,037 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57061
2023-11-26 00:27:40,037 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:40,038 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,038 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:40,038 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,038 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,039 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:40,040 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,040 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,040 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:40,040 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,040 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:40,040 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:40,040 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:40,040 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:40,041 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03065180778503418
2023-11-26 00:27:40,041 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03065180778503418
2023-11-26 00:27:40,042 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:40,042 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 79.9
2023-11-26 00:27:40,043 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 18.41111111111111
2023-11-26 00:27:40,044 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:40,044 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:40,045 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 8.0
2023-11-26 00:27:40,046 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 32.4039244689228
2023-11-26 00:27:40,046 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149841408
2023-11-26 00:27:40,046 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149931520
2023-11-26 00:27:40,047 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149860067.5555556
2023-11-26 00:27:40,047 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149841408.0
2023-11-26 00:27:40,048 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149841408.0
2023-11-26 00:27:40,049 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149841408.0
2023-11-26 00:27:40,049 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 35028.77610419788
2023-11-26 00:27:40,049 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707251712
2023-11-26 00:27:40,050 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707706368
2023-11-26 00:27:40,050 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707308600.88889
2023-11-26 00:27:40,051 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707251712.0
2023-11-26 00:27:40,051 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707251712.0
2023-11-26 00:27:40,052 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707251712.0
2023-11-26 00:27:40,052 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 141764.00638654875
2023-11-26 00:27:40,052 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 7.0577943325042725, 'train.runtime': 1.1004819869995117, 'evaluate.runtime': 5.0067901611328125e-06, 'send.bytes': 2154213, 'upload.runtime': 0.03065180778503418, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 79.9, 'mean.cpu_utilization': 18.41111111111111, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 8.0, 'std.cpu_utilization': 32.4039244689228, 'min.cpu_memory_rss': 1149841408, 'max.cpu_memory_rss': 1149931520, 'mean.cpu_memory_rss': 1149860067.5555556, '25th_prcntl.cpu_memory_rss': 1149841408.0, '50th_prcntl.cpu_memory_rss': 1149841408.0, '75th_prcntl.cpu_memory_rss': 1149841408.0, 'std.cpu_memory_rss': 35028.77610419788, 'min.cpu_memory_vsz': 13707251712, 'max.cpu_memory_vsz': 13707706368, 'mean.cpu_memory_vsz': 13707308600.88889, '25th_prcntl.cpu_memory_vsz': 13707251712.0, '50th_prcntl.cpu_memory_vsz': 13707251712.0, '75th_prcntl.cpu_memory_vsz': 13707251712.0, 'std.cpu_memory_vsz': 141764.00638654875, 'save_metrics.runtime': 0.007759571075439453}
2023-11-26 00:27:40,052 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:40,053 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.011106729507446289
2023-11-26 00:27:40,053 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.011106729507446289
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:40,053 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958460.0534594, tag: fetch
2023-11-26 00:27:40,053 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:40,053 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:40,054 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:40,054 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:40,054 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:40,054 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:40,054 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:40,054 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:40,054 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:40,054 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:40,054 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:40,055 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:40,055 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:40,055 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:58,672 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,674 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,674 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,674 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,674 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,674 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:58,674 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,674 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:27:58,675 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,675 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,676 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:58,678 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,681 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,681 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,681 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,681 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,681 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,681 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:58,681 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,682 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:58,682 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:27:58,682 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:27:58,683 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:58,683 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,684 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:58,684 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,685 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:58,685 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:58,694 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 5
2023-11-26 00:27:58,694 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:58,694 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.641040325164795
2023-11-26 00:27:58,694 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.641040325164795
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:58,791 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.931207
2023-11-26 00:27:59,730 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.581351
==== completed _train_epoch train()
2023-11-26 00:27:59,953 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2587499618530273
2023-11-26 00:27:59,953 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2587499618530273
2023-11-26 00:27:59,954 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:27:59,954 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:59,954 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958479.9545815, tag: upload
2023-11-26 00:27:59,954 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:59,955 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:59,955 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:59,955 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:59,956 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:59,956 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:59,956 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:59,956 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:59,956 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:59,956 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:59,956 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:59,956 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:59,956 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:59,956 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:59,965 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:59,965 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:59,966 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:59,966 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:59,969 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:59,969 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,971 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:59,971 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,971 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,974 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:59,974 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,974 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,974 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:59,974 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,974 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,974 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,974 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:59,975 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:59,976 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:59,976 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,976 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:59,977 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,977 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,977 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:59,978 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,978 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,978 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:59,978 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,978 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,978 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,978 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:59,978 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:59,978 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:59,978 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,978 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:59,978 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,979 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,980 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:59,981 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,981 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,981 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:59,981 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,981 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:59,981 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:59,981 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:59,981 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:59,982 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.02767348289489746
2023-11-26 00:27:59,982 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.02767348289489746
2023-11-26 00:27:59,983 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:59,983 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 21.0
2023-11-26 00:27:59,983 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 1.5789473684210527
2023-11-26 00:27:59,984 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:59,985 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:59,986 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:27:59,987 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 18.951461685052156
2023-11-26 00:27:59,987 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149911040
2023-11-26 00:27:59,987 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150275584
2023-11-26 00:27:59,987 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149947289.6
2023-11-26 00:27:59,988 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149911040.0
2023-11-26 00:27:59,988 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149911040.0
2023-11-26 00:27:59,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149911040.0
2023-11-26 00:27:59,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 108750.72841981336
2023-11-26 00:27:59,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707251712
2023-11-26 00:27:59,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707882496
2023-11-26 00:27:59,990 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707292057.6
2023-11-26 00:27:59,990 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707251712.0
2023-11-26 00:27:59,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707251712.0
2023-11-26 00:27:59,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707251712.0
2023-11-26 00:27:59,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 140775.38461194132
2023-11-26 00:27:59,992 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 18.641040325164795, 'train.runtime': 1.2587499618530273, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.02767348289489746, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 21.0, 'mean.cpu_utilization': 1.5789473684210527, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 18.951461685052156, 'min.cpu_memory_rss': 1149911040, 'max.cpu_memory_rss': 1150275584, 'mean.cpu_memory_rss': 1149947289.6, '25th_prcntl.cpu_memory_rss': 1149911040.0, '50th_prcntl.cpu_memory_rss': 1149911040.0, '75th_prcntl.cpu_memory_rss': 1149911040.0, 'std.cpu_memory_rss': 108750.72841981336, 'min.cpu_memory_vsz': 13707251712, 'max.cpu_memory_vsz': 13707882496, 'mean.cpu_memory_vsz': 13707292057.6, '25th_prcntl.cpu_memory_vsz': 13707251712.0, '50th_prcntl.cpu_memory_vsz': 13707251712.0, '75th_prcntl.cpu_memory_vsz': 13707251712.0, 'std.cpu_memory_vsz': 140775.38461194132, 'save_metrics.runtime': 0.011106729507446289}
2023-11-26 00:27:59,992 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:59,992 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009627342224121094
2023-11-26 00:27:59,992 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009627342224121094
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:59,992 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958479.992711, tag: fetch
2023-11-26 00:27:59,992 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:27:59,993 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:59,993 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:59,993 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:59,993 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:59,993 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:59,993 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:59,993 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:59,993 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:59,994 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:59,994 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:59,994 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:59,994 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:59,994 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:11,782 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,785 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,785 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,785 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,786 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,786 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:28:11,786 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,786 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:28:11,787 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,789 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:11,789 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,790 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,794 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,794 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,795 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,795 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,795 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,796 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:28:11,796 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,796 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:28:11,796 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:28:11,797 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:28:11,799 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:11,799 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,800 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:11,800 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,802 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:11,802 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:11,813 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 7
2023-11-26 00:28:11,813 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:11,814 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.821358680725098
2023-11-26 00:28:11,814 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.821358680725098
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:11,905 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.778590
2023-11-26 00:28:12,743 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.534019
==== completed _train_epoch train()
2023-11-26 00:28:12,950 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1355748176574707
2023-11-26 00:28:12,950 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1355748176574707
2023-11-26 00:28:12,951 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.76837158203125e-06
2023-11-26 00:28:12,951 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.76837158203125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:12,951 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958492.951822, tag: upload
2023-11-26 00:28:12,952 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:28:12,953 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:12,953 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:12,954 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:12,954 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:12,954 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:12,954 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:12,955 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:12,955 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:12,955 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:12,955 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:12,955 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:12,955 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:12,955 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:12,970 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:12,971 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:12,971 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:12,971 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:12,977 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:12,977 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,979 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:12,979 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,980 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,981 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:12,981 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,981 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,982 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:12,982 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,982 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,982 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,982 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:12,982 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:12,984 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:12,984 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,985 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:12,985 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,985 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,985 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:12,985 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,985 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,985 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:12,985 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,985 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,986 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,986 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:12,986 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:12,986 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:12,986 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,986 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:12,986 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,986 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,988 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:12,988 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,988 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,988 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:12,988 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,988 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:12,988 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:12,988 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:12,988 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:12,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.037607669830322266
2023-11-26 00:28:12,989 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.037607669830322266
2023-11-26 00:28:12,990 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:12,990 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 13.0
2023-11-26 00:28:12,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 1.3333333333333333
2023-11-26 00:28:12,992 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:12,992 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:12,993 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:28:12,993 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 3.543381937578216
2023-11-26 00:28:12,994 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150271488
2023-11-26 00:28:12,994 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150668800
2023-11-26 00:28:12,994 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150304597.3333333
2023-11-26 00:28:12,995 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150271488.0
2023-11-26 00:28:12,996 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150271488.0
2023-11-26 00:28:12,996 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150271488.0
2023-11-26 00:28:12,997 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 109811.23572547373
2023-11-26 00:28:12,997 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707427840
2023-11-26 00:28:12,997 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:28:12,997 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707497472.0
2023-11-26 00:28:12,998 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707427840.0
2023-11-26 00:28:12,999 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707427840.0
2023-11-26 00:28:12,999 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707427840.0
2023-11-26 00:28:13,000 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 230943.2174020272
2023-11-26 00:28:13,000 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 11.821358680725098, 'train.runtime': 1.1355748176574707, 'evaluate.runtime': 4.76837158203125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.037607669830322266, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 13.0, 'mean.cpu_utilization': 1.3333333333333333, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 3.543381937578216, 'min.cpu_memory_rss': 1150271488, 'max.cpu_memory_rss': 1150668800, 'mean.cpu_memory_rss': 1150304597.3333333, '25th_prcntl.cpu_memory_rss': 1150271488.0, '50th_prcntl.cpu_memory_rss': 1150271488.0, '75th_prcntl.cpu_memory_rss': 1150271488.0, 'std.cpu_memory_rss': 109811.23572547373, 'min.cpu_memory_vsz': 13707427840, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707497472.0, '25th_prcntl.cpu_memory_vsz': 13707427840.0, '50th_prcntl.cpu_memory_vsz': 13707427840.0, '75th_prcntl.cpu_memory_vsz': 13707427840.0, 'std.cpu_memory_vsz': 230943.2174020272, 'save_metrics.runtime': 0.009627342224121094}
2023-11-26 00:28:13,000 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:13,000 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.010797262191772461
2023-11-26 00:28:13,000 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.010797262191772461
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:13,001 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958493.0011182, tag: fetch
2023-11-26 00:28:13,001 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:28:13,001 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:13,001 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:13,001 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:13,002 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:13,002 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:13,002 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:13,002 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:13,002 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:13,002 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:13,002 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:13,002 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:13,002 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:13,003 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:26,282 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:26,283 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:26,283 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:26,283 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:38,374 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:38,377 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:38,378 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:38,378 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:38,378 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:38,379 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:28:38,379 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:38,379 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:28:38,381 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:38,382 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:38,383 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:38,384 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:38,388 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:38,388 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:38,389 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:38,389 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:38,389 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:38,390 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:28:38,390 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:38,390 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:28:38,391 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:28:38,392 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:28:38,394 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:38,396 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:38,396 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:38,400 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:38,400 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:38,400 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:38,417 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 11
2023-11-26 00:28:38,417 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:38,417 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 25.41684651374817
2023-11-26 00:28:38,418 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 25.41684651374817
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:38,503 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.904601
2023-11-26 00:28:39,336 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.289957
==== completed _train_epoch train()
2023-11-26 00:28:39,517 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.0995607376098633
2023-11-26 00:28:39,518 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.0995607376098633
2023-11-26 00:28:39,518 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:28:39,518 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:39,518 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958519.5188158, tag: upload
2023-11-26 00:28:39,519 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:28:39,519 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:39,520 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:39,520 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:39,521 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:39,521 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:39,521 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:39,521 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:39,521 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:39,521 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:39,521 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:39,521 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:39,522 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:39,522 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:39,539 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:39,539 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:39,540 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:39,540 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:39,544 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:39,544 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,545 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:39,545 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,545 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,548 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:39,548 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,549 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,549 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:39,549 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,549 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,549 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,549 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:39,549 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:39,551 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:39,551 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,552 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:39,552 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,552 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,552 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:39,552 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,552 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,552 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:39,553 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,553 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,553 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,553 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:39,553 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:39,553 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:39,553 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,553 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:39,553 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,553 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,556 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:39,556 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,556 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,556 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:39,556 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,556 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:39,556 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:39,556 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:39,557 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:39,557 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.038691043853759766
2023-11-26 00:28:39,557 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.038691043853759766
2023-11-26 00:28:39,558 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:39,558 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 83.9
2023-11-26 00:28:39,558 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.881481481481482
2023-11-26 00:28:39,559 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:39,560 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:39,560 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:39,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.653916510949717
2023-11-26 00:28:39,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150652416
2023-11-26 00:28:39,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150676992
2023-11-26 00:28:39,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150653326.2222223
2023-11-26 00:28:39,562 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150652416.0
2023-11-26 00:28:39,562 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150652416.0
2023-11-26 00:28:39,563 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150652416.0
2023-11-26 00:28:39,563 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4641.240872816899
2023-11-26 00:28:39,563 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:28:39,564 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:28:39,564 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707825607.11111
2023-11-26 00:28:39,564 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:28:39,565 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:28:39,565 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:28:39,565 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 85862.95614711264
2023-11-26 00:28:39,566 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 25.41684651374817, 'train.runtime': 1.0995607376098633, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.038691043853759766, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 83.9, 'mean.cpu_utilization': 4.881481481481482, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 17.653916510949717, 'min.cpu_memory_rss': 1150652416, 'max.cpu_memory_rss': 1150676992, 'mean.cpu_memory_rss': 1150653326.2222223, '25th_prcntl.cpu_memory_rss': 1150652416.0, '50th_prcntl.cpu_memory_rss': 1150652416.0, '75th_prcntl.cpu_memory_rss': 1150652416.0, 'std.cpu_memory_rss': 4641.240872816899, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707825607.11111, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 85862.95614711264, 'save_metrics.runtime': 0.010797262191772461}
2023-11-26 00:28:39,566 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:39,566 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008722066879272461
2023-11-26 00:28:39,566 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008722066879272461
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:39,567 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958519.5669854, tag: fetch
2023-11-26 00:28:39,567 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:28:39,567 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:39,567 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:39,567 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:39,568 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:39,568 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:39,568 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:39,568 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:39,568 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:39,568 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:39,568 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:39,568 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:39,568 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:39,569 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:51,429 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:51,431 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:51,431 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:51,431 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:51,432 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:51,432 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:28:51,432 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:51,432 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:28:51,432 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:51,433 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:51,433 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:51,435 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:51,438 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:51,438 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:51,438 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:51,438 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:51,438 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:28:51,438 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:51,438 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:28:51,439 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:51,440 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:51,440 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:51,440 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:51,440 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:51,441 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:51,441 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:51,441 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:51,441 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:28:51,441 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:51,441 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:28:51,441 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:51,441 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:51,443 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:51,443 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:51,443 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:51,448 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 13
2023-11-26 00:28:51,448 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:51,448 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.881692171096802
2023-11-26 00:28:51,448 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.881692171096802
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:51,546 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.810805
2023-11-26 00:28:52,424 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.555010
==== completed _train_epoch train()
2023-11-26 00:28:52,617 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1688594818115234
2023-11-26 00:28:52,618 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1688594818115234
2023-11-26 00:28:52,619 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.9311904907226562e-05
2023-11-26 00:28:52,619 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.9311904907226562e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:52,619 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958532.619715, tag: upload
2023-11-26 00:28:52,620 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:28:52,621 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:52,621 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:52,621 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:52,622 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:52,622 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:52,623 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:52,623 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:52,623 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:52,623 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:52,624 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:52,624 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:52,624 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:52,624 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:52,641 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:52,642 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:52,642 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:52,643 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:52,649 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:52,649 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,651 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:52,651 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,652 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,654 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:52,654 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,655 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,655 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:52,655 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,655 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,655 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,655 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:52,655 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:52,657 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:52,657 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,658 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:52,658 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,658 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,659 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:52,659 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,659 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,659 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:52,659 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,659 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,659 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,659 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:52,660 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:52,660 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:52,660 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,660 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:52,660 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,660 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,662 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:52,662 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,662 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,662 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:52,662 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,662 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:52,662 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:52,662 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:52,663 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:52,663 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.0438692569732666
2023-11-26 00:28:52,663 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.0438692569732666
2023-11-26 00:28:52,664 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:52,664 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 48.0
2023-11-26 00:28:52,665 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.223076923076923
2023-11-26 00:28:52,666 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:52,666 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:52,667 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:52,668 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 16.73955030395674
2023-11-26 00:28:52,668 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150664704
2023-11-26 00:28:52,668 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150734336
2023-11-26 00:28:52,668 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150670060.3076923
2023-11-26 00:28:52,669 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150664704.0
2023-11-26 00:28:52,669 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150664704.0
2023-11-26 00:28:52,670 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150664704.0
2023-11-26 00:28:52,671 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 18554.794128097856
2023-11-26 00:28:52,671 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:28:52,671 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13709058048
2023-11-26 00:28:52,671 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707904866.461538
2023-11-26 00:28:52,672 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:28:52,672 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:28:52,673 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:28:52,673 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 332894.835827638
2023-11-26 00:28:52,673 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 11.881692171096802, 'train.runtime': 1.1688594818115234, 'evaluate.runtime': 1.9311904907226562e-05, 'send.bytes': 2154215, 'upload.runtime': 0.0438692569732666, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 48.0, 'mean.cpu_utilization': 7.223076923076923, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 16.73955030395674, 'min.cpu_memory_rss': 1150664704, 'max.cpu_memory_rss': 1150734336, 'mean.cpu_memory_rss': 1150670060.3076923, '25th_prcntl.cpu_memory_rss': 1150664704.0, '50th_prcntl.cpu_memory_rss': 1150664704.0, '75th_prcntl.cpu_memory_rss': 1150664704.0, 'std.cpu_memory_rss': 18554.794128097856, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13709058048, 'mean.cpu_memory_vsz': 13707904866.461538, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 332894.835827638, 'save_metrics.runtime': 0.008722066879272461}
2023-11-26 00:28:52,674 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:52,674 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.010099411010742188
2023-11-26 00:28:52,674 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.010099411010742188
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:52,674 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958532.6745622, tag: fetch
2023-11-26 00:28:52,674 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:28:52,675 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:52,675 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:52,675 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:52,675 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:52,675 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:52,675 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:52,675 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:52,676 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:52,676 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:52,676 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:52,676 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:52,676 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:52,676 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:11,473 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,477 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,477 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,477 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,478 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,481 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,481 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,482 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:11,482 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,482 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,483 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:11,484 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,485 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:11,487 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,487 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,487 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:11,488 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,488 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,488 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:11,489 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,491 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:11,491 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:11,492 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,492 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:11,493 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,493 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:11,493 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,497 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:11,497 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:11,512 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 16
2023-11-26 00:29:11,512 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:11,512 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.838261365890503
2023-11-26 00:29:11,512 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.838261365890503
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:11,603 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 1.502688
2023-11-26 00:29:12,421 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.362979
==== completed _train_epoch train()
2023-11-26 00:29:12,601 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.0887479782104492
2023-11-26 00:29:12,602 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.0887479782104492
2023-11-26 00:29:12,602 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:29:12,603 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:12,603 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958552.6032898, tag: upload
2023-11-26 00:29:12,603 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:12,604 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:12,604 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:12,605 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:12,605 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:12,605 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:12,605 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:12,606 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:12,606 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:12,606 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:12,606 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:12,606 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:12,606 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:12,606 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:12,622 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:12,622 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:12,622 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:12,623 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:12,628 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:12,628 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,630 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:12,630 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,630 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,632 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:12,633 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,633 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,633 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:12,633 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,633 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,633 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,633 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:12,634 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:12,636 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:12,636 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,638 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:12,638 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,638 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,638 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:12,638 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,638 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,638 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:12,638 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,638 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,638 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,638 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:12,639 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:12,639 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:12,639 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,639 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:12,639 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,639 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,641 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:12,641 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,641 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,642 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:12,642 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,642 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:12,642 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:12,642 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:12,642 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:12,643 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.0397951602935791
2023-11-26 00:29:12,643 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.0397951602935791
2023-11-26 00:29:12,643 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:12,643 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 53.9
2023-11-26 00:29:12,644 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.99
2023-11-26 00:29:12,645 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:12,645 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:12,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:29:12,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 14.578439559843156
2023-11-26 00:29:12,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150717952
2023-11-26 00:29:12,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150738432
2023-11-26 00:29:12,647 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150718976.0
2023-11-26 00:29:12,647 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150717952.0
2023-11-26 00:29:12,647 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150717952.0
2023-11-26 00:29:12,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150717952.0
2023-11-26 00:29:12,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4463.51251818565
2023-11-26 00:29:12,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:29:12,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:29:12,649 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707831500.8
2023-11-26 00:29:12,649 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:12,650 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:12,650 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:12,650 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99089.97790372142
2023-11-26 00:29:12,651 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 18.838261365890503, 'train.runtime': 1.0887479782104492, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.0397951602935791, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 53.9, 'mean.cpu_utilization': 4.99, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 14.578439559843156, 'min.cpu_memory_rss': 1150717952, 'max.cpu_memory_rss': 1150738432, 'mean.cpu_memory_rss': 1150718976.0, '25th_prcntl.cpu_memory_rss': 1150717952.0, '50th_prcntl.cpu_memory_rss': 1150717952.0, '75th_prcntl.cpu_memory_rss': 1150717952.0, 'std.cpu_memory_rss': 4463.51251818565, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707831500.8, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 99089.97790372142, 'save_metrics.runtime': 0.010099411010742188}
2023-11-26 00:29:12,651 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:12,651 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007995843887329102
2023-11-26 00:29:12,651 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007995843887329102
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:12,651 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958552.6518407, tag: fetch
2023-11-26 00:29:12,651 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:12,652 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:12,652 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:12,652 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:12,652 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:12,653 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:12,653 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:12,653 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:12,653 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:12,653 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:12,653 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:12,653 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:12,653 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:12,653 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:26,354 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:26,354 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:26,355 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:26,355 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,169 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,173 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,173 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,174 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,175 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,178 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,178 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,178 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,178 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,179 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:31,179 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,180 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:31,181 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,183 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:31,184 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,184 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,184 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:31,184 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,185 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:31,185 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:31,186 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:31,187 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:31,188 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,189 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:31,189 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,193 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:31,193 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:31,208 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 19
2023-11-26 00:29:31,208 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:31,208 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.55691385269165
2023-11-26 00:29:31,208 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.55691385269165
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:31,300 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 1.877603
2023-11-26 00:29:32,040 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.527264
==== completed _train_epoch train()
2023-11-26 00:29:32,222 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.0132958889007568
2023-11-26 00:29:32,222 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.0132958889007568
2023-11-26 00:29:32,223 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:29:32,223 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:32,223 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958572.2235134, tag: upload
2023-11-26 00:29:32,223 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:32,224 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:32,224 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:32,225 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:32,225 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:32,225 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:32,225 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:32,226 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,226 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,226 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:32,226 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,226 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:32,226 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,226 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:32,244 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154213
2023-11-26 00:29:32,244 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154213
2023-11-26 00:29:32,244 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154213
2023-11-26 00:29:32,245 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:32,248 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,249 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,250 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,250 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,251 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,254 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,254 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,254 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,254 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,254 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,254 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,254 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,254 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,255 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:32,256 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,256 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,257 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,257 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,257 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,258 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,258 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,258 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,258 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,258 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,258 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,258 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,258 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,258 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57061
2023-11-26 00:29:32,259 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,259 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,259 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,259 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,259 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,261 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,261 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,261 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,261 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,261 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,261 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,261 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,261 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,262 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:32,262 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03891730308532715
2023-11-26 00:29:32,262 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03891730308532715
2023-11-26 00:29:32,263 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:32,263 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 72.9
2023-11-26 00:29:32,263 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 6.24
2023-11-26 00:29:32,264 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:32,265 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:32,265 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:32,266 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 18.745223391573653
2023-11-26 00:29:32,266 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151602688
2023-11-26 00:29:32,266 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152020480
2023-11-26 00:29:32,266 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151623577.6
2023-11-26 00:29:32,267 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151602688.0
2023-11-26 00:29:32,267 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151602688.0
2023-11-26 00:29:32,268 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151602688.0
2023-11-26 00:29:32,268 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 91055.65537098725
2023-11-26 00:29:32,268 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:29:32,268 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:29:32,268 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707831500.8
2023-11-26 00:29:32,269 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:32,269 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:32,270 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:32,270 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99089.97790372142
2023-11-26 00:29:32,270 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 18.55691385269165, 'train.runtime': 1.0132958889007568, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154213, 'upload.runtime': 0.03891730308532715, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 72.9, 'mean.cpu_utilization': 6.24, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 18.745223391573653, 'min.cpu_memory_rss': 1151602688, 'max.cpu_memory_rss': 1152020480, 'mean.cpu_memory_rss': 1151623577.6, '25th_prcntl.cpu_memory_rss': 1151602688.0, '50th_prcntl.cpu_memory_rss': 1151602688.0, '75th_prcntl.cpu_memory_rss': 1151602688.0, 'std.cpu_memory_rss': 91055.65537098725, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707831500.8, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 99089.97790372142, 'save_metrics.runtime': 0.007995843887329102}
2023-11-26 00:29:32,271 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:32,271 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008293390274047852
2023-11-26 00:29:32,271 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008293390274047852
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:32,271 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958572.2717113, tag: fetch
2023-11-26 00:29:32,271 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:32,272 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:32,272 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:32,272 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:32,272 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:32,272 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:32,272 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:32,273 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,273 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,273 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:32,273 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:32,273 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,273 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:32,273 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:37,937 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:37,939 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:37,939 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:37,939 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:37,939 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:37,939 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:37,939 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:37,939 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:37,940 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:37,941 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:37,941 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:37,942 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:37,944 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:37,944 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:37,944 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:37,944 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:37,944 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:37,944 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:37,944 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:37,945 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:37,945 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:37,945 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:37,946 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:37,946 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:37,947 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:37,947 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:37,949 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:37,949 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:37,954 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 20
2023-11-26 00:29:37,955 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:37,955 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 5.683504581451416
2023-11-26 00:29:37,955 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 5.683504581451416
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:38,092 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 1.797485
2023-11-26 00:29:38,851 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.482681
==== completed _train_epoch train()
2023-11-26 00:29:39,024 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.069092035293579
2023-11-26 00:29:39,024 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.069092035293579
2023-11-26 00:29:39,025 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:29:39,025 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:39,025 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958579.0256174, tag: upload
2023-11-26 00:29:39,025 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:39,026 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:39,027 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:39,027 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:39,028 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:39,028 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:39,028 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:39,028 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:39,028 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:39,028 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:39,028 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:39,029 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:39,029 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:39,029 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:39,043 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:39,043 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:39,043 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:39,045 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:39,051 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:39,051 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,052 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:39,053 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,053 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,055 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:39,055 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,055 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,055 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:39,055 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,056 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,056 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,056 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:39,056 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:39,058 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:39,058 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,059 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:39,059 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,059 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,059 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:39,059 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,059 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,059 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:39,059 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,059 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,060 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,060 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:39,060 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:39,060 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:39,060 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,060 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:39,060 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,060 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,063 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:39,063 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,063 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,064 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:39,064 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,064 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:39,064 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:39,064 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:39,064 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:39,064 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03935122489929199
2023-11-26 00:29:39,065 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03935122489929199
2023-11-26 00:29:39,065 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:39,065 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 12.0
2023-11-26 00:29:39,066 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 3.5
2023-11-26 00:29:39,066 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:39,067 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.5
2023-11-26 00:29:39,067 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 6.25
2023-11-26 00:29:39,068 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 4.752192476461084
2023-11-26 00:29:39,068 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151655936
2023-11-26 00:29:39,068 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152614400
2023-11-26 00:29:39,068 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151815680.0
2023-11-26 00:29:39,069 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151655936.0
2023-11-26 00:29:39,069 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151655936.0
2023-11-26 00:29:39,070 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151655936.0
2023-11-26 00:29:39,070 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 357198.4429977264
2023-11-26 00:29:39,070 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:29:39,070 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:29:39,070 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707884544.0
2023-11-26 00:29:39,071 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:39,071 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:39,072 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:39,072 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 169440.28706302406
2023-11-26 00:29:39,072 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 5.683504581451416, 'train.runtime': 1.069092035293579, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03935122489929199, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 12.0, 'mean.cpu_utilization': 3.5, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.5, '75th_prcntl.cpu_utilization': 6.25, 'std.cpu_utilization': 4.752192476461084, 'min.cpu_memory_rss': 1151655936, 'max.cpu_memory_rss': 1152614400, 'mean.cpu_memory_rss': 1151815680.0, '25th_prcntl.cpu_memory_rss': 1151655936.0, '50th_prcntl.cpu_memory_rss': 1151655936.0, '75th_prcntl.cpu_memory_rss': 1151655936.0, 'std.cpu_memory_rss': 357198.4429977264, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707884544.0, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 169440.28706302406, 'save_metrics.runtime': 0.008293390274047852}
2023-11-26 00:29:39,073 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:39,073 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007834196090698242
2023-11-26 00:29:39,073 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007834196090698242
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:39,073 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958579.0735407, tag: fetch
2023-11-26 00:29:39,073 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:39,074 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:39,074 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:39,074 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:39,074 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:39,074 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:39,074 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:39,075 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:39,075 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:39,075 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:39,075 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:39,075 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:39,075 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:39,075 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:51,257 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,261 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,261 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,262 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,263 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,266 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,266 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,267 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:51,267 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,267 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,267 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:29:51,269 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,270 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:51,272 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,272 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,272 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:51,272 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,272 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,272 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:29:51,273 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,275 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:51,275 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:51,275 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,276 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:29:51,276 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,276 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:51,278 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,279 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:51,279 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:51,285 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 22
2023-11-26 00:29:51,286 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:51,286 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 12.212719917297363
2023-11-26 00:29:51,286 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 12.212719917297363
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:51,357 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 0.973793
2023-11-26 00:29:52,183 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.545129
==== completed _train_epoch train()
2023-11-26 00:29:52,360 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.0743415355682373
2023-11-26 00:29:52,361 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.0743415355682373
2023-11-26 00:29:52,361 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:29:52,361 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:52,361 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958592.361916, tag: upload
2023-11-26 00:29:52,362 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:52,362 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:52,363 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:52,363 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:52,364 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:52,364 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:52,364 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:52,364 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:52,364 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:52,364 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:52,364 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:52,364 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:52,365 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:52,365 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:52,380 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:52,380 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:52,381 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:52,382 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:52,386 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:52,386 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,387 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:52,388 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,388 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,391 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:52,391 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,391 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,391 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:52,391 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,391 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,391 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,391 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:52,392 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:52,394 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:52,394 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,395 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:52,395 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,395 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,395 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:52,396 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,396 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,396 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:52,396 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,396 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,396 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,396 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:52,396 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:52,396 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:52,396 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,397 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:52,397 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,397 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,399 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:52,399 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,399 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,399 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:52,399 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,399 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:52,399 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:52,399 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:52,400 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:52,400 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.038634538650512695
2023-11-26 00:29:52,400 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.038634538650512695
2023-11-26 00:29:52,401 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:52,401 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 77.8
2023-11-26 00:29:52,401 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 10.835714285714285
2023-11-26 00:29:52,402 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:52,402 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:52,403 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.75
2023-11-26 00:29:52,403 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 26.159773020609258
2023-11-26 00:29:52,403 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152598016
2023-11-26 00:29:52,404 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152663552
2023-11-26 00:29:52,404 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152602697.142857
2023-11-26 00:29:52,404 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152598016.0
2023-11-26 00:29:52,405 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152598016.0
2023-11-26 00:29:52,405 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152598016.0
2023-11-26 00:29:52,405 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 16878.100599200574
2023-11-26 00:29:52,406 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:29:52,406 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:29:52,406 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707841243.428572
2023-11-26 00:29:52,406 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:52,407 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:52,407 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:29:52,408 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 117091.82290695395
2023-11-26 00:29:52,408 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 12.212719917297363, 'train.runtime': 1.0743415355682373, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.038634538650512695, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 77.8, 'mean.cpu_utilization': 10.835714285714285, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.75, 'std.cpu_utilization': 26.159773020609258, 'min.cpu_memory_rss': 1152598016, 'max.cpu_memory_rss': 1152663552, 'mean.cpu_memory_rss': 1152602697.142857, '25th_prcntl.cpu_memory_rss': 1152598016.0, '50th_prcntl.cpu_memory_rss': 1152598016.0, '75th_prcntl.cpu_memory_rss': 1152598016.0, 'std.cpu_memory_rss': 16878.100599200574, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707841243.428572, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 117091.82290695395, 'save_metrics.runtime': 0.007834196090698242}
2023-11-26 00:29:52,408 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:52,408 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.00782155990600586
2023-11-26 00:29:52,408 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.00782155990600586
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:52,409 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958592.409148, tag: fetch
2023-11-26 00:29:52,409 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:29:52,409 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:52,409 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:52,409 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:52,410 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:52,410 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:52,410 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:52,410 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:52,410 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:52,410 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:52,410 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:52,410 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:52,410 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:52,410 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:04,655 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,657 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,657 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,657 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,658 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,658 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:04,658 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,658 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:04,658 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,659 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:04,660 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,661 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,662 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,663 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,663 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,663 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,663 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:04,663 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,663 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:04,664 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,665 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:04,665 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,665 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,665 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,665 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,665 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,665 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,666 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:04,666 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,666 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:04,666 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,666 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:04,666 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,669 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:04,669 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:04,681 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 24
2023-11-26 00:30:04,682 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:04,683 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 12.274793863296509
2023-11-26 00:30:04,684 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 12.274793863296509
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:04,811 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 1.923248
2023-11-26 00:30:05,658 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.358530
==== completed _train_epoch train()
2023-11-26 00:30:05,834 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1503968238830566
2023-11-26 00:30:05,835 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1503968238830566
2023-11-26 00:30:05,835 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:30:05,835 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:05,835 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958605.8358655, tag: upload
2023-11-26 00:30:05,836 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:05,836 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:05,837 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:05,837 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:05,837 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:05,838 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:05,838 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:05,838 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:05,838 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,838 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:05,838 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:05,838 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:05,838 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,839 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:05,855 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:05,856 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:05,856 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:05,857 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:05,861 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,862 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,863 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,863 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,863 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,867 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,867 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,867 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,867 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,867 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,867 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,867 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,867 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:05,868 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:05,869 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,869 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,871 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,871 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,871 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,871 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,871 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,872 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,872 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,872 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,872 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:05,872 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:05,872 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,873 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,873 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,873 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,875 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,875 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,875 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,875 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,875 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,876 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,876 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,876 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:05,876 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:05,876 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04095935821533203
2023-11-26 00:30:05,876 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04095935821533203
2023-11-26 00:30:05,877 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:05,877 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 37.9
2023-11-26 00:30:05,877 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.676923076923076
2023-11-26 00:30:05,878 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:05,879 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:05,879 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:05,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 11.206670667759507
2023-11-26 00:30:05,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152647168
2023-11-26 00:30:05,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152663552
2023-11-26 00:30:05,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152648428.3076923
2023-11-26 00:30:05,881 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152647168.0
2023-11-26 00:30:05,881 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152647168.0
2023-11-26 00:30:05,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152647168.0
2023-11-26 00:30:05,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4365.833912493613
2023-11-26 00:30:05,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:30:05,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:30:05,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707843741.538462
2023-11-26 00:30:05,883 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:05,883 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:05,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:05,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 121151.89107169777
2023-11-26 00:30:05,884 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 12.274793863296509, 'train.runtime': 1.1503968238830566, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04095935821533203, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 37.9, 'mean.cpu_utilization': 4.676923076923076, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 11.206670667759507, 'min.cpu_memory_rss': 1152647168, 'max.cpu_memory_rss': 1152663552, 'mean.cpu_memory_rss': 1152648428.3076923, '25th_prcntl.cpu_memory_rss': 1152647168.0, '50th_prcntl.cpu_memory_rss': 1152647168.0, '75th_prcntl.cpu_memory_rss': 1152647168.0, 'std.cpu_memory_rss': 4365.833912493613, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707843741.538462, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 121151.89107169777, 'save_metrics.runtime': 0.00782155990600586}
2023-11-26 00:30:05,884 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:05,885 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007912635803222656
2023-11-26 00:30:05,885 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007912635803222656
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:05,885 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958605.8854952, tag: fetch
2023-11-26 00:30:05,885 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:05,886 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:05,886 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:05,886 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:05,886 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:05,886 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:05,886 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:05,887 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:05,887 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,887 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:05,887 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:05,887 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,887 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:05,887 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:17,643 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,645 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,645 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,646 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,646 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,646 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:17,646 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,646 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:17,647 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,648 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,648 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:17,652 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,654 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,654 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,654 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,654 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,655 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,655 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,655 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,655 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,655 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:17,655 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,656 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:17,656 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,657 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:17,657 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,658 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,658 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:17,658 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,658 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:17,658 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,658 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:17,658 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,660 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:17,660 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:17,666 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 26
2023-11-26 00:30:17,666 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:17,666 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.780901670455933
2023-11-26 00:30:17,666 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.780901670455933
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:17,768 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.490207
2023-11-26 00:30:18,591 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.526693
==== completed _train_epoch train()
2023-11-26 00:30:18,747 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.0806455612182617
2023-11-26 00:30:18,747 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.0806455612182617
2023-11-26 00:30:18,747 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 2.6226043701171875e-06
2023-11-26 00:30:18,747 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 2.6226043701171875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:18,747 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958618.7478602, tag: upload
2023-11-26 00:30:18,747 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:18,748 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:18,748 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:18,749 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:18,749 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:18,749 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:18,749 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:18,749 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:18,749 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,750 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:18,750 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:18,750 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:18,750 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,750 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:18,760 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:18,761 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:18,761 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:18,762 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:18,766 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,766 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,768 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,768 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,768 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,771 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,771 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,771 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,771 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,771 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,771 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,772 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,772 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:18,772 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:18,773 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,773 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,774 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,774 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,774 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,775 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,775 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,775 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,775 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,775 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,775 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,775 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,775 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:18,775 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:18,776 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,776 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,776 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,776 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,776 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,778 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,778 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,778 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,778 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,778 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,778 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,778 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,778 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:18,779 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:18,779 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.031677961349487305
2023-11-26 00:30:18,779 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.031677961349487305
2023-11-26 00:30:18,780 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:18,780 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 59.9
2023-11-26 00:30:18,780 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.446153846153846
2023-11-26 00:30:18,781 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:18,782 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:18,782 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:18,782 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.88216194916966
2023-11-26 00:30:18,783 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152647168
2023-11-26 00:30:18,783 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152794624
2023-11-26 00:30:18,783 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152658510.7692308
2023-11-26 00:30:18,784 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152647168.0
2023-11-26 00:30:18,784 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152647168.0
2023-11-26 00:30:18,784 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152647168.0
2023-11-26 00:30:18,785 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 39292.50521244252
2023-11-26 00:30:18,785 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:30:18,785 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708660736
2023-11-26 00:30:18,785 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707874304.0
2023-11-26 00:30:18,786 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:18,786 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:18,786 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:18,787 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 227023.36344966787
2023-11-26 00:30:18,787 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 11.780901670455933, 'train.runtime': 1.0806455612182617, 'evaluate.runtime': 2.6226043701171875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.031677961349487305, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 59.9, 'mean.cpu_utilization': 7.446153846153846, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 17.88216194916966, 'min.cpu_memory_rss': 1152647168, 'max.cpu_memory_rss': 1152794624, 'mean.cpu_memory_rss': 1152658510.7692308, '25th_prcntl.cpu_memory_rss': 1152647168.0, '50th_prcntl.cpu_memory_rss': 1152647168.0, '75th_prcntl.cpu_memory_rss': 1152647168.0, 'std.cpu_memory_rss': 39292.50521244252, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708660736, 'mean.cpu_memory_vsz': 13707874304.0, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 227023.36344966787, 'save_metrics.runtime': 0.007912635803222656}
2023-11-26 00:30:18,787 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:18,788 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008071422576904297
2023-11-26 00:30:18,788 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008071422576904297
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:18,788 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958618.7884574, tag: fetch
2023-11-26 00:30:18,788 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:18,788 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:18,789 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:18,789 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:18,789 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:18,789 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:18,789 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:18,789 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:18,790 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,790 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:18,790 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:18,790 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,790 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:18,790 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:26,441 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:26,441 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:26,441 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:26,441 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:37,948 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:37,950 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:37,951 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:37,951 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:37,951 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:37,951 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:37,951 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:37,951 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:37,952 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:37,953 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:37,953 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:37,958 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:37,962 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:37,962 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:37,962 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:37,962 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:37,963 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:37,963 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:37,963 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:37,964 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:37,965 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:37,965 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:37,973 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:37,973 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:37,974 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:37,974 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:37,974 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:37,974 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:37,974 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:37,974 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:37,975 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:37,975 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:37,975 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:37,978 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:37,978 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:37,988 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 29
2023-11-26 00:30:37,988 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:37,988 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 19.200489044189453
2023-11-26 00:30:37,988 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 19.200489044189453
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:38,064 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 0.942484
2023-11-26 00:30:38,886 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.130639
==== completed _train_epoch train()
2023-11-26 00:30:39,089 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1000077724456787
2023-11-26 00:30:39,089 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1000077724456787
2023-11-26 00:30:39,090 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.0531158447265625e-06
2023-11-26 00:30:39,090 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.0531158447265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:39,090 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958639.0903072, tag: upload
2023-11-26 00:30:39,090 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:39,091 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:39,091 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:39,091 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:39,092 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:39,092 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:39,092 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:39,092 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:39,092 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,092 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:39,092 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:39,092 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:39,092 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,092 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:39,102 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:39,103 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:39,103 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:39,103 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:39,108 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,108 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,109 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,109 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,109 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,113 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,113 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,113 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,113 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,113 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,113 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,113 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,113 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:39,114 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:39,115 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,115 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,116 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,116 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,116 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,117 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,117 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,117 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,117 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,117 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,117 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,117 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,117 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:39,117 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:39,117 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,118 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,118 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,118 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,118 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,120 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,120 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,120 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,120 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,120 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,120 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,120 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,120 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:39,120 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:39,121 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.030953407287597656
2023-11-26 00:30:39,121 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.030953407287597656
2023-11-26 00:30:39,121 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:39,122 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 49.9
2023-11-26 00:30:39,122 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 3.345
2023-11-26 00:30:39,123 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:39,123 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:39,124 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:39,124 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 11.165190325292267
2023-11-26 00:30:39,124 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152778240
2023-11-26 00:30:39,125 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152794624
2023-11-26 00:30:39,125 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152779059.2
2023-11-26 00:30:39,125 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152778240.0
2023-11-26 00:30:39,126 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152778240.0
2023-11-26 00:30:39,126 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152778240.0
2023-11-26 00:30:39,126 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3570.8100145485196
2023-11-26 00:30:39,127 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:30:39,127 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:30:39,127 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707831500.8
2023-11-26 00:30:39,127 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:39,128 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:39,128 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:39,129 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99089.97790372142
2023-11-26 00:30:39,129 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 19.200489044189453, 'train.runtime': 1.1000077724456787, 'evaluate.runtime': 4.0531158447265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.030953407287597656, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 49.9, 'mean.cpu_utilization': 3.345, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 11.165190325292267, 'min.cpu_memory_rss': 1152778240, 'max.cpu_memory_rss': 1152794624, 'mean.cpu_memory_rss': 1152779059.2, '25th_prcntl.cpu_memory_rss': 1152778240.0, '50th_prcntl.cpu_memory_rss': 1152778240.0, '75th_prcntl.cpu_memory_rss': 1152778240.0, 'std.cpu_memory_rss': 3570.8100145485196, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707831500.8, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 99089.97790372142, 'save_metrics.runtime': 0.008071422576904297}
2023-11-26 00:30:39,129 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:39,129 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008027076721191406
2023-11-26 00:30:39,129 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008027076721191406
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:39,130 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958639.1300337, tag: fetch
2023-11-26 00:30:39,130 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:39,130 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:39,130 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:39,130 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:39,131 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:39,131 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:39,131 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:39,131 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:39,131 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,131 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:39,131 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:39,131 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,131 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:39,132 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:57,523 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:57,525 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:57,525 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:57,525 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:57,526 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:57,526 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:57,526 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:57,526 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:30:57,527 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:57,528 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:57,527 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:57,529 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:57,532 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:57,532 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:57,532 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:57,532 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:57,532 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:57,532 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:57,532 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:30:57,534 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:57,535 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:57,536 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:57,536 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:57,536 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:57,536 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:57,536 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:57,537 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:57,537 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:57,537 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:57,537 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:30:57,537 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:57,537 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:57,537 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:57,539 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:57,539 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:57,546 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 32
2023-11-26 00:30:57,546 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:57,546 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.416417837142944
2023-11-26 00:30:57,546 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.416417837142944
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:57,630 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 2.847850
2023-11-26 00:30:58,306 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.433084
==== completed _train_epoch train()
2023-11-26 00:30:58,476 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 0.9294192790985107
2023-11-26 00:30:58,476 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 0.9294192790985107
2023-11-26 00:30:58,477 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:30:58,477 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:58,477 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958658.4775276, tag: upload
2023-11-26 00:30:58,478 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:58,479 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:58,479 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:58,479 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:58,480 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:58,480 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:58,480 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:58,480 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:58,480 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:58,480 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:58,481 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:58,481 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:58,481 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:58,481 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:58,496 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:58,497 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:58,497 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:58,498 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:58,503 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:58,503 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,505 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:58,506 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,506 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,508 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:58,509 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,509 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,509 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:58,509 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,509 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,509 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,509 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:58,509 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:58,511 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:58,511 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,512 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:58,512 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,512 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,512 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:58,512 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,513 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,513 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:58,513 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,513 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,513 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,513 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:58,513 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:58,513 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:58,513 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,514 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:58,514 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,514 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,517 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:58,517 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,517 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,517 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:58,517 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,517 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:58,517 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:58,517 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:58,518 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:58,518 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.040994882583618164
2023-11-26 00:30:58,518 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.040994882583618164
2023-11-26 00:30:58,519 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:58,519 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 73.9
2023-11-26 00:30:58,519 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 6.640000000000001
2023-11-26 00:30:58,520 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:58,521 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:58,521 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:30:58,521 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 19.63062403491035
2023-11-26 00:30:58,522 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152778240
2023-11-26 00:30:58,522 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152798720
2023-11-26 00:30:58,522 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152779878.4
2023-11-26 00:30:58,522 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152778240.0
2023-11-26 00:30:58,523 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152778240.0
2023-11-26 00:30:58,523 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152778240.0
2023-11-26 00:30:58,524 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4561.112566030354
2023-11-26 00:30:58,524 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:30:58,524 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:30:58,524 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707831500.8
2023-11-26 00:30:58,525 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:58,525 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:58,525 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:30:58,526 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99089.97790372142
2023-11-26 00:30:58,526 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 18.416417837142944, 'train.runtime': 0.9294192790985107, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.040994882583618164, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 73.9, 'mean.cpu_utilization': 6.640000000000001, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 19.63062403491035, 'min.cpu_memory_rss': 1152778240, 'max.cpu_memory_rss': 1152798720, 'mean.cpu_memory_rss': 1152779878.4, '25th_prcntl.cpu_memory_rss': 1152778240.0, '50th_prcntl.cpu_memory_rss': 1152778240.0, '75th_prcntl.cpu_memory_rss': 1152778240.0, 'std.cpu_memory_rss': 4561.112566030354, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707831500.8, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 99089.97790372142, 'save_metrics.runtime': 0.008027076721191406}
2023-11-26 00:30:58,526 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:58,526 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007982254028320312
2023-11-26 00:30:58,526 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007982254028320312
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:58,527 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958658.5272245, tag: fetch
2023-11-26 00:30:58,527 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:30:58,527 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:58,527 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:58,528 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:58,528 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:58,528 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:58,528 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:58,528 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:58,528 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:58,529 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:58,529 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:58,529 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:58,529 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:58,529 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:17,192 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,196 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,197 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,197 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,199 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,202 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,203 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,203 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,204 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,204 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:31:17,204 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,205 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:31:17,206 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,208 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:17,209 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,209 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,210 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:31:17,210 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,210 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:31:17,211 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:31:17,212 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:31:17,214 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:17,214 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,215 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:17,216 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,219 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:17,220 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:17,234 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 35
2023-11-26 00:31:17,235 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:17,235 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.708153247833252
2023-11-26 00:31:17,235 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.708153247833252
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:17,327 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 1.974566
2023-11-26 00:31:18,195 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.276621
==== completed _train_epoch train()
2023-11-26 00:31:18,384 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.148970603942871
2023-11-26 00:31:18,385 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.148970603942871
2023-11-26 00:31:18,385 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:31:18,385 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:18,385 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958678.385845, tag: upload
2023-11-26 00:31:18,386 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:31:18,386 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:18,386 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:18,386 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:18,387 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:18,387 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:18,387 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:18,387 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:18,387 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,387 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:18,387 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:18,387 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:18,387 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,387 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:18,400 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:18,400 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:18,401 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:18,401 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:18,405 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,405 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,407 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,407 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,407 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,410 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,410 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,410 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,410 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,411 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,411 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,411 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,411 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:18,411 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:18,412 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,412 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,413 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,413 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,413 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,414 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,414 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,414 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,414 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,414 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,414 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,415 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,415 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:18,415 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:18,415 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,415 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,415 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,415 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,415 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,417 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,418 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,418 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,418 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,418 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,418 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,418 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,418 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:18,418 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:18,419 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03324627876281738
2023-11-26 00:31:18,419 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03324627876281738
2023-11-26 00:31:18,419 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:18,419 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 72.9
2023-11-26 00:31:18,420 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.340000000000001
2023-11-26 00:31:18,421 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:18,421 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:18,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:31:18,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 16.362010878862048
2023-11-26 00:31:18,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152790528
2023-11-26 00:31:18,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152806912
2023-11-26 00:31:18,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152791347.2
2023-11-26 00:31:18,423 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152790528.0
2023-11-26 00:31:18,423 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152790528.0
2023-11-26 00:31:18,424 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152790528.0
2023-11-26 00:31:18,424 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3570.8100145485196
2023-11-26 00:31:18,424 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:31:18,425 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:31:18,425 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707834368.0
2023-11-26 00:31:18,425 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:18,426 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:18,426 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:18,426 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99220.26322077563
2023-11-26 00:31:18,427 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 18.708153247833252, 'train.runtime': 1.148970603942871, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03324627876281738, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 72.9, 'mean.cpu_utilization': 5.340000000000001, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 16.362010878862048, 'min.cpu_memory_rss': 1152790528, 'max.cpu_memory_rss': 1152806912, 'mean.cpu_memory_rss': 1152791347.2, '25th_prcntl.cpu_memory_rss': 1152790528.0, '50th_prcntl.cpu_memory_rss': 1152790528.0, '75th_prcntl.cpu_memory_rss': 1152790528.0, 'std.cpu_memory_rss': 3570.8100145485196, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707834368.0, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 99220.26322077563, 'save_metrics.runtime': 0.007982254028320312}
2023-11-26 00:31:18,427 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:18,427 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007959604263305664
2023-11-26 00:31:18,427 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007959604263305664
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:18,427 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958678.427864, tag: fetch
2023-11-26 00:31:18,428 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:31:18,428 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:18,428 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:18,428 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:18,428 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:18,428 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:18,429 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:18,429 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:18,429 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,429 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:18,429 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:18,429 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,429 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:18,429 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:26,510 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:26,511 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:26,511 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:26,512 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,110 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,114 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,115 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,115 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,117 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,120 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,120 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,120 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,121 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,121 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:31:30,121 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,122 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:31:30,123 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,124 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:30,125 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,125 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,126 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:31:30,126 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,126 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:31:30,126 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:31:30,127 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:31:30,129 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:30,129 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,130 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:30,130 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,133 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:30,133 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:30,141 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 37
2023-11-26 00:31:30,141 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:30,141 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.713612079620361
2023-11-26 00:31:30,141 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.713612079620361
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:30,244 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 1.532542
2023-11-26 00:31:31,111 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.420404
==== completed _train_epoch train()
2023-11-26 00:31:31,316 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1748378276824951
2023-11-26 00:31:31,317 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1748378276824951
2023-11-26 00:31:31,317 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 5.245208740234375e-06
2023-11-26 00:31:31,317 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 5.245208740234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:31,318 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958691.318159, tag: upload
2023-11-26 00:31:31,318 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:31:31,319 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:31,319 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:31,320 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:31,320 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:31,320 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:31,320 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:31,321 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:31,321 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:31,321 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:31,321 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:31,321 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:31,321 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:31,321 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:31,336 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:31,336 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:31,336 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:31,338 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:31,344 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:31,344 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,345 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:31,346 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,346 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,349 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:31,349 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,349 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,349 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:31,349 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,349 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,349 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,350 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:31,350 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:31,351 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:31,352 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,352 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:31,353 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,353 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,353 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:31,353 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,353 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,353 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:31,353 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,353 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,353 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,353 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:31,353 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:31,354 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:31,354 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,354 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:31,354 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,354 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,356 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:31,356 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,356 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,356 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:31,356 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,356 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:31,357 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:31,357 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:31,357 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:31,357 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.0395810604095459
2023-11-26 00:31:31,357 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.0395810604095459
2023-11-26 00:31:31,358 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:31,358 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 80.8
2023-11-26 00:31:31,359 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.138461538461538
2023-11-26 00:31:31,360 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:31,361 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:31,361 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:31:31,362 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 21.40559015633132
2023-11-26 00:31:31,362 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152790528
2023-11-26 00:31:31,362 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1153650688
2023-11-26 00:31:31,363 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152922860.3076923
2023-11-26 00:31:31,363 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152790528.0
2023-11-26 00:31:31,364 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152790528.0
2023-11-26 00:31:31,365 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152790528.0
2023-11-26 00:31:31,365 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 310346.7707669016
2023-11-26 00:31:31,365 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:31:31,365 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:31:31,366 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707878715.076923
2023-11-26 00:31:31,366 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:31,367 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:31,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:31,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 164040.43597679088
2023-11-26 00:31:31,368 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 11.713612079620361, 'train.runtime': 1.1748378276824951, 'evaluate.runtime': 5.245208740234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.0395810604095459, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 80.8, 'mean.cpu_utilization': 8.138461538461538, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 21.40559015633132, 'min.cpu_memory_rss': 1152790528, 'max.cpu_memory_rss': 1153650688, 'mean.cpu_memory_rss': 1152922860.3076923, '25th_prcntl.cpu_memory_rss': 1152790528.0, '50th_prcntl.cpu_memory_rss': 1152790528.0, '75th_prcntl.cpu_memory_rss': 1152790528.0, 'std.cpu_memory_rss': 310346.7707669016, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707878715.076923, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 164040.43597679088, 'save_metrics.runtime': 0.007959604263305664}
2023-11-26 00:31:31,369 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:31,369 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.011281013488769531
2023-11-26 00:31:31,369 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.011281013488769531
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:31,370 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958691.3699808, tag: fetch
2023-11-26 00:31:31,370 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:31:31,370 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:31,370 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:31,371 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:31,371 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:31,371 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:31,371 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:31,371 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:31,372 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:31,372 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:31,372 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:31,372 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:31,372 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:31,372 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:36,887 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,889 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,889 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,889 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,890 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,891 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,892 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,892 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,892 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:31:36,892 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,893 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,893 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:31:36,894 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,895 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:36,895 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,896 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,896 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:31:36,896 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,896 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,896 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:31:36,897 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,898 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:36,898 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:31:36,899 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,899 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:31:36,899 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,899 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:36,899 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,902 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:36,902 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:36,907 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 38
2023-11-26 00:31:36,907 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:36,908 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 5.538053512573242
2023-11-26 00:31:36,908 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 5.538053512573242
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:37,034 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 1.224548
2023-11-26 00:31:37,893 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.211513
==== completed _train_epoch train()
2023-11-26 00:31:38,097 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1889276504516602
2023-11-26 00:31:38,097 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1889276504516602
2023-11-26 00:31:38,098 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.291534423828125e-06
2023-11-26 00:31:38,098 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.291534423828125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:38,098 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958698.0986109, tag: upload
2023-11-26 00:31:38,098 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:31:38,099 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:38,100 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:38,100 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:38,100 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:38,101 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:38,101 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:38,101 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:38,101 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,101 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:38,101 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:38,101 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:38,101 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,102 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:38,117 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:38,117 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:38,117 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:38,118 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:38,122 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,122 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,124 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,124 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,124 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,126 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,127 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,127 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,127 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,127 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,127 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,127 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,127 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:38,127 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:38,129 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,129 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,130 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,130 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,130 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,131 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,131 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,131 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,131 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,131 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,131 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,131 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,131 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:38,131 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:38,131 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,132 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,132 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,132 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,132 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,134 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,134 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,134 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,134 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,134 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,134 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,134 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,134 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:38,134 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:38,135 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.036538124084472656
2023-11-26 00:31:38,135 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.036538124084472656
2023-11-26 00:31:38,135 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:38,135 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 30.0
2023-11-26 00:31:38,135 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 6.0
2023-11-26 00:31:38,136 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:38,136 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:38,136 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 4.5
2023-11-26 00:31:38,136 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 10.954451150103322
2023-11-26 00:31:38,136 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1153634304
2023-11-26 00:31:38,136 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1153912832
2023-11-26 00:31:38,136 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1153768106.6666667
2023-11-26 00:31:38,137 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1153634304.0
2023-11-26 00:31:38,137 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1153765376.0
2023-11-26 00:31:38,137 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1153896448.0
2023-11-26 00:31:38,137 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 133914.07606703968
2023-11-26 00:31:38,137 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:31:38,137 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:31:38,137 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707884544.0
2023-11-26 00:31:38,138 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:38,138 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:38,138 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:31:38,138 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 169440.28706302406
2023-11-26 00:31:38,138 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 5.538053512573242, 'train.runtime': 1.1889276504516602, 'evaluate.runtime': 4.291534423828125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.036538124084472656, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 30.0, 'mean.cpu_utilization': 6.0, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 4.5, 'std.cpu_utilization': 10.954451150103322, 'min.cpu_memory_rss': 1153634304, 'max.cpu_memory_rss': 1153912832, 'mean.cpu_memory_rss': 1153768106.6666667, '25th_prcntl.cpu_memory_rss': 1153634304.0, '50th_prcntl.cpu_memory_rss': 1153765376.0, '75th_prcntl.cpu_memory_rss': 1153896448.0, 'std.cpu_memory_rss': 133914.07606703968, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707884544.0, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 169440.28706302406, 'save_metrics.runtime': 0.011281013488769531}
2023-11-26 00:31:38,138 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:38,138 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.0035386085510253906
2023-11-26 00:31:38,138 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.0035386085510253906
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:38,139 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958698.139018, tag: fetch
2023-11-26 00:31:38,139 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:31:38,139 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:38,139 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:38,139 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:38,139 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:38,139 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:38,139 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:38,139 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:38,139 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,139 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:38,140 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:38,140 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,140 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:38,140 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:10,239 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,241 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,242 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,242 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,242 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,242 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:32:10,242 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,242 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:32:10,243 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,243 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,244 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:10,245 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,247 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,247 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,247 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,247 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,247 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:32:10,247 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,247 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:32:10,248 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,248 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:10,249 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,249 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,249 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,249 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,249 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,249 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,250 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:32:10,250 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,250 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:32:10,250 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,250 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:10,251 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,252 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:10,252 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:10,262 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 43
2023-11-26 00:32:10,262 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:10,262 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 32.123477935791016
2023-11-26 00:32:10,262 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 32.123477935791016
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:10,394 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 4.922067
2023-11-26 00:32:11,160 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.353568
==== completed _train_epoch train()
2023-11-26 00:32:11,353 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.0909745693206787
2023-11-26 00:32:11,353 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.0909745693206787
2023-11-26 00:32:11,353 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 2.1457672119140625e-06
2023-11-26 00:32:11,354 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 2.1457672119140625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:11,354 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958731.3541052, tag: upload
2023-11-26 00:32:11,354 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:32:11,354 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:11,354 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:11,354 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:11,354 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:11,355 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:11,355 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:11,355 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:11,355 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,355 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:11,355 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:11,355 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:11,355 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,355 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:11,363 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:11,363 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:11,363 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:11,364 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:11,365 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,366 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,367 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,367 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,367 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,370 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,370 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,370 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,370 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,370 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,370 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,370 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,370 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:11,371 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:11,372 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,372 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,373 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,373 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,373 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,373 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,373 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,373 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,373 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,374 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,374 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,374 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,374 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:11,374 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:11,374 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,374 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,374 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,374 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,374 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,376 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,376 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,376 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,376 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,376 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,376 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,376 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,376 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:11,376 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:11,376 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.022617578506469727
2023-11-26 00:32:11,376 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.022617578506469727
2023-11-26 00:32:11,376 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 76.9
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.670588235294118
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.475639000548984
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1153900544
2023-11-26 00:32:11,377 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1153916928
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1153901146.3529413
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1153900544.0
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1153900544.0
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1153900544.0
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 2832.98057428145
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707823826.82353
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:11,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:11,379 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:11,379 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 77134.39284493716
2023-11-26 00:32:11,379 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 32.123477935791016, 'train.runtime': 1.0909745693206787, 'evaluate.runtime': 2.1457672119140625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.022617578506469727, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 76.9, 'mean.cpu_utilization': 4.670588235294118, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 17.475639000548984, 'min.cpu_memory_rss': 1153900544, 'max.cpu_memory_rss': 1153916928, 'mean.cpu_memory_rss': 1153901146.3529413, '25th_prcntl.cpu_memory_rss': 1153900544.0, '50th_prcntl.cpu_memory_rss': 1153900544.0, '75th_prcntl.cpu_memory_rss': 1153900544.0, 'std.cpu_memory_rss': 2832.98057428145, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707823826.82353, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 77134.39284493716, 'save_metrics.runtime': 0.0035386085510253906}
2023-11-26 00:32:11,379 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:11,379 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.002510547637939453
2023-11-26 00:32:11,379 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.002510547637939453
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:11,379 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958731.3794875, tag: fetch
2023-11-26 00:32:11,379 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:32:11,379 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:11,379 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:11,379 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:11,380 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:11,380 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:11,380 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:11,380 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:11,380 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,380 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:11,380 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:11,380 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,380 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:11,380 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:26,584 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:26,584 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:26,585 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:26,585 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,608 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,609 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,610 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,610 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,610 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,610 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:32:29,610 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,610 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:32:29,611 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,611 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:29,612 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,612 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,614 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,614 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,614 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,614 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,614 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:32:29,614 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,614 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:32:29,615 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,616 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:29,617 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,617 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,617 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,618 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,618 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,618 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,618 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:32:29,618 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,618 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:32:29,618 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,618 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:29,620 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,621 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:29,621 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:29,626 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 46
2023-11-26 00:32:29,626 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:29,626 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.24702763557434
2023-11-26 00:32:29,626 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.24702763557434
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:29,760 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 0.792356
2023-11-26 00:32:30,628 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.843827
==== completed _train_epoch train()
2023-11-26 00:32:30,858 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2313377857208252
2023-11-26 00:32:30,858 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2313377857208252
2023-11-26 00:32:30,858 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 2.1457672119140625e-06
2023-11-26 00:32:30,858 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 2.1457672119140625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:30,858 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958750.858613, tag: upload
2023-11-26 00:32:30,858 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:32:30,859 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:30,859 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:30,859 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:30,859 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:30,859 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:30,859 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:30,859 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:30,859 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,860 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:30,860 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:30,860 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:30,860 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,860 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:30,866 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:30,867 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:30,867 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:30,867 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:30,871 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,871 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,872 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,872 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,877 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,877 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,877 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,877 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,877 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,877 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,877 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,877 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:30,878 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:30,879 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,879 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,880 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,880 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,880 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,881 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,881 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,881 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,881 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,881 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,881 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,882 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,882 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:30,882 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:30,882 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,882 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,882 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,882 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,882 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,884 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,884 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,884 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,884 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,884 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,885 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,885 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,885 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:30,885 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:30,885 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.026964187622070312
2023-11-26 00:32:30,885 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.026964187622070312
2023-11-26 00:32:30,885 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:30,886 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 58.9
2023-11-26 00:32:30,886 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 3.363157894736842
2023-11-26 00:32:30,886 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:30,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:30,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:30,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 13.109466668918698
2023-11-26 00:32:30,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1153904640
2023-11-26 00:32:30,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1153921024
2023-11-26 00:32:30,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1153905502.3157895
2023-11-26 00:32:30,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1153904640.0
2023-11-26 00:32:30,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1153904640.0
2023-11-26 00:32:30,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1153904640.0
2023-11-26 00:32:30,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3658.4960535664404
2023-11-26 00:32:30,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:32:30,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:32:30,889 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707832697.263159
2023-11-26 00:32:30,889 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:30,889 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:30,889 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:30,889 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 101523.26548646874
2023-11-26 00:32:30,890 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 18.24702763557434, 'train.runtime': 1.2313377857208252, 'evaluate.runtime': 2.1457672119140625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.026964187622070312, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 58.9, 'mean.cpu_utilization': 3.363157894736842, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 13.109466668918698, 'min.cpu_memory_rss': 1153904640, 'max.cpu_memory_rss': 1153921024, 'mean.cpu_memory_rss': 1153905502.3157895, '25th_prcntl.cpu_memory_rss': 1153904640.0, '50th_prcntl.cpu_memory_rss': 1153904640.0, '75th_prcntl.cpu_memory_rss': 1153904640.0, 'std.cpu_memory_rss': 3658.4960535664404, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707832697.263159, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 101523.26548646874, 'save_metrics.runtime': 0.002510547637939453}
2023-11-26 00:32:30,890 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:30,890 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.00466156005859375
2023-11-26 00:32:30,890 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.00466156005859375
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:30,890 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958750.8907745, tag: fetch
2023-11-26 00:32:30,890 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:32:30,891 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:30,891 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:30,891 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:30,891 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:30,892 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:30,892 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:30,892 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:30,892 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,892 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:30,892 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:30,892 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,892 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:30,892 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:42,951 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:42,954 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:42,954 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:42,955 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:42,956 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:42,959 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:42,959 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:42,960 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:42,960 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:42,960 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:32:42,960 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:42,961 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048675
2023-11-26 00:32:42,962 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:42,963 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:42,963 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:42,964 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:42,964 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:32:42,964 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:42,964 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:32:42,964 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 1048677
2023-11-26 00:32:42,965 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375; len: 57155
2023-11-26 00:32:42,966 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:42,967 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:42,967 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:42,968 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:42,969 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:42,970 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:42,986 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 48
2023-11-26 00:32:42,986 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:42,986 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 12.095866203308105
2023-11-26 00:32:42,986 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 12.095866203308105
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:43,109 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/3899 (0%)]	loss: 3.027298
2023-11-26 00:32:43,897 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/3899 (83%)]	loss: 0.432588
==== completed _train_epoch train()
2023-11-26 00:32:44,080 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.092923641204834
2023-11-26 00:32:44,080 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.092923641204834
2023-11-26 00:32:44,080 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.5299530029296875e-06
2023-11-26 00:32:44,080 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.5299530029296875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:44,081 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958764.0811672, tag: upload
2023-11-26 00:32:44,081 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:32:44,082 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:44,082 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:44,083 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:44,083 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:44,083 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:44,083 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:44,083 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:44,084 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:44,084 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:44,084 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:44,084 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:44,084 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:44,084 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:44,102 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:44,102 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:44,102 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:44,103 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:44,108 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:44,109 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,110 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:44,110 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,111 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,114 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:44,114 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,114 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,114 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:44,114 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,114 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,114 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,114 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:44,115 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:44,116 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:44,116 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,117 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:44,117 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,117 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,117 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:44,118 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,118 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,118 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:44,118 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,118 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,118 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,118 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:44,118 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:44,118 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:44,119 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,119 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:44,119 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,119 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,121 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:44,121 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,121 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,121 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:44,121 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,121 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:44,121 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:44,121 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580375/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:44,121 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:44,122 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.041181325912475586
2023-11-26 00:32:44,122 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.041181325912475586
2023-11-26 00:32:44,123 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:44,123 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 42.9
2023-11-26 00:32:44,123 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.453846153846154
2023-11-26 00:32:44,124 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:44,125 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:44,125 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:32:44,125 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 12.80544447819066
2023-11-26 00:32:44,126 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1153904640
2023-11-26 00:32:44,126 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1153925120
2023-11-26 00:32:44,126 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1153906215.3846154
2023-11-26 00:32:44,126 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1153904640.0
2023-11-26 00:32:44,127 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1153904640.0
2023-11-26 00:32:44,127 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1153904640.0
2023-11-26 00:32:44,128 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 5457.292390617016
2023-11-26 00:32:44,128 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707808768
2023-11-26 00:32:44,128 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708263424
2023-11-26 00:32:44,128 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707843741.538462
2023-11-26 00:32:44,129 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:44,129 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:44,129 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707808768.0
2023-11-26 00:32:44,130 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 121151.89107169777
2023-11-26 00:32:44,130 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.005958080291748047, 'load_data.runtime': 0.9592506885528564, 'init.runtime': 1.9100608825683594, 'recv.bytes': 2154204, 'fetch.runtime': 12.095866203308105, 'train.runtime': 1.092923641204834, 'evaluate.runtime': 4.5299530029296875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.041181325912475586, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 42.9, 'mean.cpu_utilization': 5.453846153846154, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 12.80544447819066, 'min.cpu_memory_rss': 1153904640, 'max.cpu_memory_rss': 1153925120, 'mean.cpu_memory_rss': 1153906215.3846154, '25th_prcntl.cpu_memory_rss': 1153904640.0, '50th_prcntl.cpu_memory_rss': 1153904640.0, '75th_prcntl.cpu_memory_rss': 1153904640.0, 'std.cpu_memory_rss': 5457.292390617016, 'min.cpu_memory_vsz': 13707808768, 'max.cpu_memory_vsz': 13708263424, 'mean.cpu_memory_vsz': 13707843741.538462, '25th_prcntl.cpu_memory_vsz': 13707808768.0, '50th_prcntl.cpu_memory_vsz': 13707808768.0, '75th_prcntl.cpu_memory_vsz': 13707808768.0, 'std.cpu_memory_vsz': 121151.89107169777, 'save_metrics.runtime': 0.00466156005859375}
2023-11-26 00:32:44,130 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:44,130 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008162975311279297
2023-11-26 00:32:44,130 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008162975311279297
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:44,131 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958764.1312747, tag: fetch
2023-11-26 00:32:44,131 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2e198e1700>
2023-11-26 00:32:44,131 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:44,132 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:44,132 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:44,132 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:44,132 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:44,132 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:44,132 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:44,132 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:44,132 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:44,133 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:44,133 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580375, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580375': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:44,133 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:44,133 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:33:03,068 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,068 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,068 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,069 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,069 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,069 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,069 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,069 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,070 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 59
2023-11-26 00:33:03,070 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,070 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 59
2023-11-26 00:33:03,071 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 59
extracting weights from message
2023-11-26 00:33:03,071 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: True, round: 48
2023-11-26 00:33:03,071 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:33:03,072 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.94080114364624
2023-11-26 00:33:03,072 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.94080114364624
2023-11-26 00:33:03,072 | composer.py:145 | DEBUG | MainThread | run | end of run
2023-11-26 00:33:03,073 | channel_manager.py:187 | DEBUG | MainThread | cleanup | calling cleanup
2023-11-26 00:33:03,073 | channel_manager.py:189 | DEBUG | MainThread | cleanup | calling leave for channel param-channel
2023-11-26 00:33:03,073 | channel.py:414 | DEBUG | MainThread | leave | calling channel leave for param-channel
2023-11-26 00:33:03,074 | channel.py:420 | DEBUG | MainThread | leave |  channel leave done for param-channel
2023-11-26 00:33:03,074 | mqtt.py:552 | DEBUG | Thread-3 | misc_loop | misc_loop finished
2023-11-26 00:33:03,075 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-2
2023-11-26 00:33:03,075 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-8
2023-11-26 00:33:03,075 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-7
2023-11-26 00:33:03,076 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-161
2023-11-26 00:33:03,076 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-4
2023-11-26 00:33:03,076 | channel_manager.py:200 | DEBUG | Thread-3 | _inner | done with cleaning up asyncio tasks
