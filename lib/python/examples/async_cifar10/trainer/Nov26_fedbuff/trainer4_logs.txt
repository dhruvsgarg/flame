2023-11-26 00:27:23,520 | metric_collector.py:52 | DEBUG | Thread-2 | gather_gpu_stats | could not start gpustat.nvml.pynvml; no GPU metrics will be collected
2023-11-26 00:27:23,543 | fedadagrad.py:27 | DEBUG | MainThread | FedAdaGrad | Initializing fedadagrad
2023-11-26 00:27:23,543 | fedadam.py:27 | DEBUG | MainThread | FedAdam | Initializing fedadam
2023-11-26 00:27:23,544 | fedyogi.py:27 | DEBUG | MainThread | FedYogi | Initializing fedyogi
2023-11-26 00:27:26,613 | channel_manager.py:72 | INFO | MainThread | __new__ | creating a ChannelManager instance
2023-11-26 00:27:26,613 | selector_events.py:54 | DEBUG | MainThread | __init__ | Using selector: EpollSelector
2023-11-26 00:27:26,616 | mqtt.py:514 | DEBUG | Thread-3 | on_socket_open | Socket opened
2023-11-26 00:27:26,616 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,617 | mqtt.py:546 | DEBUG | Thread-3 | misc_loop | misc_loop started
2023-11-26 00:27:26,617 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,617 | channel_manager.py:146 | INFO | MainThread | join | no backend found for channel param-channel; use default
2023-11-26 00:27:26,618 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,618 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,619 | mqtt.py:294 | DEBUG | Thread-3 | on_connect | calling on_connect
2023-11-26 00:27:26,619 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,619 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,620 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,620 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,620 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/+
2023-11-26 00:27:26,620 | mqtt.py:531 | DEBUG | MainThread | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,621 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/+/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374
2023-11-26 00:27:26,621 | mqtt.py:349 | DEBUG | MainThread | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374
2023-11-26 00:27:26,621 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[internal_init.runtime] = 0.00856161117553711
2023-11-26 00:27:26,621 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of internal_init is 0.00856161117553711
2023-11-26 00:27:26,622 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,622 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,622 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,663 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,664 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,664 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,665 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,665 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,665 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,665 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580374, status: online
2023-11-26 00:27:26,665 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,714 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,714 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,715 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,715 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,715 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,716 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,716 | mqtt.py:234 | DEBUG | Thread-3 | _handle_notification | acknowledge notification
2023-11-26 00:27:26,716 | mqtt.py:349 | DEBUG | Thread-3 | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374
2023-11-26 00:27:26,716 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,717 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,760 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,760 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,760 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,760 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,761 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
Files already downloaded and verified
2023-11-26 00:27:27,008 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,008 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:27,009 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580371, status: online
2023-11-26 00:27:27,106 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,107 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,107 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,108 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,108 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,108 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,108 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,108 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,109 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,109 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
indices:  tensor([49077, 14077,   970,  ...,  8103, 25308,  2935])
2023-11-26 00:27:27,541 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[load_data.runtime] = 0.9201302528381348
2023-11-26 00:27:27,542 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of load_data is 0.9201302528381348
2023-11-26 00:27:29,209 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[init.runtime] = 1.6665840148925781
2023-11-26 00:27:29,209 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of init is 1.6665840148925781
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:29,209 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958449.209549, tag: fetch
2023-11-26 00:27:29,209 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:27:29,210 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:29,211 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:29,211 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:29,211 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:29,212 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:29,212 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:29,212 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:29,212 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': set()}
2023-11-26 00:27:29,212 | fedbuff.py:165 | DEBUG | Thread-3 | _handle_recv_state | let's select 1 ends
2023-11-26 00:27:29,212 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:29,212 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:29,212 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:29,213 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:45,490 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,499 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:45,499 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,507 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:45,508 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:45,509 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,510 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:45,510 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:27:45,510 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:27:45,512 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:45,514 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:45,515 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:45,515 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,515 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:27:45,516 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:45,516 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:27:45,516 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:27:45,517 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:27:45,519 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:45,519 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:45,520 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:45,520 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:45,525 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:45,525 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:45,545 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 3
2023-11-26 00:27:45,545 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:45,545 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 16.33645009994507
2023-11-26 00:27:45,546 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 16.33645009994507
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:46,094 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 10.506821
2023-11-26 00:27:46,979 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.348153
==== completed _train_epoch train()
2023-11-26 00:27:47,667 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.1210384368896484
2023-11-26 00:27:47,667 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.1210384368896484
2023-11-26 00:27:47,668 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:27:47,668 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:47,668 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958467.6685088, tag: upload
2023-11-26 00:27:47,668 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:27:47,669 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:47,670 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:47,670 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:47,671 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:47,671 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:47,671 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:47,671 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:47,671 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:47,671 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:47,671 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:47,672 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:47,672 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:47,672 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:47,690 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:47,690 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:47,690 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:47,690 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:47,695 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:47,696 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,698 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:47,698 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,698 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,702 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:47,702 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,702 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,702 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:47,702 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,702 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,703 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,703 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:47,703 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:47,704 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:47,704 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,705 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:47,705 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,705 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,706 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:47,706 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,706 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,706 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:47,706 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,706 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,706 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,706 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:47,706 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:47,707 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:47,707 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,707 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:47,707 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,707 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,709 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:47,709 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,709 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,709 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:47,709 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,709 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:47,709 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:47,709 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:47,710 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:47,710 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.042066335678100586
2023-11-26 00:27:47,710 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.042066335678100586
2023-11-26 00:27:47,711 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:47,711 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 470.3
2023-11-26 00:27:47,712 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 43.06399999999999
2023-11-26 00:27:47,713 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:47,714 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:47,714 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 65.7
2023-11-26 00:27:47,715 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 95.84148947089668
2023-11-26 00:27:47,715 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 68964352
2023-11-26 00:27:47,715 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1135927296
2023-11-26 00:27:47,715 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 860150824.96
2023-11-26 00:27:47,716 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 977567744.0
2023-11-26 00:27:47,716 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 977567744.0
2023-11-26 00:27:47,717 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 977567744.0
2023-11-26 00:27:47,717 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 276479139.8733234
2023-11-26 00:27:47,717 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 1881817088
2023-11-26 00:27:47,717 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13703606272
2023-11-26 00:27:47,718 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 10908189491.2
2023-11-26 00:27:47,718 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 12240879616.0
2023-11-26 00:27:47,718 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 12240879616.0
2023-11-26 00:27:47,719 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 12240879616.0
2023-11-26 00:27:47,719 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 3183029090.5925665
2023-11-26 00:27:47,720 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 16.33645009994507, 'train.runtime': 2.1210384368896484, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.042066335678100586, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 470.3, 'mean.cpu_utilization': 43.06399999999999, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 65.7, 'std.cpu_utilization': 95.84148947089668, 'min.cpu_memory_rss': 68964352, 'max.cpu_memory_rss': 1135927296, 'mean.cpu_memory_rss': 860150824.96, '25th_prcntl.cpu_memory_rss': 977567744.0, '50th_prcntl.cpu_memory_rss': 977567744.0, '75th_prcntl.cpu_memory_rss': 977567744.0, 'std.cpu_memory_rss': 276479139.8733234, 'min.cpu_memory_vsz': 1881817088, 'max.cpu_memory_vsz': 13703606272, 'mean.cpu_memory_vsz': 10908189491.2, '25th_prcntl.cpu_memory_vsz': 12240879616.0, '50th_prcntl.cpu_memory_vsz': 12240879616.0, '75th_prcntl.cpu_memory_vsz': 12240879616.0, 'std.cpu_memory_vsz': 3183029090.5925665}
2023-11-26 00:27:47,720 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:47,720 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009453535079956055
2023-11-26 00:27:47,720 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009453535079956055
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:47,720 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958467.720782, tag: fetch
2023-11-26 00:27:47,720 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:27:47,721 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:47,721 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:47,721 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:47,722 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:47,722 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:47,722 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:47,722 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:47,722 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:47,722 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:47,722 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:47,722 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:47,722 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:47,723 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:27,322 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:27,322 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:27,323 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:27,323 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,714 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,718 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,719 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,719 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,719 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,722 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,723 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,723 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:28:31,723 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,723 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,724 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:28:31,725 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,727 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:31,729 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,729 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,730 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:28:31,730 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,730 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,730 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:28:31,731 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,734 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:31,734 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:28:31,735 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,735 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:28:31,735 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,747 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:31,750 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,750 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:31,750 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:31,760 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 10
2023-11-26 00:28:31,760 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:31,760 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 44.03961801528931
2023-11-26 00:28:31,760 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 44.03961801528931
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:31,858 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 6.535264
2023-11-26 00:28:32,663 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.438553
==== completed _train_epoch train()
2023-11-26 00:28:33,282 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.521559238433838
2023-11-26 00:28:33,282 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.521559238433838
2023-11-26 00:28:33,283 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.291534423828125e-06
2023-11-26 00:28:33,283 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.291534423828125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:33,283 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958513.2833903, tag: upload
2023-11-26 00:28:33,283 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:28:33,284 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:33,285 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:33,285 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:33,286 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:33,286 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:33,286 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:33,286 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:33,286 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,286 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:33,287 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:33,287 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:33,287 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,287 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:33,302 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:33,302 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:33,302 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:33,303 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:33,309 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,309 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,311 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,311 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,312 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,314 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,315 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,315 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,315 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,315 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,315 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,315 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,315 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:33,316 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:33,317 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,317 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,318 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,318 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,318 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,318 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,318 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,318 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,319 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,319 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,319 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,319 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,319 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:33,319 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:33,319 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,319 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,320 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,320 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,320 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,321 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,322 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,322 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,322 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,322 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,322 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,322 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,322 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:33,322 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:33,323 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03989672660827637
2023-11-26 00:28:33,323 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03989672660827637
2023-11-26 00:28:33,323 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:33,324 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 45.9
2023-11-26 00:28:33,324 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 1.8844444444444444
2023-11-26 00:28:33,325 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:33,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:33,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:33,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 8.213023683436651
2023-11-26 00:28:33,327 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1141002240
2023-11-26 00:28:33,327 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1146425344
2023-11-26 00:28:33,327 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1141122753.4222221
2023-11-26 00:28:33,327 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1141002240.0
2023-11-26 00:28:33,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1141002240.0
2023-11-26 00:28:33,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1141002240.0
2023-11-26 00:28:33,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 799395.6074255791
2023-11-26 00:28:33,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13704785920
2023-11-26 00:28:33,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707501568
2023-11-26 00:28:33,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13704846267.733334
2023-11-26 00:28:33,330 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13704785920.0
2023-11-26 00:28:33,330 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13704785920.0
2023-11-26 00:28:33,331 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13704785920.0
2023-11-26 00:28:33,331 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 400301.5768301805
2023-11-26 00:28:33,331 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 44.03961801528931, 'train.runtime': 1.521559238433838, 'evaluate.runtime': 4.291534423828125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03989672660827637, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 45.9, 'mean.cpu_utilization': 1.8844444444444444, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 8.213023683436651, 'min.cpu_memory_rss': 1141002240, 'max.cpu_memory_rss': 1146425344, 'mean.cpu_memory_rss': 1141122753.4222221, '25th_prcntl.cpu_memory_rss': 1141002240.0, '50th_prcntl.cpu_memory_rss': 1141002240.0, '75th_prcntl.cpu_memory_rss': 1141002240.0, 'std.cpu_memory_rss': 799395.6074255791, 'min.cpu_memory_vsz': 13704785920, 'max.cpu_memory_vsz': 13707501568, 'mean.cpu_memory_vsz': 13704846267.733334, '25th_prcntl.cpu_memory_vsz': 13704785920.0, '50th_prcntl.cpu_memory_vsz': 13704785920.0, '75th_prcntl.cpu_memory_vsz': 13704785920.0, 'std.cpu_memory_vsz': 400301.5768301805, 'save_metrics.runtime': 0.009453535079956055}
2023-11-26 00:28:33,332 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:33,332 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008569717407226562
2023-11-26 00:28:33,332 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008569717407226562
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:33,332 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958513.3326101, tag: fetch
2023-11-26 00:28:33,332 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:28:33,333 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:33,333 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:33,333 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:33,333 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:33,333 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:33,334 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:33,334 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:33,334 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,334 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:33,334 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:33,334 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,334 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:33,334 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:45,066 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,068 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,068 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,068 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,068 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,069 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:28:45,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,069 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:28:45,069 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,070 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,070 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:45,084 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,087 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,087 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,087 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,087 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,087 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:28:45,087 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,088 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:28:45,088 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,088 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,089 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:45,090 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,090 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,090 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,090 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,091 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,091 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:28:45,091 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,091 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:28:45,091 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,091 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,091 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:45,093 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:45,093 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:45,104 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 12
2023-11-26 00:28:45,105 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:45,105 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.773048639297485
2023-11-26 00:28:45,105 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.773048639297485
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:45,189 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 4.021682
2023-11-26 00:28:46,066 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.442542
==== completed _train_epoch train()
2023-11-26 00:28:46,758 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.652839183807373
2023-11-26 00:28:46,759 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.652839183807373
2023-11-26 00:28:46,759 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.5299530029296875e-06
2023-11-26 00:28:46,760 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.5299530029296875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:46,760 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958526.7602625, tag: upload
2023-11-26 00:28:46,760 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:28:46,761 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:46,761 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:46,762 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:46,762 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:46,763 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:46,763 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:46,763 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:46,763 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,764 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:46,764 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:46,764 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:46,764 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,764 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:46,783 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:46,783 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:46,784 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:46,784 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:46,790 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,790 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,792 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,792 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,793 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,795 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,796 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,796 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,796 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,796 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,796 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,796 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,796 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:46,797 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:46,798 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,798 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,799 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,799 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,799 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,799 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,799 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,800 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,800 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,800 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,800 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,800 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,800 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:46,800 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:46,801 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,801 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,801 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,801 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,801 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,803 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,803 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,803 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,803 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,803 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,803 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,803 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,804 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:46,804 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:46,804 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04440760612487793
2023-11-26 00:28:46,805 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04440760612487793
2023-11-26 00:28:46,805 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:46,806 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 84.8
2023-11-26 00:28:46,806 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 13.685714285714285
2023-11-26 00:28:46,807 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:46,808 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:46,808 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.75
2023-11-26 00:28:46,809 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 28.544072618192608
2023-11-26 00:28:46,809 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1147408384
2023-11-26 00:28:46,809 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1148747776
2023-11-26 00:28:46,809 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1147599725.7142856
2023-11-26 00:28:46,810 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1147408384.0
2023-11-26 00:28:46,810 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1147408384.0
2023-11-26 00:28:46,811 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1147408384.0
2023-11-26 00:28:46,811 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 468689.56650940666
2023-11-26 00:28:46,811 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707046912
2023-11-26 00:28:46,811 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707894784
2023-11-26 00:28:46,812 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707139949.714285
2023-11-26 00:28:46,812 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:28:46,813 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:28:46,813 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:28:46,813 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 239704.39813696386
2023-11-26 00:28:46,814 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 11.773048639297485, 'train.runtime': 1.652839183807373, 'evaluate.runtime': 4.5299530029296875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04440760612487793, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 84.8, 'mean.cpu_utilization': 13.685714285714285, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.75, 'std.cpu_utilization': 28.544072618192608, 'min.cpu_memory_rss': 1147408384, 'max.cpu_memory_rss': 1148747776, 'mean.cpu_memory_rss': 1147599725.7142856, '25th_prcntl.cpu_memory_rss': 1147408384.0, '50th_prcntl.cpu_memory_rss': 1147408384.0, '75th_prcntl.cpu_memory_rss': 1147408384.0, 'std.cpu_memory_rss': 468689.56650940666, 'min.cpu_memory_vsz': 13707046912, 'max.cpu_memory_vsz': 13707894784, 'mean.cpu_memory_vsz': 13707139949.714285, '25th_prcntl.cpu_memory_vsz': 13707046912.0, '50th_prcntl.cpu_memory_vsz': 13707046912.0, '75th_prcntl.cpu_memory_vsz': 13707046912.0, 'std.cpu_memory_vsz': 239704.39813696386, 'save_metrics.runtime': 0.008569717407226562}
2023-11-26 00:28:46,814 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:46,814 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009083271026611328
2023-11-26 00:28:46,814 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009083271026611328
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:46,814 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958526.8149621, tag: fetch
2023-11-26 00:28:46,815 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:28:46,815 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:46,815 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:46,816 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:46,816 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:46,816 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:46,816 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:46,816 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:46,816 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,817 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:46,817 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:46,817 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,817 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:46,817 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:17,933 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:17,937 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:17,938 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:17,938 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:17,939 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:17,942 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:17,943 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:17,943 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:17,943 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:17,943 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:29:17,944 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:17,944 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:29:17,945 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:17,947 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:17,948 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:17,948 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:17,948 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:29:17,949 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:17,949 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:29:17,949 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:29:17,950 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:29:17,952 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:17,953 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:17,953 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:17,954 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:17,957 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:17,958 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:17,975 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 17
2023-11-26 00:29:17,975 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:17,975 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 31.160555839538574
2023-11-26 00:29:17,975 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 31.160555839538574
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:18,109 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 3.498574
2023-11-26 00:29:18,945 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.308200
==== completed _train_epoch train()
2023-11-26 00:29:19,603 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.627734899520874
2023-11-26 00:29:19,603 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.627734899520874
2023-11-26 00:29:19,604 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:29:19,604 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:19,604 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958559.6049101, tag: upload
2023-11-26 00:29:19,605 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:29:19,606 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:19,606 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:19,606 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:19,607 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:19,607 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:19,607 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:19,607 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:19,607 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,608 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:19,608 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:19,608 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:19,608 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,608 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:19,626 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:19,627 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:19,627 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:19,627 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:19,631 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,632 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,633 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,633 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,633 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,636 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,637 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,637 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,637 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,637 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,637 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,637 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,637 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:19,637 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:19,639 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,639 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,641 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,641 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,641 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,641 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,641 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,641 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,641 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,641 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,641 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,642 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,642 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:19,642 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:19,642 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,642 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,642 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,642 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,642 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,644 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,645 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,645 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,645 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,645 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,645 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,645 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,645 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:19,645 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:19,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.041321516036987305
2023-11-26 00:29:19,646 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.041321516036987305
2023-11-26 00:29:19,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:19,647 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 84.8
2023-11-26 00:29:19,647 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.715151515151515
2023-11-26 00:29:19,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:19,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:19,649 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:19,649 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 16.2340667100619
2023-11-26 00:29:19,649 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1148731392
2023-11-26 00:29:19,650 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1148776448
2023-11-26 00:29:19,650 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1148734122.6666667
2023-11-26 00:29:19,650 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1148731392.0
2023-11-26 00:29:19,651 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1148731392.0
2023-11-26 00:29:19,651 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1148731392.0
2023-11-26 00:29:19,652 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 10750.645417317459
2023-11-26 00:29:19,652 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707046912
2023-11-26 00:29:19,652 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707898880
2023-11-26 00:29:19,652 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707098546.424242
2023-11-26 00:29:19,653 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:29:19,653 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:29:19,653 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:29:19,654 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 203284.9315274574
2023-11-26 00:29:19,654 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 31.160555839538574, 'train.runtime': 1.627734899520874, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.041321516036987305, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 84.8, 'mean.cpu_utilization': 4.715151515151515, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 16.2340667100619, 'min.cpu_memory_rss': 1148731392, 'max.cpu_memory_rss': 1148776448, 'mean.cpu_memory_rss': 1148734122.6666667, '25th_prcntl.cpu_memory_rss': 1148731392.0, '50th_prcntl.cpu_memory_rss': 1148731392.0, '75th_prcntl.cpu_memory_rss': 1148731392.0, 'std.cpu_memory_rss': 10750.645417317459, 'min.cpu_memory_vsz': 13707046912, 'max.cpu_memory_vsz': 13707898880, 'mean.cpu_memory_vsz': 13707098546.424242, '25th_prcntl.cpu_memory_vsz': 13707046912.0, '50th_prcntl.cpu_memory_vsz': 13707046912.0, '75th_prcntl.cpu_memory_vsz': 13707046912.0, 'std.cpu_memory_vsz': 203284.9315274574, 'save_metrics.runtime': 0.009083271026611328}
2023-11-26 00:29:19,654 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:19,654 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008253812789916992
2023-11-26 00:29:19,654 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008253812789916992
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:19,655 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958559.6552343, tag: fetch
2023-11-26 00:29:19,655 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:29:19,655 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:19,655 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:19,656 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:19,656 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:19,656 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:19,656 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:19,656 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:19,656 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,656 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:19,656 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:19,656 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,656 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:19,657 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:27,401 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:27,402 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:27,402 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:27,402 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,253 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,256 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,256 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,257 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,257 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,257 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:29:31,257 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,257 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:29:31,259 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,261 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,261 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,261 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:31,264 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,265 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,265 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,265 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,265 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,266 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,266 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,266 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,266 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:29:31,266 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,266 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:29:31,267 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,269 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:31,270 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,270 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,270 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:29:31,270 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,270 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:29:31,271 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,271 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:31,271 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,274 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:31,274 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:31,285 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 19
2023-11-26 00:29:31,285 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:31,285 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.630552053451538
2023-11-26 00:29:31,285 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.630552053451538
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:31,408 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 4.603195
2023-11-26 00:29:32,201 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.520329
==== completed _train_epoch train()
2023-11-26 00:29:32,894 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.6082279682159424
2023-11-26 00:29:32,894 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.6082279682159424
2023-11-26 00:29:32,894 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.0994415283203125e-06
2023-11-26 00:29:32,895 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.0994415283203125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:32,895 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958572.8952217, tag: upload
2023-11-26 00:29:32,895 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:29:32,896 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:32,896 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:32,896 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:32,897 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:32,897 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:32,897 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:32,897 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,897 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,898 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:32,898 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,898 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:32,898 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,898 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:32,914 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:32,914 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:32,914 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:32,915 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:32,920 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,921 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,922 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,923 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,923 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,926 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,926 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,926 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,926 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,926 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,926 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,926 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,926 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,927 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:32,928 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,928 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,929 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,929 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,929 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,929 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,930 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,930 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,930 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,930 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,930 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,930 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,930 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,930 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:32,930 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,931 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,931 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,931 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,931 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,933 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,933 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,933 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,933 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,933 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,933 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,933 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,933 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,934 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:32,934 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03923964500427246
2023-11-26 00:29:32,934 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03923964500427246
2023-11-26 00:29:32,935 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:32,935 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 88.8
2023-11-26 00:29:32,935 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.753846153846153
2023-11-26 00:29:32,936 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:32,937 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:32,937 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:29:32,938 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 23.462330377555467
2023-11-26 00:29:32,938 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149734912
2023-11-26 00:29:32,938 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149894656
2023-11-26 00:29:32,938 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149759488.0
2023-11-26 00:29:32,939 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149734912.0
2023-11-26 00:29:32,939 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149734912.0
2023-11-26 00:29:32,940 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149734912.0
2023-11-26 00:29:32,940 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 57635.8288567103
2023-11-26 00:29:32,940 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707046912
2023-11-26 00:29:32,940 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:29:32,941 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707146476.307692
2023-11-26 00:29:32,941 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:29:32,942 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:29:32,942 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707046912.0
2023-11-26 00:29:32,942 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 233498.99895795455
2023-11-26 00:29:32,943 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 11.630552053451538, 'train.runtime': 1.6082279682159424, 'evaluate.runtime': 3.0994415283203125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03923964500427246, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 88.8, 'mean.cpu_utilization': 8.753846153846153, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 23.462330377555467, 'min.cpu_memory_rss': 1149734912, 'max.cpu_memory_rss': 1149894656, 'mean.cpu_memory_rss': 1149759488.0, '25th_prcntl.cpu_memory_rss': 1149734912.0, '50th_prcntl.cpu_memory_rss': 1149734912.0, '75th_prcntl.cpu_memory_rss': 1149734912.0, 'std.cpu_memory_rss': 57635.8288567103, 'min.cpu_memory_vsz': 13707046912, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707146476.307692, '25th_prcntl.cpu_memory_vsz': 13707046912.0, '50th_prcntl.cpu_memory_vsz': 13707046912.0, '75th_prcntl.cpu_memory_vsz': 13707046912.0, 'std.cpu_memory_vsz': 233498.99895795455, 'save_metrics.runtime': 0.008253812789916992}
2023-11-26 00:29:32,943 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:32,943 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008686304092407227
2023-11-26 00:29:32,943 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008686304092407227
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:32,943 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958572.943968, tag: fetch
2023-11-26 00:29:32,944 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:29:32,944 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:32,944 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:32,945 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:32,945 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:32,945 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:32,945 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:32,945 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,945 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,945 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:32,945 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:32,946 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,946 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:32,946 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:57,766 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:57,769 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:57,769 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:57,769 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:57,771 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:57,773 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:57,773 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:57,774 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:57,774 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:57,774 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:29:57,774 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:57,775 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:29:57,776 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:57,778 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:57,779 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:57,780 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:57,780 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:29:57,780 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:57,780 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:29:57,781 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:29:57,782 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:29:57,783 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:57,784 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:57,784 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:57,785 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:57,789 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:57,790 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:57,811 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 23
2023-11-26 00:29:57,811 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:57,811 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 24.868014812469482
2023-11-26 00:29:57,812 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 24.868014812469482
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:57,918 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 2.768065
2023-11-26 00:29:58,757 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.106352
==== completed _train_epoch train()
2023-11-26 00:29:59,333 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5208215713500977
2023-11-26 00:29:59,333 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5208215713500977
2023-11-26 00:29:59,333 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.76837158203125e-06
2023-11-26 00:29:59,334 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.76837158203125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:59,334 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958599.334338, tag: upload
2023-11-26 00:29:59,334 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:29:59,335 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:59,336 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:59,336 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:59,336 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:59,337 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:59,337 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:59,337 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:59,337 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:59,337 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:59,337 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:59,337 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:59,337 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:59,337 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:59,348 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:59,349 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:59,349 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:59,349 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:59,354 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:59,354 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,356 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:59,356 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,356 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,359 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:59,359 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,359 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,359 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:59,360 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,360 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,360 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,360 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:59,360 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:59,361 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:59,361 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,362 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:59,362 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,362 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,363 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:59,363 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,363 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,363 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:59,363 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,363 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,363 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,363 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:59,363 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:59,364 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:59,364 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,364 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:59,364 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,364 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,366 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:59,366 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,366 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,366 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:59,366 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,366 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:59,366 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:59,366 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:59,367 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:59,367 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03319358825683594
2023-11-26 00:29:59,367 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03319358825683594
2023-11-26 00:29:59,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:59,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 50.9
2023-11-26 00:29:59,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 3.569230769230769
2023-11-26 00:29:59,369 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:59,370 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:59,370 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:59,370 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 11.92927134375354
2023-11-26 00:29:59,371 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149874176
2023-11-26 00:29:59,371 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149890560
2023-11-26 00:29:59,371 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149874806.1538463
2023-11-26 00:29:59,372 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:29:59,372 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:29:59,372 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:29:59,373 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3150.769230769231
2023-11-26 00:29:59,373 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:29:59,373 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708091392
2023-11-26 00:29:59,373 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707272192.0
2023-11-26 00:29:59,374 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:29:59,374 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:29:59,375 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:29:59,375 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 163840.0
2023-11-26 00:29:59,375 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 24.868014812469482, 'train.runtime': 1.5208215713500977, 'evaluate.runtime': 4.76837158203125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03319358825683594, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 50.9, 'mean.cpu_utilization': 3.569230769230769, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 11.92927134375354, 'min.cpu_memory_rss': 1149874176, 'max.cpu_memory_rss': 1149890560, 'mean.cpu_memory_rss': 1149874806.1538463, '25th_prcntl.cpu_memory_rss': 1149874176.0, '50th_prcntl.cpu_memory_rss': 1149874176.0, '75th_prcntl.cpu_memory_rss': 1149874176.0, 'std.cpu_memory_rss': 3150.769230769231, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13708091392, 'mean.cpu_memory_vsz': 13707272192.0, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 163840.0, 'save_metrics.runtime': 0.008686304092407227}
2023-11-26 00:29:59,375 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:59,376 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008089303970336914
2023-11-26 00:29:59,376 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008089303970336914
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:59,376 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958599.376433, tag: fetch
2023-11-26 00:29:59,376 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:29:59,377 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:59,377 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:59,377 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:59,377 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:59,377 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:59,377 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:59,378 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:59,378 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:59,378 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:59,378 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:59,378 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:59,378 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:59,378 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:17,702 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,705 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,705 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,705 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,706 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,706 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:30:17,706 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,706 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:30:17,707 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,709 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:17,710 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,710 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,712 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,712 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,712 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,712 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,712 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:30:17,712 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,713 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:30:17,713 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,714 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:17,715 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,727 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,728 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,728 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,728 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,728 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,728 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:30:17,728 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,728 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:30:17,728 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,728 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:17,730 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,730 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:17,730 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:17,744 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 26
2023-11-26 00:30:17,744 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:17,744 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.368222951889038
2023-11-26 00:30:17,744 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.368222951889038
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:17,847 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 2.720234
2023-11-26 00:30:18,567 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.071322
==== completed _train_epoch train()
2023-11-26 00:30:19,210 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.4655098915100098
2023-11-26 00:30:19,211 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.4655098915100098
2023-11-26 00:30:19,211 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:30:19,211 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:19,212 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958619.2120824, tag: upload
2023-11-26 00:30:19,212 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:30:19,213 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:19,213 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:19,213 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:19,214 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:19,214 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:19,214 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:19,214 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:19,215 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:19,215 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:19,215 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:19,215 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:19,215 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:19,215 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:19,230 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:19,230 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:19,230 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:19,230 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:19,234 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:19,234 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,235 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:19,235 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,236 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,239 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:19,239 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,239 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,239 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:19,239 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,239 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,239 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,239 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:19,240 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:19,241 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:19,241 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,242 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:19,242 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,242 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,242 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:19,243 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,243 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,243 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:19,243 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,243 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,243 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,243 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:19,243 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:19,243 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:19,244 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,244 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:19,244 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,244 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,246 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:19,246 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,246 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,246 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:19,246 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,246 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:19,246 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:19,246 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:19,246 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:19,247 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03507685661315918
2023-11-26 00:30:19,247 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03507685661315918
2023-11-26 00:30:19,247 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:19,248 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 75.9
2023-11-26 00:30:19,248 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.19
2023-11-26 00:30:19,249 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:19,249 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:19,250 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:19,250 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 21.29753272095151
2023-11-26 00:30:19,250 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149874176
2023-11-26 00:30:19,251 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149890560
2023-11-26 00:30:19,251 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149874995.2
2023-11-26 00:30:19,251 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:19,252 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:19,252 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:19,253 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3570.8100145485196
2023-11-26 00:30:19,253 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:30:19,253 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708091392
2023-11-26 00:30:19,253 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707282022.4
2023-11-26 00:30:19,254 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:19,254 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:19,255 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:19,255 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 185682.120756523
2023-11-26 00:30:19,255 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 18.368222951889038, 'train.runtime': 1.4655098915100098, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03507685661315918, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 75.9, 'mean.cpu_utilization': 7.19, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 21.29753272095151, 'min.cpu_memory_rss': 1149874176, 'max.cpu_memory_rss': 1149890560, 'mean.cpu_memory_rss': 1149874995.2, '25th_prcntl.cpu_memory_rss': 1149874176.0, '50th_prcntl.cpu_memory_rss': 1149874176.0, '75th_prcntl.cpu_memory_rss': 1149874176.0, 'std.cpu_memory_rss': 3570.8100145485196, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13708091392, 'mean.cpu_memory_vsz': 13707282022.4, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 185682.120756523, 'save_metrics.runtime': 0.008089303970336914}
2023-11-26 00:30:19,256 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:19,256 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008635759353637695
2023-11-26 00:30:19,256 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008635759353637695
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:19,256 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958619.2565677, tag: fetch
2023-11-26 00:30:19,256 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:30:19,257 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:19,257 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:19,257 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:19,257 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:19,257 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:19,257 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:19,257 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:19,257 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:19,258 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:19,258 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:19,258 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:19,258 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:19,258 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:27,482 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,483 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:27,483 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,483 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:38,026 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:38,029 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:38,030 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:38,030 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:38,030 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:38,030 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:30:38,030 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:38,030 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:30:38,032 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:38,033 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:38,034 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:38,034 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:38,036 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:38,036 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:38,037 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:38,037 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:38,037 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:38,037 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:30:38,037 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:38,037 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:30:38,038 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:30:38,038 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:30:38,039 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:38,039 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:38,040 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:38,040 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:38,041 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:38,042 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:38,047 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 29
2023-11-26 00:30:38,047 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:38,047 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.7913875579834
2023-11-26 00:30:38,047 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.7913875579834
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:38,166 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 2.923775
2023-11-26 00:30:39,041 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.445292
==== completed _train_epoch train()
2023-11-26 00:30:39,664 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.616736650466919
2023-11-26 00:30:39,665 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.616736650466919
2023-11-26 00:30:39,665 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:30:39,665 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:39,666 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958639.666089, tag: upload
2023-11-26 00:30:39,666 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:30:39,667 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:39,667 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:39,668 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:39,668 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:39,669 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:39,669 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:39,669 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:39,669 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,670 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:39,670 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:39,670 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:39,670 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,670 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:39,690 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:39,690 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:39,690 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:39,691 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:39,697 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,697 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,699 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,700 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,700 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,701 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,701 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,701 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,701 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,701 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,701 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,702 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,702 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:39,702 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:39,703 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,704 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,705 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,705 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,705 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,706 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,706 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,706 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,706 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,707 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,707 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,707 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,707 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:39,707 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:39,707 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,708 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,708 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,708 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,708 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,708 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:39,708 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,708 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,709 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:39,709 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,709 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:39,709 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:39,709 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:39,709 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:39,710 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04415273666381836
2023-11-26 00:30:39,710 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04415273666381836
2023-11-26 00:30:39,710 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:39,711 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 91.8
2023-11-26 00:30:39,711 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.980952380952381
2023-11-26 00:30:39,712 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:39,712 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:39,713 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:30:39,713 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 23.194470175281392
2023-11-26 00:30:39,713 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149874176
2023-11-26 00:30:39,713 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149890560
2023-11-26 00:30:39,714 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149875736.3809524
2023-11-26 00:30:39,714 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:39,715 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:39,715 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:39,715 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4809.417096411606
2023-11-26 00:30:39,716 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:30:39,716 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708087296
2023-11-26 00:30:39,716 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707301449.142857
2023-11-26 00:30:39,716 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:39,717 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:39,717 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:39,718 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 200571.74484631149
2023-11-26 00:30:39,718 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 18.7913875579834, 'train.runtime': 1.616736650466919, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04415273666381836, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 91.8, 'mean.cpu_utilization': 8.980952380952381, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 23.194470175281392, 'min.cpu_memory_rss': 1149874176, 'max.cpu_memory_rss': 1149890560, 'mean.cpu_memory_rss': 1149875736.3809524, '25th_prcntl.cpu_memory_rss': 1149874176.0, '50th_prcntl.cpu_memory_rss': 1149874176.0, '75th_prcntl.cpu_memory_rss': 1149874176.0, 'std.cpu_memory_rss': 4809.417096411606, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13708087296, 'mean.cpu_memory_vsz': 13707301449.142857, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 200571.74484631149, 'save_metrics.runtime': 0.008635759353637695}
2023-11-26 00:30:39,718 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:39,718 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008095741271972656
2023-11-26 00:30:39,718 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008095741271972656
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:39,719 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958639.7191145, tag: fetch
2023-11-26 00:30:39,719 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:30:39,719 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:39,719 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:39,719 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:39,720 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:39,720 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:39,720 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:39,720 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:39,720 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,720 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:39,720 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:39,720 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:39,720 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:39,721 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:51,659 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,661 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,662 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,662 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,662 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,662 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:30:51,662 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,662 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:30:51,663 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,664 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:51,664 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,665 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,666 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,667 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,667 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,667 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,667 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,667 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:30:51,667 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,667 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:30:51,668 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:30:51,668 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:30:51,669 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:51,669 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,670 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:51,670 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,672 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:51,672 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:51,679 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 31
2023-11-26 00:30:51,679 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:51,679 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.96052885055542
2023-11-26 00:30:51,679 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.96052885055542
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:51,817 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 5.642561
2023-11-26 00:30:52,685 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.087942
==== completed _train_epoch train()
2023-11-26 00:30:53,362 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.6820776462554932
2023-11-26 00:30:53,362 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.6820776462554932
2023-11-26 00:30:53,363 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:30:53,363 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:53,363 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958653.3634114, tag: upload
2023-11-26 00:30:53,363 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:30:53,364 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:53,364 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:53,365 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:53,365 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:53,365 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:53,366 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:53,366 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:53,366 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,366 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:53,366 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:53,366 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:53,367 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,367 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:53,392 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:53,393 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:53,393 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:53,394 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:53,399 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,400 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,401 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,402 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,402 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,405 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,405 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,405 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,405 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,405 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,405 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,405 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,405 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:53,406 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:53,407 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,407 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,408 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,409 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,409 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,409 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,409 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,409 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,409 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,409 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,409 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,409 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,409 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:53,409 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:53,410 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,410 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,410 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,410 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,410 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,412 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,412 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,412 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,413 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,413 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,413 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,413 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,413 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:53,413 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:53,414 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.05089855194091797
2023-11-26 00:30:53,414 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.05089855194091797
2023-11-26 00:30:53,415 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:53,415 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 77.9
2023-11-26 00:30:53,416 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 6.838461538461539
2023-11-26 00:30:53,417 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:53,418 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:53,418 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:30:53,419 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 20.64995952544137
2023-11-26 00:30:53,419 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149874176
2023-11-26 00:30:53,419 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149890560
2023-11-26 00:30:53,419 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149875436.3076923
2023-11-26 00:30:53,420 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:53,420 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:53,421 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:30:53,421 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4365.833912493613
2023-11-26 00:30:53,421 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:30:53,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:30:53,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707274397.538462
2023-11-26 00:30:53,422 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:53,423 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:53,423 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:30:53,424 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 121151.89107169777
2023-11-26 00:30:53,424 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 11.96052885055542, 'train.runtime': 1.6820776462554932, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.05089855194091797, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 77.9, 'mean.cpu_utilization': 6.838461538461539, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 20.64995952544137, 'min.cpu_memory_rss': 1149874176, 'max.cpu_memory_rss': 1149890560, 'mean.cpu_memory_rss': 1149875436.3076923, '25th_prcntl.cpu_memory_rss': 1149874176.0, '50th_prcntl.cpu_memory_rss': 1149874176.0, '75th_prcntl.cpu_memory_rss': 1149874176.0, 'std.cpu_memory_rss': 4365.833912493613, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707274397.538462, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 121151.89107169777, 'save_metrics.runtime': 0.008095741271972656}
2023-11-26 00:30:53,424 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:53,424 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009798049926757812
2023-11-26 00:30:53,424 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009798049926757812
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:53,425 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958653.4253018, tag: fetch
2023-11-26 00:30:53,425 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:30:53,425 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:53,426 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:53,426 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:53,427 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:53,427 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:53,427 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:53,427 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:53,427 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,427 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:53,427 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:53,427 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,428 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:53,428 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:10,374 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:10,378 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:10,378 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:10,378 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:10,378 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:10,379 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:10,379 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:10,380 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:10,381 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:10,382 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:10,383 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:10,384 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:10,387 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:10,387 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:10,387 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:10,391 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:10,392 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:10,393 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:10,393 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:10,395 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:10,396 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:10,396 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:10,397 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:10,397 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:10,397 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:10,397 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:10,397 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:10,397 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:10,397 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:10,397 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:10,398 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:10,398 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:10,398 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:10,399 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:10,399 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:10,405 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 34
2023-11-26 00:31:10,405 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:10,405 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 16.980300664901733
2023-11-26 00:31:10,405 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 16.980300664901733
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:10,499 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 2.013209
2023-11-26 00:31:11,329 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.046254
==== completed _train_epoch train()
2023-11-26 00:31:11,944 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5390195846557617
2023-11-26 00:31:11,945 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5390195846557617
2023-11-26 00:31:11,945 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:31:11,946 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:11,946 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958671.9462433, tag: upload
2023-11-26 00:31:11,946 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:11,947 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:11,947 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:11,948 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:11,948 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:11,948 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:11,948 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:11,949 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:11,949 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:11,949 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:11,949 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:11,949 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:11,949 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:11,949 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:11,965 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:11,966 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:11,966 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:11,967 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:11,972 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:11,972 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,974 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:11,974 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,974 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,977 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:11,977 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,977 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,977 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:11,977 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,977 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,977 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,977 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:11,978 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:11,979 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:11,979 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,980 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:11,980 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,980 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,980 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:11,981 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,981 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,981 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:11,981 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,981 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,981 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,981 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:11,981 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:11,981 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:11,981 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,982 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:11,982 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,982 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,984 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:11,984 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,984 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,984 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:11,984 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,984 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:11,984 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:11,984 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:11,984 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:11,985 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.039029598236083984
2023-11-26 00:31:11,985 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.039029598236083984
2023-11-26 00:31:11,985 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:11,986 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 87.8
2023-11-26 00:31:11,986 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.93157894736842
2023-11-26 00:31:11,987 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:11,987 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:11,988 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:11,988 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 24.15450383265328
2023-11-26 00:31:11,988 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149874176
2023-11-26 00:31:11,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149890560
2023-11-26 00:31:11,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149875900.631579
2023-11-26 00:31:11,989 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:11,990 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:11,990 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:11,990 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 5028.121886586599
2023-11-26 00:31:11,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:31:11,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:31:11,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707287282.526316
2023-11-26 00:31:11,991 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:11,992 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:11,992 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:11,993 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 139530.38235277814
2023-11-26 00:31:11,993 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 16.980300664901733, 'train.runtime': 1.5390195846557617, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.039029598236083984, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 87.8, 'mean.cpu_utilization': 8.93157894736842, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 24.15450383265328, 'min.cpu_memory_rss': 1149874176, 'max.cpu_memory_rss': 1149890560, 'mean.cpu_memory_rss': 1149875900.631579, '25th_prcntl.cpu_memory_rss': 1149874176.0, '50th_prcntl.cpu_memory_rss': 1149874176.0, '75th_prcntl.cpu_memory_rss': 1149874176.0, 'std.cpu_memory_rss': 5028.121886586599, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707287282.526316, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 139530.38235277814, 'save_metrics.runtime': 0.009798049926757812}
2023-11-26 00:31:11,993 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:11,993 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008060693740844727
2023-11-26 00:31:11,993 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008060693740844727
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:11,994 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958671.9940798, tag: fetch
2023-11-26 00:31:11,994 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:11,994 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:11,994 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:11,994 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:11,995 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:11,995 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:11,995 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:11,995 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:11,995 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:11,995 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:11,995 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:11,995 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:11,995 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:11,996 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:23,532 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,534 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,535 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,535 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,535 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,535 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:23,535 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,535 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:23,536 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,537 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:23,537 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,538 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,540 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,540 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,540 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,541 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,541 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,541 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:23,541 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,541 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:23,541 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:23,542 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:23,542 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,543 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:23,543 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,544 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:23,546 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:23,546 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:23,553 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 36
2023-11-26 00:31:23,554 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:23,554 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.560173511505127
2023-11-26 00:31:23,554 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.560173511505127
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:23,660 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 3.684838
2023-11-26 00:31:24,427 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.125745
==== completed _train_epoch train()
2023-11-26 00:31:25,069 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5151283740997314
2023-11-26 00:31:25,070 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5151283740997314
2023-11-26 00:31:25,070 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.0531158447265625e-06
2023-11-26 00:31:25,070 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.0531158447265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:25,070 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958685.0707996, tag: upload
2023-11-26 00:31:25,071 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:25,071 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:25,072 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:25,072 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:25,073 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:25,073 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:25,073 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:25,073 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:25,073 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,073 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:25,073 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:25,073 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:25,073 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,073 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:25,086 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:25,086 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:25,086 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:25,086 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:25,090 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,090 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,091 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,091 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,091 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,096 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,096 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,096 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,096 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,096 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,096 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,099 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,099 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:25,099 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:25,100 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,100 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,101 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,101 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,101 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,103 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,104 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,104 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,104 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,104 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,104 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,104 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,104 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:25,104 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:25,104 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,104 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,105 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,105 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,105 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,106 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,106 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,106 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,106 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,106 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,107 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,107 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,107 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:25,107 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:25,107 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03719472885131836
2023-11-26 00:31:25,108 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03719472885131836
2023-11-26 00:31:25,108 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:25,108 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 93.8
2023-11-26 00:31:25,109 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 10.13076923076923
2023-11-26 00:31:25,110 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:25,110 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:25,111 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:31:25,111 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 25.504189237046003
2023-11-26 00:31:25,111 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149874176
2023-11-26 00:31:25,112 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149894656
2023-11-26 00:31:25,112 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149877011.6923077
2023-11-26 00:31:25,112 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:25,113 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:25,113 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:25,113 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 6698.627269070943
2023-11-26 00:31:25,114 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:31:25,114 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:31:25,114 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707278808.615385
2023-11-26 00:31:25,114 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:25,115 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:25,115 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:25,116 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 120841.75589940784
2023-11-26 00:31:25,116 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 11.560173511505127, 'train.runtime': 1.5151283740997314, 'evaluate.runtime': 4.0531158447265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03719472885131836, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 93.8, 'mean.cpu_utilization': 10.13076923076923, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 25.504189237046003, 'min.cpu_memory_rss': 1149874176, 'max.cpu_memory_rss': 1149894656, 'mean.cpu_memory_rss': 1149877011.6923077, '25th_prcntl.cpu_memory_rss': 1149874176.0, '50th_prcntl.cpu_memory_rss': 1149874176.0, '75th_prcntl.cpu_memory_rss': 1149874176.0, 'std.cpu_memory_rss': 6698.627269070943, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707278808.615385, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 120841.75589940784, 'save_metrics.runtime': 0.008060693740844727}
2023-11-26 00:31:25,116 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:25,116 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008401632308959961
2023-11-26 00:31:25,116 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008401632308959961
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:25,117 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958685.1171718, tag: fetch
2023-11-26 00:31:25,117 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:25,117 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:25,117 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:25,118 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:25,118 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:25,118 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:25,118 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:25,118 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:25,119 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,119 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:25,119 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:25,119 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,119 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:25,119 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:27,576 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:27,576 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:27,576 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:27,577 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,812 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,815 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,816 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,816 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,816 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,816 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:36,817 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,817 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:36,818 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,820 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:36,822 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,823 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,825 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,826 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,826 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,826 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,826 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:36,826 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,826 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:36,827 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,829 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:36,830 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,838 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,839 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,839 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,839 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,840 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:36,840 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:36,840 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:36,840 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:36,841 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:36,841 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:36,844 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:36,844 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:36,844 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:36,851 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 38
2023-11-26 00:31:36,851 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:36,851 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.734330654144287
2023-11-26 00:31:36,851 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.734330654144287
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:36,964 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 3.585598
2023-11-26 00:31:37,706 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.155321
==== completed _train_epoch train()
2023-11-26 00:31:38,279 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.4281456470489502
2023-11-26 00:31:38,280 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.4281456470489502
2023-11-26 00:31:38,280 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.337860107421875e-06
2023-11-26 00:31:38,280 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.337860107421875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:38,281 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958698.2810488, tag: upload
2023-11-26 00:31:38,281 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:38,282 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:38,282 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:38,283 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:38,283 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:38,283 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:38,283 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:38,284 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:38,284 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,284 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:38,284 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:38,284 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:38,284 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,284 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:38,301 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:38,301 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:38,302 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:38,303 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:38,308 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,308 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,310 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,310 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,310 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,313 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,313 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,313 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,313 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,313 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,313 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,314 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,314 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:38,314 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:38,316 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,316 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,318 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,318 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,318 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,318 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,318 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,318 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,318 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,318 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,318 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,319 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,319 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:38,319 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:38,319 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,319 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,319 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,319 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,319 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,321 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:38,321 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,321 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,322 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:38,322 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,322 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:38,322 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:38,322 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:38,322 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:38,322 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04191255569458008
2023-11-26 00:31:38,323 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04191255569458008
2023-11-26 00:31:38,323 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:38,323 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 68.9
2023-11-26 00:31:38,324 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.446153846153846
2023-11-26 00:31:38,325 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:38,325 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:38,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:38,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 20.40518845726085
2023-11-26 00:31:38,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149874176
2023-11-26 00:31:38,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149894656
2023-11-26 00:31:38,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149875751.3846154
2023-11-26 00:31:38,327 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:38,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:38,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149874176.0
2023-11-26 00:31:38,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 5457.292390617016
2023-11-26 00:31:38,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:31:38,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:31:38,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707274397.538462
2023-11-26 00:31:38,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:38,330 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:38,330 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:38,330 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 121151.89107169777
2023-11-26 00:31:38,331 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 11.734330654144287, 'train.runtime': 1.4281456470489502, 'evaluate.runtime': 3.337860107421875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04191255569458008, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 68.9, 'mean.cpu_utilization': 8.446153846153846, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 20.40518845726085, 'min.cpu_memory_rss': 1149874176, 'max.cpu_memory_rss': 1149894656, 'mean.cpu_memory_rss': 1149875751.3846154, '25th_prcntl.cpu_memory_rss': 1149874176.0, '50th_prcntl.cpu_memory_rss': 1149874176.0, '75th_prcntl.cpu_memory_rss': 1149874176.0, 'std.cpu_memory_rss': 5457.292390617016, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707274397.538462, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 121151.89107169777, 'save_metrics.runtime': 0.008401632308959961}
2023-11-26 00:31:38,331 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:38,331 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008310794830322266
2023-11-26 00:31:38,331 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008310794830322266
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:38,332 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958698.3320882, tag: fetch
2023-11-26 00:31:38,332 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:38,332 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:38,332 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:38,333 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:38,333 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:38,333 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:38,333 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:38,333 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:38,334 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,334 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:38,334 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:38,334 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:38,334 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:38,334 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:57,050 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:57,053 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:57,053 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:57,053 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:57,053 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:57,053 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:57,053 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:57,053 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:31:57,054 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:57,055 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:57,056 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:57,057 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:57,058 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:57,060 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:57,060 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:57,060 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:57,060 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:57,060 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:57,060 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:57,060 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:31:57,061 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:57,062 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:57,062 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:57,063 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:57,063 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:57,063 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:57,063 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:57,063 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:57,063 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:57,063 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:57,063 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:31:57,064 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:57,064 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:57,064 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:57,067 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:57,067 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:57,083 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 41
2023-11-26 00:31:57,083 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:57,083 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.751444578170776
2023-11-26 00:31:57,083 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.751444578170776
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:57,221 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 2.197006
2023-11-26 00:31:58,007 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.048381
==== completed _train_epoch train()
2023-11-26 00:31:58,641 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5442731380462646
2023-11-26 00:31:58,641 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5442731380462646
2023-11-26 00:31:58,642 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:31:58,642 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:58,642 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958718.6427612, tag: upload
2023-11-26 00:31:58,643 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:58,644 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:58,644 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:58,644 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:58,645 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:58,645 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:58,645 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:58,646 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:58,646 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:58,646 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:58,646 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:58,646 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:58,646 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:58,646 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:58,664 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154213
2023-11-26 00:31:58,665 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154213
2023-11-26 00:31:58,665 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154213
2023-11-26 00:31:58,666 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:58,669 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:58,670 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,672 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:58,672 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,672 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,675 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:58,675 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,675 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,675 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:58,675 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,675 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,675 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,675 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:58,676 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:58,677 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:58,677 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,679 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:58,679 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,679 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,679 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:58,680 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,680 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,680 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:58,680 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,680 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,680 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,680 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:58,681 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57061
2023-11-26 00:31:58,681 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:58,681 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,681 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:58,682 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,682 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,683 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:58,683 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,683 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,684 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:58,684 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,684 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:58,684 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:58,684 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:58,685 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:58,685 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04290318489074707
2023-11-26 00:31:58,685 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04290318489074707
2023-11-26 00:31:58,686 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:58,686 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 59.8
2023-11-26 00:31:58,687 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.685
2023-11-26 00:31:58,688 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:58,688 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:58,689 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:31:58,689 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 16.61846187226724
2023-11-26 00:31:58,689 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149968384
2023-11-26 00:31:58,690 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150107648
2023-11-26 00:31:58,690 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149975347.2
2023-11-26 00:31:58,690 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149968384.0
2023-11-26 00:31:58,691 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149968384.0
2023-11-26 00:31:58,691 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149968384.0
2023-11-26 00:31:58,692 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 30351.885123662418
2023-11-26 00:31:58,692 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:31:58,692 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:31:58,692 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707262156.8
2023-11-26 00:31:58,693 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:58,693 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:58,694 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:31:58,694 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99089.97790372142
2023-11-26 00:31:58,694 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 18.751444578170776, 'train.runtime': 1.5442731380462646, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154213, 'upload.runtime': 0.04290318489074707, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 59.8, 'mean.cpu_utilization': 5.685, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 16.61846187226724, 'min.cpu_memory_rss': 1149968384, 'max.cpu_memory_rss': 1150107648, 'mean.cpu_memory_rss': 1149975347.2, '25th_prcntl.cpu_memory_rss': 1149968384.0, '50th_prcntl.cpu_memory_rss': 1149968384.0, '75th_prcntl.cpu_memory_rss': 1149968384.0, 'std.cpu_memory_rss': 30351.885123662418, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707262156.8, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 99089.97790372142, 'save_metrics.runtime': 0.008310794830322266}
2023-11-26 00:31:58,694 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:58,695 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009097814559936523
2023-11-26 00:31:58,695 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009097814559936523
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:58,695 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958718.695552, tag: fetch
2023-11-26 00:31:58,695 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:31:58,696 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:58,696 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:58,696 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:58,696 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:58,696 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:58,696 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:58,696 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:58,696 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:58,696 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:58,697 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:58,697 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:58,697 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:58,697 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:10,194 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,197 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,198 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,198 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,198 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,201 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,201 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,201 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,202 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,202 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:32:10,202 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,203 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:32:10,204 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,206 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:10,207 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,207 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:10,207 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:32:10,208 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:10,208 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:32:10,208 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:32:10,209 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:32:10,211 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:10,212 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:10,211 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:10,212 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:10,215 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:10,216 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:10,228 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 43
2023-11-26 00:32:10,228 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:10,228 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.533258438110352
2023-11-26 00:32:10,229 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.533258438110352
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:10,362 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 4.026894
2023-11-26 00:32:11,201 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.277798
==== completed _train_epoch train()
2023-11-26 00:32:11,835 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.606121301651001
2023-11-26 00:32:11,836 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.606121301651001
2023-11-26 00:32:11,836 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:32:11,836 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:11,836 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958731.8368297, tag: upload
2023-11-26 00:32:11,837 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:32:11,838 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:11,838 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:11,838 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:11,839 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:11,839 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:11,839 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:11,839 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:11,839 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,840 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:11,840 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:11,840 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:11,840 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,840 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:11,857 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:11,857 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:11,857 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:11,858 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:11,862 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,863 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,864 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,864 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,864 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,867 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,867 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,868 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,868 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,868 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,868 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,868 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,868 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:11,868 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:11,870 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,870 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,870 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,871 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,871 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,871 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,871 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,871 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,871 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,871 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,871 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,872 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,872 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:11,872 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:11,872 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,872 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,872 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,874 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:11,874 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,874 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,874 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:11,875 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,875 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:11,875 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:11,875 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:11,875 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:11,875 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03911185264587402
2023-11-26 00:32:11,876 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03911185264587402
2023-11-26 00:32:11,876 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:11,877 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 89.8
2023-11-26 00:32:11,877 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 15.678571428571429
2023-11-26 00:32:11,878 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:11,879 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:11,879 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.75
2023-11-26 00:32:11,879 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 31.848798554855332
2023-11-26 00:32:11,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150091264
2023-11-26 00:32:11,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150111744
2023-11-26 00:32:11,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150093897.142857
2023-11-26 00:32:11,881 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150091264.0
2023-11-26 00:32:11,881 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150091264.0
2023-11-26 00:32:11,881 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150091264.0
2023-11-26 00:32:11,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 6496.139940183631
2023-11-26 00:32:11,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:32:11,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708091392
2023-11-26 00:32:11,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707332754.285715
2023-11-26 00:32:11,883 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:11,883 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:11,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:11,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 240626.2603111866
2023-11-26 00:32:11,884 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 11.533258438110352, 'train.runtime': 1.606121301651001, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03911185264587402, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 89.8, 'mean.cpu_utilization': 15.678571428571429, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.75, 'std.cpu_utilization': 31.848798554855332, 'min.cpu_memory_rss': 1150091264, 'max.cpu_memory_rss': 1150111744, 'mean.cpu_memory_rss': 1150093897.142857, '25th_prcntl.cpu_memory_rss': 1150091264.0, '50th_prcntl.cpu_memory_rss': 1150091264.0, '75th_prcntl.cpu_memory_rss': 1150091264.0, 'std.cpu_memory_rss': 6496.139940183631, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13708091392, 'mean.cpu_memory_vsz': 13707332754.285715, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 240626.2603111866, 'save_metrics.runtime': 0.009097814559936523}
2023-11-26 00:32:11,885 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:11,885 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008960723876953125
2023-11-26 00:32:11,885 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008960723876953125
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:11,885 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958731.8857, tag: fetch
2023-11-26 00:32:11,885 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:32:11,886 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:11,886 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:11,886 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:11,886 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:11,887 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:11,887 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:11,887 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:11,887 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,887 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:11,887 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:11,887 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:11,887 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:11,887 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:27,660 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:27,661 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:27,661 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:27,661 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,492 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,495 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,495 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,495 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,496 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,496 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:32:36,496 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,496 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:32:36,497 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,499 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,498 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:36,517 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,518 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,519 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,519 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,519 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,519 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:32:36,519 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,519 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:32:36,520 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,520 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,520 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:36,530 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,530 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,530 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,530 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,531 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,531 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:32:36,531 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,531 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:32:36,531 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,531 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,531 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:36,533 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:36,533 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:36,540 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 47
2023-11-26 00:32:36,540 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:36,540 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 24.65521216392517
2023-11-26 00:32:36,541 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 24.65521216392517
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:36,657 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 1.844383
2023-11-26 00:32:37,490 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.345634
==== completed _train_epoch train()
2023-11-26 00:32:38,161 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.6199564933776855
2023-11-26 00:32:38,161 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.6199564933776855
2023-11-26 00:32:38,162 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.337860107421875e-06
2023-11-26 00:32:38,162 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.337860107421875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:38,162 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958758.1624982, tag: upload
2023-11-26 00:32:38,162 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:32:38,163 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:38,164 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:38,164 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:38,165 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:38,165 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:38,165 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:38,166 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:38,166 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:38,166 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:38,166 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:38,167 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:38,167 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:38,167 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:38,187 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:38,188 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:38,188 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:38,189 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:38,193 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:38,193 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,195 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:38,195 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,195 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,198 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:38,198 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,198 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,198 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:38,198 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,199 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,199 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,199 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:38,199 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:38,200 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:38,201 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,202 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:38,202 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,202 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,202 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:38,202 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,202 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,202 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:38,203 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,203 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,203 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,203 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:38,203 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:38,203 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:38,203 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,203 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:38,204 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,204 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,205 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:38,205 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,205 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,205 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:38,206 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,206 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:38,206 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:38,206 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:38,206 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:38,206 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.044460296630859375
2023-11-26 00:32:38,207 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.044460296630859375
2023-11-26 00:32:38,207 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:38,207 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 89.8
2023-11-26 00:32:38,208 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.646153846153846
2023-11-26 00:32:38,209 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:38,209 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:38,210 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:38,210 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.437564022914852
2023-11-26 00:32:38,210 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150091264
2023-11-26 00:32:38,210 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150107648
2023-11-26 00:32:38,211 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150092524.3076923
2023-11-26 00:32:38,211 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150091264.0
2023-11-26 00:32:38,211 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150091264.0
2023-11-26 00:32:38,212 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150091264.0
2023-11-26 00:32:38,212 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4365.833912493613
2023-11-26 00:32:38,212 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:32:38,213 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:32:38,213 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707274397.538462
2023-11-26 00:32:38,213 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:38,214 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:38,214 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:38,214 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 121151.89107169777
2023-11-26 00:32:38,215 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 24.65521216392517, 'train.runtime': 1.6199564933776855, 'evaluate.runtime': 3.337860107421875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.044460296630859375, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 89.8, 'mean.cpu_utilization': 4.646153846153846, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 17.437564022914852, 'min.cpu_memory_rss': 1150091264, 'max.cpu_memory_rss': 1150107648, 'mean.cpu_memory_rss': 1150092524.3076923, '25th_prcntl.cpu_memory_rss': 1150091264.0, '50th_prcntl.cpu_memory_rss': 1150091264.0, '75th_prcntl.cpu_memory_rss': 1150091264.0, 'std.cpu_memory_rss': 4365.833912493613, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707274397.538462, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 121151.89107169777, 'save_metrics.runtime': 0.008960723876953125}
2023-11-26 00:32:38,215 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:38,215 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.00837397575378418
2023-11-26 00:32:38,215 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.00837397575378418
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:38,216 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958758.2161033, tag: fetch
2023-11-26 00:32:38,216 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:32:38,216 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:38,216 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:38,217 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:38,217 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:38,217 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:38,217 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:38,217 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:38,217 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:38,217 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:38,217 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:38,217 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:38,217 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:38,218 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:49,556 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,559 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,559 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,559 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,559 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,559 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:32:49,560 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,560 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048675
2023-11-26 00:32:49,561 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,562 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:49,562 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,569 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,571 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,572 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,572 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,572 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,572 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:32:49,572 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,572 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 1048677
2023-11-26 00:32:49,573 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,574 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:49,574 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,575 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,575 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,575 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,575 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,575 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,575 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:32:49,575 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,576 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374; len: 57155
2023-11-26 00:32:49,576 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,576 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:49,576 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,579 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:49,579 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:49,588 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 49
2023-11-26 00:32:49,588 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:49,588 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.37250566482544
2023-11-26 00:32:49,588 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.37250566482544
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:49,667 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5749 (0%)]	loss: 1.587578
2023-11-26 00:32:50,541 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5749 (56%)]	loss: 0.182586
==== completed _train_epoch train()
2023-11-26 00:32:51,231 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.6424870491027832
2023-11-26 00:32:51,233 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.6424870491027832
2023-11-26 00:32:51,234 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 8.344650268554688e-06
2023-11-26 00:32:51,234 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 8.344650268554688e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:51,235 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958771.2350276, tag: upload
2023-11-26 00:32:51,235 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:32:51,237 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:51,238 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:51,238 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:51,239 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:51,239 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:51,239 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:51,239 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,240 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,240 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:51,240 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,240 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:51,240 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,240 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:51,260 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:51,260 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:51,260 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:51,261 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:51,265 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,265 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,267 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,267 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,267 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,270 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,270 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,270 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,271 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,271 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,271 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,271 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,271 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,271 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:51,272 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,273 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,274 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,274 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,274 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,274 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,275 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,275 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,275 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,275 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,275 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,275 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,275 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,275 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:51,275 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,275 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,275 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,276 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,276 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,278 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,278 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,278 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,278 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,278 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,278 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,278 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,278 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580374/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,278 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:51,279 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.044333457946777344
2023-11-26 00:32:51,279 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.044333457946777344
2023-11-26 00:32:51,280 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:51,280 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 89.8
2023-11-26 00:32:51,281 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 10.899999999999999
2023-11-26 00:32:51,282 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:51,283 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:51,283 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:32:51,284 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 25.080976548280265
2023-11-26 00:32:51,284 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150128128
2023-11-26 00:32:51,284 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150148608
2023-11-26 00:32:51,284 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150131278.7692308
2023-11-26 00:32:51,285 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150128128.0
2023-11-26 00:32:51,285 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150128128.0
2023-11-26 00:32:51,286 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150128128.0
2023-11-26 00:32:51,286 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 7389.208827783372
2023-11-26 00:32:51,286 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707239424
2023-11-26 00:32:51,286 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707694080
2023-11-26 00:32:51,286 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707309371.076923
2023-11-26 00:32:51,287 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:51,287 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:51,288 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707239424.0
2023-11-26 00:32:51,288 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 164040.43597679088
2023-11-26 00:32:51,288 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.00856161117553711, 'load_data.runtime': 0.9201302528381348, 'init.runtime': 1.6665840148925781, 'recv.bytes': 2154204, 'fetch.runtime': 11.37250566482544, 'train.runtime': 1.6424870491027832, 'evaluate.runtime': 8.344650268554688e-06, 'send.bytes': 2154215, 'upload.runtime': 0.044333457946777344, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 89.8, 'mean.cpu_utilization': 10.899999999999999, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 25.080976548280265, 'min.cpu_memory_rss': 1150128128, 'max.cpu_memory_rss': 1150148608, 'mean.cpu_memory_rss': 1150131278.7692308, '25th_prcntl.cpu_memory_rss': 1150128128.0, '50th_prcntl.cpu_memory_rss': 1150128128.0, '75th_prcntl.cpu_memory_rss': 1150128128.0, 'std.cpu_memory_rss': 7389.208827783372, 'min.cpu_memory_vsz': 13707239424, 'max.cpu_memory_vsz': 13707694080, 'mean.cpu_memory_vsz': 13707309371.076923, '25th_prcntl.cpu_memory_vsz': 13707239424.0, '50th_prcntl.cpu_memory_vsz': 13707239424.0, '75th_prcntl.cpu_memory_vsz': 13707239424.0, 'std.cpu_memory_vsz': 164040.43597679088, 'save_metrics.runtime': 0.00837397575378418}
2023-11-26 00:32:51,289 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:51,289 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009595155715942383
2023-11-26 00:32:51,289 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009595155715942383
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:51,289 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958771.2897427, tag: fetch
2023-11-26 00:32:51,289 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f63eb1f06a0>
2023-11-26 00:32:51,290 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:51,290 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:51,290 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:51,291 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:51,291 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:51,291 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:51,291 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,291 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,291 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:51,291 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:51,291 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580374, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580374': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,291 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:51,291 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:33:03,068 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,069 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,070 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,070 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,070 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,070 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,071 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,071 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,071 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 59
2023-11-26 00:33:03,072 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,073 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 59
2023-11-26 00:33:03,073 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 59
extracting weights from message
2023-11-26 00:33:03,074 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: True, round: 49
2023-11-26 00:33:03,074 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:33:03,074 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.78475308418274
2023-11-26 00:33:03,074 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.78475308418274
2023-11-26 00:33:03,074 | composer.py:145 | DEBUG | MainThread | run | end of run
2023-11-26 00:33:03,077 | channel_manager.py:187 | DEBUG | MainThread | cleanup | calling cleanup
2023-11-26 00:33:03,077 | channel_manager.py:189 | DEBUG | MainThread | cleanup | calling leave for channel param-channel
2023-11-26 00:33:03,077 | channel.py:414 | DEBUG | MainThread | leave | calling channel leave for param-channel
2023-11-26 00:33:03,078 | channel.py:420 | DEBUG | MainThread | leave |  channel leave done for param-channel
2023-11-26 00:33:03,079 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-126
2023-11-26 00:33:03,080 | mqtt.py:552 | DEBUG | Thread-3 | misc_loop | misc_loop finished
2023-11-26 00:33:03,080 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-2
2023-11-26 00:33:03,080 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-8
2023-11-26 00:33:03,080 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-7
2023-11-26 00:33:03,080 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-4
2023-11-26 00:33:03,080 | channel_manager.py:200 | DEBUG | Thread-3 | _inner | done with cleaning up asyncio tasks
