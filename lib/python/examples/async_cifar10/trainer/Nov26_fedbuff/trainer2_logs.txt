2023-11-26 00:27:23,255 | metric_collector.py:52 | DEBUG | Thread-2 | gather_gpu_stats | could not start gpustat.nvml.pynvml; no GPU metrics will be collected
2023-11-26 00:27:23,269 | fedadagrad.py:27 | DEBUG | MainThread | FedAdaGrad | Initializing fedadagrad
2023-11-26 00:27:23,269 | fedadam.py:27 | DEBUG | MainThread | FedAdam | Initializing fedadam
2023-11-26 00:27:23,271 | fedyogi.py:27 | DEBUG | MainThread | FedYogi | Initializing fedyogi
2023-11-26 00:27:26,369 | channel_manager.py:72 | INFO | MainThread | __new__ | creating a ChannelManager instance
2023-11-26 00:27:26,369 | selector_events.py:54 | DEBUG | MainThread | __init__ | Using selector: EpollSelector
2023-11-26 00:27:26,372 | mqtt.py:514 | DEBUG | Thread-3 | on_socket_open | Socket opened
2023-11-26 00:27:26,373 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,373 | mqtt.py:546 | DEBUG | Thread-3 | misc_loop | misc_loop started
2023-11-26 00:27:26,374 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,374 | channel_manager.py:146 | INFO | MainThread | join | no backend found for channel param-channel; use default
2023-11-26 00:27:26,374 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,375 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,375 | mqtt.py:294 | DEBUG | Thread-3 | on_connect | calling on_connect
2023-11-26 00:27:26,376 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,376 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,376 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,377 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,377 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/+
2023-11-26 00:27:26,378 | mqtt.py:531 | DEBUG | MainThread | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,378 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/+/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372
2023-11-26 00:27:26,378 | mqtt.py:349 | DEBUG | MainThread | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372
2023-11-26 00:27:26,378 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[internal_init.runtime] = 0.009158849716186523
2023-11-26 00:27:26,378 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of internal_init is 0.009158849716186523
2023-11-26 00:27:26,379 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,379 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,380 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,380 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,380 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,381 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,381 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,381 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,381 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,382 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580372, status: online
2023-11-26 00:27:26,382 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,382 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,383 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,383 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,383 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,383 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,384 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,384 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,384 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,384 | mqtt.py:234 | DEBUG | Thread-3 | _handle_notification | acknowledge notification
2023-11-26 00:27:26,384 | mqtt.py:349 | DEBUG | Thread-3 | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372
2023-11-26 00:27:26,385 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,385 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,385 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,386 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,386 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,386 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,386 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,386 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,422 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,423 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,423 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580376, status: online
2023-11-26 00:27:26,423 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,467 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,468 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,468 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,468 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,468 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,469 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,469 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,469 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,469 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,469 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,472 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,473 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,473 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,473 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,473 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,474 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,474 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,474 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,474 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,474 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,475 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,475 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,476 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,476 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,476 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,476 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,476 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,477 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,477 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,477 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,622 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,623 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,623 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580374, status: online
Files already downloaded and verified
2023-11-26 00:27:26,714 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,714 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,715 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,715 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,715 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,716 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,716 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,716 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,008 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,009 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:27,009 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580371, status: online
2023-11-26 00:27:27,132 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,135 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,135 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,135 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,136 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,136 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,136 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,136 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,137 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,137 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
indices:  tensor([ 6223, 34011, 17655,  ..., 41144, 35499, 11188])
2023-11-26 00:27:27,321 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[load_data.runtime] = 0.9422140121459961
2023-11-26 00:27:27,321 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of load_data is 0.9422140121459961
2023-11-26 00:27:29,204 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[init.runtime] = 1.8828284740447998
2023-11-26 00:27:29,205 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of init is 1.8828284740447998
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:29,205 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958449.205553, tag: fetch
2023-11-26 00:27:29,205 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:27:29,207 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:29,207 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:29,208 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:29,208 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:29,208 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:29,209 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:29,209 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:29,209 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': set()}
2023-11-26 00:27:29,209 | fedbuff.py:165 | DEBUG | Thread-3 | _handle_recv_state | let's select 1 ends
2023-11-26 00:27:29,212 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:29,212 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:29,212 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:29,213 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:30,610 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,621 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,622 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,628 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,628 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,629 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,629 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,629 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:27:30,630 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:27:30,632 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,632 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,632 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,632 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:27:30,632 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,633 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:27:30,633 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:27:30,633 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:27:30,634 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,634 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,635 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:30,637 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:30,637 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:30,640 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:30,640 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:30,653 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 1
2023-11-26 00:27:30,653 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:30,653 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 1.4481556415557861
2023-11-26 00:27:30,653 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 1.4481556415557861
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:31,199 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 2.368804
2023-11-26 00:27:32,078 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.473963
==== completed _train_epoch train()
2023-11-26 00:27:32,814 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.1599996089935303
2023-11-26 00:27:32,814 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.1599996089935303
2023-11-26 00:27:32,815 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.5299530029296875e-06
2023-11-26 00:27:32,815 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.5299530029296875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:32,815 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958452.8156185, tag: upload
2023-11-26 00:27:32,815 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:27:32,817 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:32,817 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:32,817 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:32,818 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:32,818 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:32,818 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:32,819 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:32,819 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,819 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:32,819 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:32,819 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:32,819 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,819 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:32,838 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:32,838 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:32,838 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:32,839 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:32,844 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,845 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,847 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,847 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,847 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,851 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,851 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,852 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,852 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,852 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,852 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,852 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,853 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:32,853 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:32,855 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,855 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,856 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,856 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,856 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,857 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,857 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,857 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,857 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,857 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,858 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,858 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,858 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:32,858 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:32,858 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,859 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,859 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,859 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,859 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,860 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,861 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,861 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,861 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,861 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,861 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,862 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,862 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:32,862 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:32,862 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.047222137451171875
2023-11-26 00:27:32,862 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.047222137451171875
2023-11-26 00:27:32,863 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:32,863 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 137.4
2023-11-26 00:27:32,864 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 61.588888888888896
2023-11-26 00:27:32,865 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 17.0
2023-11-26 00:27:32,866 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 58.9
2023-11-26 00:27:32,867 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 99.5
2023-11-26 00:27:32,867 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 44.64326363130636
2023-11-26 00:27:32,867 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 67878912
2023-11-26 00:27:32,868 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1135853568
2023-11-26 00:27:32,868 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 724854101.3333334
2023-11-26 00:27:32,869 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 510537728.0
2023-11-26 00:27:32,869 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 881111040.0
2023-11-26 00:27:32,870 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 976961536.0
2023-11-26 00:27:32,870 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 332721818.5629783
2023-11-26 00:27:32,870 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 1881554944
2023-11-26 00:27:32,870 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13703217152
2023-11-26 00:27:32,871 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 9589646677.333334
2023-11-26 00:27:32,871 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 6995972096.0
2023-11-26 00:27:32,872 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 12037451776.0
2023-11-26 00:27:32,872 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 12240875520.0
2023-11-26 00:27:32,872 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 3789281223.065636
2023-11-26 00:27:32,873 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 1.4481556415557861, 'train.runtime': 2.1599996089935303, 'evaluate.runtime': 4.5299530029296875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.047222137451171875, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 137.4, 'mean.cpu_utilization': 61.588888888888896, '25th_prcntl.cpu_utilization': 17.0, '50th_prcntl.cpu_utilization': 58.9, '75th_prcntl.cpu_utilization': 99.5, 'std.cpu_utilization': 44.64326363130636, 'min.cpu_memory_rss': 67878912, 'max.cpu_memory_rss': 1135853568, 'mean.cpu_memory_rss': 724854101.3333334, '25th_prcntl.cpu_memory_rss': 510537728.0, '50th_prcntl.cpu_memory_rss': 881111040.0, '75th_prcntl.cpu_memory_rss': 976961536.0, 'std.cpu_memory_rss': 332721818.5629783, 'min.cpu_memory_vsz': 1881554944, 'max.cpu_memory_vsz': 13703217152, 'mean.cpu_memory_vsz': 9589646677.333334, '25th_prcntl.cpu_memory_vsz': 6995972096.0, '50th_prcntl.cpu_memory_vsz': 12037451776.0, '75th_prcntl.cpu_memory_vsz': 12240875520.0, 'std.cpu_memory_vsz': 3789281223.065636}
2023-11-26 00:27:32,873 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:32,873 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.010650873184204102
2023-11-26 00:27:32,873 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.010650873184204102
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:32,874 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958452.8744156, tag: fetch
2023-11-26 00:27:32,874 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:27:32,875 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:32,875 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:32,875 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:32,876 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:32,876 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:32,876 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:32,876 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:32,876 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,876 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:32,876 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:32,876 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,877 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:32,877 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:58,491 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,494 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,494 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,494 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,496 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,498 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,499 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,499 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,499 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,499 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:27:58,500 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,500 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:27:58,501 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,502 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:58,503 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,503 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:58,503 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:27:58,503 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:58,504 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:27:58,504 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:27:58,505 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:27:58,506 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:58,506 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:58,507 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:58,507 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:58,509 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:58,510 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:58,522 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 5
2023-11-26 00:27:58,523 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:58,523 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 25.64883804321289
2023-11-26 00:27:58,523 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 25.64883804321289
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:58,612 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 2.774859
2023-11-26 00:27:59,424 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.286811
==== completed _train_epoch train()
2023-11-26 00:28:00,112 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5889551639556885
2023-11-26 00:28:00,112 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5889551639556885
2023-11-26 00:28:00,113 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.3828277587890625e-05
2023-11-26 00:28:00,113 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.3828277587890625e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:00,113 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958480.1136417, tag: upload
2023-11-26 00:28:00,113 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:28:00,114 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:00,115 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:00,115 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:00,115 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:00,116 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:00,116 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:00,116 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:00,116 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:00,116 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:00,116 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:00,116 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:00,116 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:00,117 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:00,133 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:00,133 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:00,133 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:00,134 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:00,140 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:00,141 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,143 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:00,143 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,143 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,146 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:00,146 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,146 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,146 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:00,147 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,147 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,147 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,147 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:00,147 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:00,148 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:00,149 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,149 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:00,149 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,150 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,150 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:00,150 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,150 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,150 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:00,150 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,150 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,150 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,150 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:00,150 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:00,151 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:00,151 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,151 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:00,151 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,151 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,153 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:00,153 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,153 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,153 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:00,153 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,153 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:00,153 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:00,153 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:00,154 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:00,154 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.041042327880859375
2023-11-26 00:28:00,154 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.041042327880859375
2023-11-26 00:28:00,155 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:00,156 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 91.9
2023-11-26 00:28:00,156 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.207142857142857
2023-11-26 00:28:00,157 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:00,158 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:00,158 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:00,158 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 22.13273155583036
2023-11-26 00:28:00,159 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1141174272
2023-11-26 00:28:00,159 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1145462784
2023-11-26 00:28:00,159 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1141480448.0
2023-11-26 00:28:00,160 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1141174272.0
2023-11-26 00:28:00,160 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1141174272.0
2023-11-26 00:28:00,160 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1141174272.0
2023-11-26 00:28:00,161 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 1103933.4030099565
2023-11-26 00:28:00,161 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13704790016
2023-11-26 00:28:00,161 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707505664
2023-11-26 00:28:00,161 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13704983990.857143
2023-11-26 00:28:00,162 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13704790016.0
2023-11-26 00:28:00,162 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13704790016.0
2023-11-26 00:28:00,163 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13704790016.0
2023-11-26 00:28:00,163 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 699386.2935793737
2023-11-26 00:28:00,163 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 25.64883804321289, 'train.runtime': 1.5889551639556885, 'evaluate.runtime': 1.3828277587890625e-05, 'send.bytes': 2154215, 'upload.runtime': 0.041042327880859375, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 91.9, 'mean.cpu_utilization': 7.207142857142857, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 22.13273155583036, 'min.cpu_memory_rss': 1141174272, 'max.cpu_memory_rss': 1145462784, 'mean.cpu_memory_rss': 1141480448.0, '25th_prcntl.cpu_memory_rss': 1141174272.0, '50th_prcntl.cpu_memory_rss': 1141174272.0, '75th_prcntl.cpu_memory_rss': 1141174272.0, 'std.cpu_memory_rss': 1103933.4030099565, 'min.cpu_memory_vsz': 13704790016, 'max.cpu_memory_vsz': 13707505664, 'mean.cpu_memory_vsz': 13704983990.857143, '25th_prcntl.cpu_memory_vsz': 13704790016.0, '50th_prcntl.cpu_memory_vsz': 13704790016.0, '75th_prcntl.cpu_memory_vsz': 13704790016.0, 'std.cpu_memory_vsz': 699386.2935793737, 'save_metrics.runtime': 0.010650873184204102}
2023-11-26 00:28:00,163 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:00,164 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009064674377441406
2023-11-26 00:28:00,164 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009064674377441406
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:00,164 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958480.164548, tag: fetch
2023-11-26 00:28:00,164 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:28:00,165 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:00,165 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:00,165 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:00,166 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:00,166 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:00,166 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:00,166 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:00,166 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:00,166 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:00,166 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:00,166 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:00,166 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:00,167 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:11,864 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,867 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,868 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,868 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,868 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,868 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:28:11,868 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,869 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:28:11,870 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,871 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:11,871 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,877 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,879 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,879 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,879 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,879 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,879 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:28:11,879 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,879 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:28:11,881 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,882 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,882 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:11,884 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,884 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,884 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,884 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,884 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:11,884 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:28:11,884 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:11,885 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:28:11,885 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:11,885 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:11,887 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:11,887 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:11,887 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:11,897 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 7
2023-11-26 00:28:11,898 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:11,898 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.733818769454956
2023-11-26 00:28:11,898 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.733818769454956
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:12,018 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 2.350096
2023-11-26 00:28:12,798 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.388763
==== completed _train_epoch train()
2023-11-26 00:28:13,442 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5441875457763672
2023-11-26 00:28:13,443 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5441875457763672
2023-11-26 00:28:13,443 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 9.5367431640625e-06
2023-11-26 00:28:13,443 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 9.5367431640625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:13,443 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958493.4436424, tag: upload
2023-11-26 00:28:13,443 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:28:13,444 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:13,444 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:13,445 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:13,445 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:13,446 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:13,446 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:13,446 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:13,446 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:13,446 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:13,446 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:13,446 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:13,446 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:13,447 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:13,460 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:13,460 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:13,461 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:13,461 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:13,467 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:13,467 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,469 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:13,469 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,469 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,472 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:13,472 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,472 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,472 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:13,472 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,472 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,473 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,473 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:13,473 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:13,474 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:13,474 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,475 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:13,475 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,475 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,476 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:13,476 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,476 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,476 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:13,476 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,476 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,476 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,476 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:13,476 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:13,476 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:13,477 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,477 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:13,477 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,477 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,479 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:13,479 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,479 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,479 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:13,479 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,479 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:13,479 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:13,480 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:13,480 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:13,480 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03710222244262695
2023-11-26 00:28:13,480 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03710222244262695
2023-11-26 00:28:13,481 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:13,481 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 81.9
2023-11-26 00:28:13,482 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.146153846153847
2023-11-26 00:28:13,483 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:13,484 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:13,485 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:28:13,485 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 21.787315130408246
2023-11-26 00:28:13,485 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1147596800
2023-11-26 00:28:13,486 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1147801600
2023-11-26 00:28:13,486 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1147627677.5384614
2023-11-26 00:28:13,486 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1147596800.0
2023-11-26 00:28:13,487 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1147596800.0
2023-11-26 00:28:13,488 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1147596800.0
2023-11-26 00:28:13,488 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 72432.06615922727
2023-11-26 00:28:13,488 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707051008
2023-11-26 00:28:13,488 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707505664
2023-11-26 00:28:13,489 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707090392.615385
2023-11-26 00:28:13,489 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707051008.0
2023-11-26 00:28:13,490 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707051008.0
2023-11-26 00:28:13,490 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707051008.0
2023-11-26 00:28:13,491 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 120841.75589940784
2023-11-26 00:28:13,491 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 11.733818769454956, 'train.runtime': 1.5441875457763672, 'evaluate.runtime': 9.5367431640625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03710222244262695, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 81.9, 'mean.cpu_utilization': 8.146153846153847, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 21.787315130408246, 'min.cpu_memory_rss': 1147596800, 'max.cpu_memory_rss': 1147801600, 'mean.cpu_memory_rss': 1147627677.5384614, '25th_prcntl.cpu_memory_rss': 1147596800.0, '50th_prcntl.cpu_memory_rss': 1147596800.0, '75th_prcntl.cpu_memory_rss': 1147596800.0, 'std.cpu_memory_rss': 72432.06615922727, 'min.cpu_memory_vsz': 13707051008, 'max.cpu_memory_vsz': 13707505664, 'mean.cpu_memory_vsz': 13707090392.615385, '25th_prcntl.cpu_memory_vsz': 13707051008.0, '50th_prcntl.cpu_memory_vsz': 13707051008.0, '75th_prcntl.cpu_memory_vsz': 13707051008.0, 'std.cpu_memory_vsz': 120841.75589940784, 'save_metrics.runtime': 0.009064674377441406}
2023-11-26 00:28:13,491 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:13,491 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.010724067687988281
2023-11-26 00:28:13,492 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.010724067687988281
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:13,492 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958493.4925432, tag: fetch
2023-11-26 00:28:13,492 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:28:13,493 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:13,493 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:13,493 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:13,494 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:13,494 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:13,494 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:13,494 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:13,494 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:13,494 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:13,494 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:13,494 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:13,494 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:13,495 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:26,983 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:26,983 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:26,983 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:26,984 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,656 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,658 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,658 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,659 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,659 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,659 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:29:11,659 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,659 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:29:11,660 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,661 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,661 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:11,667 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,669 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,669 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,669 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,669 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,669 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:29:11,669 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,670 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:29:11,670 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,671 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:11,671 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,671 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,672 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,672 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,672 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,672 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:11,672 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:29:11,672 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:11,672 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:29:11,672 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:11,672 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:11,672 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:11,674 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:11,674 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:11,683 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 16
2023-11-26 00:29:11,684 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:11,684 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 58.191673278808594
2023-11-26 00:29:11,684 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 58.191673278808594
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:11,800 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 3.574946
2023-11-26 00:29:12,623 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.255251
==== completed _train_epoch train()
2023-11-26 00:29:13,278 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5940160751342773
2023-11-26 00:29:13,279 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5940160751342773
2023-11-26 00:29:13,279 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.4781951904296875e-05
2023-11-26 00:29:13,280 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.4781951904296875e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:13,280 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958553.2802045, tag: upload
2023-11-26 00:29:13,280 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:29:13,281 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:13,281 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:13,282 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:13,282 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:13,282 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:13,282 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:13,283 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:13,283 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:13,283 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:13,283 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:13,283 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:13,283 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:13,283 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:13,300 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:13,300 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:13,301 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:13,301 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:13,307 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:13,308 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,309 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:13,309 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,310 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,312 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:13,313 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,313 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,313 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:13,313 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,313 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,313 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,313 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:13,314 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:13,315 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:13,315 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,316 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:13,316 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,316 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,317 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:13,317 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,317 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,317 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:13,317 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,317 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,317 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,317 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:13,317 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:13,318 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:13,318 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,318 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:13,318 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,318 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,320 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:13,320 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,320 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,320 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:13,320 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,320 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:13,320 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:13,320 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:13,321 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:13,321 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04145216941833496
2023-11-26 00:29:13,321 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04145216941833496
2023-11-26 00:29:13,322 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:13,322 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 92.8
2023-11-26 00:29:13,322 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 2.878333333333333
2023-11-26 00:29:13,323 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:13,324 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:13,325 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:13,325 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 13.437486020664563
2023-11-26 00:29:13,325 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1147785216
2023-11-26 00:29:13,325 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1147981824
2023-11-26 00:29:13,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1147791769.6
2023-11-26 00:29:13,326 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1147785216.0
2023-11-26 00:29:13,327 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1147785216.0
2023-11-26 00:29:13,327 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1147785216.0
2023-11-26 00:29:13,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 35292.216080036684
2023-11-26 00:29:13,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707051008
2023-11-26 00:29:13,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707669504
2023-11-26 00:29:13,328 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707071624.533333
2023-11-26 00:29:13,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707051008.0
2023-11-26 00:29:13,329 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707051008.0
2023-11-26 00:29:13,330 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707051008.0
2023-11-26 00:29:13,330 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 111023.42975178207
2023-11-26 00:29:13,330 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 58.191673278808594, 'train.runtime': 1.5940160751342773, 'evaluate.runtime': 1.4781951904296875e-05, 'send.bytes': 2154215, 'upload.runtime': 0.04145216941833496, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 92.8, 'mean.cpu_utilization': 2.878333333333333, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 13.437486020664563, 'min.cpu_memory_rss': 1147785216, 'max.cpu_memory_rss': 1147981824, 'mean.cpu_memory_rss': 1147791769.6, '25th_prcntl.cpu_memory_rss': 1147785216.0, '50th_prcntl.cpu_memory_rss': 1147785216.0, '75th_prcntl.cpu_memory_rss': 1147785216.0, 'std.cpu_memory_rss': 35292.216080036684, 'min.cpu_memory_vsz': 13707051008, 'max.cpu_memory_vsz': 13707669504, 'mean.cpu_memory_vsz': 13707071624.533333, '25th_prcntl.cpu_memory_vsz': 13707051008.0, '50th_prcntl.cpu_memory_vsz': 13707051008.0, '75th_prcntl.cpu_memory_vsz': 13707051008.0, 'std.cpu_memory_vsz': 111023.42975178207, 'save_metrics.runtime': 0.010724067687988281}
2023-11-26 00:29:13,331 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:13,331 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009149789810180664
2023-11-26 00:29:13,331 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009149789810180664
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:13,331 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958553.3315008, tag: fetch
2023-11-26 00:29:13,331 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:29:13,332 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:13,332 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:13,332 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:13,332 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:13,333 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:13,333 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:13,333 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:13,333 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:13,333 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:13,333 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:13,333 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:13,333 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:13,333 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:27,066 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:27,067 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:27,067 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:27,067 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:11,066 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:11,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:11,070 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:11,070 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:11,070 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:11,070 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:30:11,070 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:11,070 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:30:11,071 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:11,072 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:11,072 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:11,073 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:11,075 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:11,075 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:11,076 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:11,076 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:11,076 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:11,076 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:30:11,076 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:11,076 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:30:11,076 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:30:11,077 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:30:11,078 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:11,078 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:11,079 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:11,079 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:11,081 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:11,081 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:11,105 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 25
2023-11-26 00:30:11,106 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:11,106 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 57.774723052978516
2023-11-26 00:30:11,106 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 57.774723052978516
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:11,200 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 3.420539
2023-11-26 00:30:12,041 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.587508
==== completed _train_epoch train()
2023-11-26 00:30:12,790 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.6834845542907715
2023-11-26 00:30:12,790 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.6834845542907715
2023-11-26 00:30:12,791 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.430511474609375e-05
2023-11-26 00:30:12,791 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.430511474609375e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:12,791 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958612.791492, tag: upload
2023-11-26 00:30:12,791 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:30:12,792 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:12,793 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:12,793 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:12,794 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:12,794 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:12,794 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:12,794 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:12,794 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:12,794 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:12,794 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:12,795 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:12,795 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:12,795 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:12,811 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:12,811 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:12,812 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:12,812 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:12,818 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:12,818 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,820 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:12,820 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,821 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,822 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:12,822 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,823 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,823 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:12,823 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,823 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,823 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,824 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:12,824 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:12,826 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:12,826 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,827 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:12,827 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,827 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,827 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:12,828 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,828 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,828 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:12,828 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,828 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,828 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,828 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:12,828 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:12,829 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:12,829 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,829 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:12,829 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,830 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,830 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:12,830 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,830 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,830 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:12,830 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,830 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:12,830 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:12,830 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:12,830 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:12,831 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.039766788482666016
2023-11-26 00:30:12,831 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.039766788482666016
2023-11-26 00:30:12,832 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:12,832 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 86.8
2023-11-26 00:30:12,832 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 2.0983050847457627
2023-11-26 00:30:12,833 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:12,834 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:12,834 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:12,835 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 11.519673540651857
2023-11-26 00:30:12,835 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1147977728
2023-11-26 00:30:12,836 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150197760
2023-11-26 00:30:12,836 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1148052775.0508475
2023-11-26 00:30:12,837 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1147977728.0
2023-11-26 00:30:12,837 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1147977728.0
2023-11-26 00:30:12,838 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1147977728.0
2023-11-26 00:30:12,838 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 400643.21419917356
2023-11-26 00:30:12,839 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707214848
2023-11-26 00:30:12,839 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707669504
2023-11-26 00:30:12,839 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707223525.966103
2023-11-26 00:30:12,839 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707214848.0
2023-11-26 00:30:12,840 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707214848.0
2023-11-26 00:30:12,840 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707214848.0
2023-11-26 00:30:12,841 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 59025.604043303254
2023-11-26 00:30:12,841 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 57.774723052978516, 'train.runtime': 1.6834845542907715, 'evaluate.runtime': 1.430511474609375e-05, 'send.bytes': 2154215, 'upload.runtime': 0.039766788482666016, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 86.8, 'mean.cpu_utilization': 2.0983050847457627, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 11.519673540651857, 'min.cpu_memory_rss': 1147977728, 'max.cpu_memory_rss': 1150197760, 'mean.cpu_memory_rss': 1148052775.0508475, '25th_prcntl.cpu_memory_rss': 1147977728.0, '50th_prcntl.cpu_memory_rss': 1147977728.0, '75th_prcntl.cpu_memory_rss': 1147977728.0, 'std.cpu_memory_rss': 400643.21419917356, 'min.cpu_memory_vsz': 13707214848, 'max.cpu_memory_vsz': 13707669504, 'mean.cpu_memory_vsz': 13707223525.966103, '25th_prcntl.cpu_memory_vsz': 13707214848.0, '50th_prcntl.cpu_memory_vsz': 13707214848.0, '75th_prcntl.cpu_memory_vsz': 13707214848.0, 'std.cpu_memory_vsz': 59025.604043303254, 'save_metrics.runtime': 0.009149789810180664}
2023-11-26 00:30:12,841 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:12,841 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.010050058364868164
2023-11-26 00:30:12,841 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.010050058364868164
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:12,842 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958612.842311, tag: fetch
2023-11-26 00:30:12,842 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:30:12,842 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:12,843 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:12,843 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:12,843 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:12,843 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:12,843 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:12,843 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:12,843 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:12,843 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:12,843 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:12,843 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:12,844 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:12,844 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:27,151 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,151 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:27,151 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,152 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,554 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,558 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,558 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,558 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,559 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,559 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:30:51,559 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,559 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:30:51,560 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,561 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:51,562 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,585 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,587 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,588 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,588 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,588 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,588 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:30:51,588 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,588 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:30:51,589 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,589 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,589 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:51,593 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,593 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,593 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,593 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,593 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:51,593 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:30:51,593 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:51,593 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:30:51,593 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:51,594 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:51,594 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:51,595 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:51,595 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:51,604 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 31
2023-11-26 00:30:51,604 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:51,604 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 38.76240420341492
2023-11-26 00:30:51,604 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 38.76240420341492
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:51,692 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 3.684989
2023-11-26 00:30:52,584 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.375769
==== completed _train_epoch train()
2023-11-26 00:30:53,315 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.7108049392700195
2023-11-26 00:30:53,316 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.7108049392700195
2023-11-26 00:30:53,316 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.4543533325195312e-05
2023-11-26 00:30:53,317 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.4543533325195312e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:53,317 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958653.31724, tag: upload
2023-11-26 00:30:53,317 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:30:53,318 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:53,318 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:53,319 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:53,319 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:53,320 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:53,320 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:53,320 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:53,320 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,320 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:53,320 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:53,320 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:53,320 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,321 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:53,339 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:53,339 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:53,339 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:53,341 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:53,345 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,346 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,347 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,348 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,348 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,350 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,351 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,351 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,351 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,351 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,351 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,351 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,351 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:53,352 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:53,354 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,354 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,356 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,356 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,356 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,356 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,356 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,356 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,357 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,357 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,357 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,357 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,357 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:53,357 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:53,357 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,357 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,358 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,358 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,358 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,360 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:53,360 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,360 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,360 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:53,360 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,360 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:53,360 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:53,360 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:53,360 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:53,361 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04381847381591797
2023-11-26 00:30:53,361 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04381847381591797
2023-11-26 00:30:53,361 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:53,361 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 92.8
2023-11-26 00:30:53,362 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.892682926829268
2023-11-26 00:30:53,363 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:53,363 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:53,364 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:53,364 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.769518848831467
2023-11-26 00:30:53,364 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150181376
2023-11-26 00:30:53,365 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150410752
2023-11-26 00:30:53,365 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150192465.1707318
2023-11-26 00:30:53,365 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150181376.0
2023-11-26 00:30:53,366 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150181376.0
2023-11-26 00:30:53,366 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150181376.0
2023-11-26 00:30:53,367 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 48970.54111173093
2023-11-26 00:30:53,367 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707214848
2023-11-26 00:30:53,367 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708201984
2023-11-26 00:30:53,367 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707253310.439024
2023-11-26 00:30:53,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707214848.0
2023-11-26 00:30:53,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707214848.0
2023-11-26 00:30:53,368 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707214848.0
2023-11-26 00:30:53,369 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 175421.173015542
2023-11-26 00:30:53,369 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 38.76240420341492, 'train.runtime': 1.7108049392700195, 'evaluate.runtime': 1.4543533325195312e-05, 'send.bytes': 2154215, 'upload.runtime': 0.04381847381591797, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 92.8, 'mean.cpu_utilization': 4.892682926829268, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 17.769518848831467, 'min.cpu_memory_rss': 1150181376, 'max.cpu_memory_rss': 1150410752, 'mean.cpu_memory_rss': 1150192465.1707318, '25th_prcntl.cpu_memory_rss': 1150181376.0, '50th_prcntl.cpu_memory_rss': 1150181376.0, '75th_prcntl.cpu_memory_rss': 1150181376.0, 'std.cpu_memory_rss': 48970.54111173093, 'min.cpu_memory_vsz': 13707214848, 'max.cpu_memory_vsz': 13708201984, 'mean.cpu_memory_vsz': 13707253310.439024, '25th_prcntl.cpu_memory_vsz': 13707214848.0, '50th_prcntl.cpu_memory_vsz': 13707214848.0, '75th_prcntl.cpu_memory_vsz': 13707214848.0, 'std.cpu_memory_vsz': 175421.173015542, 'save_metrics.runtime': 0.010050058364868164}
2023-11-26 00:30:53,369 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:53,369 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008512735366821289
2023-11-26 00:30:53,370 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008512735366821289
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:53,370 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958653.3703437, tag: fetch
2023-11-26 00:30:53,370 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:30:53,370 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:53,371 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:53,371 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:53,371 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:53,371 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:53,371 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:53,371 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:53,371 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,371 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:53,371 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:53,371 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:53,371 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:53,372 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:23,361 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,365 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,366 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,366 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,368 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,371 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,371 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,372 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:31:23,372 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,372 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,373 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:31:23,374 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,376 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:23,377 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,377 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,378 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:31:23,378 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,378 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,378 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:31:23,380 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:23,381 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:23,381 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:31:23,382 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:23,383 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:31:23,383 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:23,383 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:23,383 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:23,386 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:23,386 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:23,401 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 36
2023-11-26 00:31:23,402 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:23,402 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 30.03201937675476
2023-11-26 00:31:23,402 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 30.03201937675476
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:23,512 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 3.290406
2023-11-26 00:31:24,361 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.226371
==== completed _train_epoch train()
2023-11-26 00:31:25,064 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.661916732788086
2023-11-26 00:31:25,064 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.661916732788086
2023-11-26 00:31:25,064 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 6.198883056640625e-06
2023-11-26 00:31:25,064 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 6.198883056640625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:25,065 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958685.0650344, tag: upload
2023-11-26 00:31:25,065 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:31:25,065 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:25,066 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:25,066 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:25,066 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:25,066 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:25,067 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:25,067 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:25,067 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,067 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:25,067 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:25,067 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:25,067 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,067 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:25,083 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:25,084 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:25,084 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:25,085 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:25,088 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,089 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,090 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,090 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,091 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,094 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,094 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,094 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,094 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,094 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,094 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,096 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,096 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:25,096 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:25,098 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,098 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,099 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,099 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,100 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,100 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,100 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,100 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,100 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,100 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,100 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,100 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,100 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:25,101 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:25,101 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,101 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,101 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,101 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,101 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,103 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:25,103 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,103 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,103 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:25,104 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,104 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:25,104 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:25,104 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:25,104 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:25,104 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03985953330993652
2023-11-26 00:31:25,105 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03985953330993652
2023-11-26 00:31:25,105 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:25,105 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 66.9
2023-11-26 00:31:25,106 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 2.641935483870968
2023-11-26 00:31:25,107 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:25,107 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:25,108 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:25,108 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 11.922106714501709
2023-11-26 00:31:25,108 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151213568
2023-11-26 00:31:25,108 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151234048
2023-11-26 00:31:25,109 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151214228.6451614
2023-11-26 00:31:25,109 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151213568.0
2023-11-26 00:31:25,109 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151213568.0
2023-11-26 00:31:25,110 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151213568.0
2023-11-26 00:31:25,110 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3618.5025734534847
2023-11-26 00:31:25,110 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707350016
2023-11-26 00:31:25,111 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707804672
2023-11-26 00:31:25,111 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707364682.32258
2023-11-26 00:31:25,111 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:31:25,112 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:31:25,112 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:31:25,112 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 80330.75713066736
2023-11-26 00:31:25,113 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 30.03201937675476, 'train.runtime': 1.661916732788086, 'evaluate.runtime': 6.198883056640625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03985953330993652, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 66.9, 'mean.cpu_utilization': 2.641935483870968, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 11.922106714501709, 'min.cpu_memory_rss': 1151213568, 'max.cpu_memory_rss': 1151234048, 'mean.cpu_memory_rss': 1151214228.6451614, '25th_prcntl.cpu_memory_rss': 1151213568.0, '50th_prcntl.cpu_memory_rss': 1151213568.0, '75th_prcntl.cpu_memory_rss': 1151213568.0, 'std.cpu_memory_rss': 3618.5025734534847, 'min.cpu_memory_vsz': 13707350016, 'max.cpu_memory_vsz': 13707804672, 'mean.cpu_memory_vsz': 13707364682.32258, '25th_prcntl.cpu_memory_vsz': 13707350016.0, '50th_prcntl.cpu_memory_vsz': 13707350016.0, '75th_prcntl.cpu_memory_vsz': 13707350016.0, 'std.cpu_memory_vsz': 80330.75713066736, 'save_metrics.runtime': 0.008512735366821289}
2023-11-26 00:31:25,113 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:25,113 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.00820159912109375
2023-11-26 00:31:25,113 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.00820159912109375
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:25,113 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958685.1138844, tag: fetch
2023-11-26 00:31:25,114 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:31:25,114 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:25,114 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:25,114 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:25,115 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:25,115 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:25,115 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:25,115 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:25,115 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,115 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:25,115 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:25,115 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:25,115 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:25,116 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:27,231 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:27,232 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:27,232 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:27,232 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:43,467 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:43,471 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:43,471 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:43,471 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:43,471 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:43,472 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:31:43,472 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:43,472 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:31:43,473 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:43,474 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:43,476 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:43,477 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:43,480 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:43,480 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:43,480 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:43,480 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:43,480 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:31:43,480 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:43,481 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:31:43,482 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:43,483 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:43,484 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:43,485 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:43,485 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:43,486 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:43,486 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:43,486 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:43,487 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:31:43,487 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:43,487 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:31:43,487 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:43,488 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:43,489 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:43,490 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:43,490 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:43,496 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 39
2023-11-26 00:31:43,496 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:43,496 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.38251543045044
2023-11-26 00:31:43,496 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.38251543045044
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:43,578 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 1.800027
2023-11-26 00:31:44,417 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.305676
==== completed _train_epoch train()
2023-11-26 00:31:45,067 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.570476770401001
2023-11-26 00:31:45,067 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.570476770401001
2023-11-26 00:31:45,067 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.430511474609375e-05
2023-11-26 00:31:45,068 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.430511474609375e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:45,068 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958705.068261, tag: upload
2023-11-26 00:31:45,068 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:31:45,069 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:45,069 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:45,070 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:45,070 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:45,071 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:45,071 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:45,071 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:45,071 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:45,073 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:45,073 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:45,073 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:45,073 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:45,073 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:45,092 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154213
2023-11-26 00:31:45,093 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154213
2023-11-26 00:31:45,093 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154213
2023-11-26 00:31:45,094 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:45,098 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:45,099 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,100 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:45,101 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,101 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,104 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:45,104 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,105 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,105 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:45,105 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,105 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,105 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,105 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:45,106 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:45,107 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:45,107 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,109 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:45,109 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,109 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,110 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:45,110 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,110 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,110 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:45,110 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,110 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,110 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,111 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:45,111 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57061
2023-11-26 00:31:45,111 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:45,111 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,112 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:45,112 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,112 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,113 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:45,113 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,113 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,114 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:45,114 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,114 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:45,114 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:45,114 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:45,114 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:45,115 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.047091007232666016
2023-11-26 00:31:45,115 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.047091007232666016
2023-11-26 00:31:45,116 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:45,116 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 71.9
2023-11-26 00:31:45,116 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 6.99
2023-11-26 00:31:45,117 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:45,117 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:45,118 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:31:45,118 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 20.502948568437663
2023-11-26 00:31:45,118 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151270912
2023-11-26 00:31:45,119 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151287296
2023-11-26 00:31:45,119 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151271731.2
2023-11-26 00:31:45,119 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151270912.0
2023-11-26 00:31:45,120 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151270912.0
2023-11-26 00:31:45,120 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151270912.0
2023-11-26 00:31:45,120 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3570.8100145485196
2023-11-26 00:31:45,121 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707350016
2023-11-26 00:31:45,121 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708197888
2023-11-26 00:31:45,121 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707392409.6
2023-11-26 00:31:45,121 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:31:45,122 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:31:45,122 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:31:45,123 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 184789.4182528859
2023-11-26 00:31:45,123 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 18.38251543045044, 'train.runtime': 1.570476770401001, 'evaluate.runtime': 1.430511474609375e-05, 'send.bytes': 2154213, 'upload.runtime': 0.047091007232666016, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 71.9, 'mean.cpu_utilization': 6.99, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 20.502948568437663, 'min.cpu_memory_rss': 1151270912, 'max.cpu_memory_rss': 1151287296, 'mean.cpu_memory_rss': 1151271731.2, '25th_prcntl.cpu_memory_rss': 1151270912.0, '50th_prcntl.cpu_memory_rss': 1151270912.0, '75th_prcntl.cpu_memory_rss': 1151270912.0, 'std.cpu_memory_rss': 3570.8100145485196, 'min.cpu_memory_vsz': 13707350016, 'max.cpu_memory_vsz': 13708197888, 'mean.cpu_memory_vsz': 13707392409.6, '25th_prcntl.cpu_memory_vsz': 13707350016.0, '50th_prcntl.cpu_memory_vsz': 13707350016.0, '75th_prcntl.cpu_memory_vsz': 13707350016.0, 'std.cpu_memory_vsz': 184789.4182528859, 'save_metrics.runtime': 0.00820159912109375}
2023-11-26 00:31:45,123 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:45,123 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008140325546264648
2023-11-26 00:31:45,123 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008140325546264648
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:45,124 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958705.124253, tag: fetch
2023-11-26 00:31:45,124 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:31:45,124 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:45,124 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:45,125 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:45,125 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:45,125 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:45,125 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:45,125 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:45,125 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:45,126 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:45,126 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:45,126 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:45,126 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:45,126 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:16,305 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:16,308 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:16,308 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:16,308 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:16,308 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:16,308 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:32:16,308 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:16,308 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:32:16,309 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:16,310 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:16,310 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:16,314 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:16,316 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:16,316 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:16,316 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:16,316 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:16,316 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:32:16,316 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:16,316 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:32:16,317 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:16,317 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:16,318 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:16,320 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:16,320 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:16,320 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:16,320 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:16,320 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:16,320 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:32:16,320 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:16,320 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:32:16,320 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:16,321 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:16,321 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:16,323 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:16,323 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:16,334 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 44
2023-11-26 00:32:16,334 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:16,334 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 31.210566520690918
2023-11-26 00:32:16,334 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 31.210566520690918
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:16,439 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 4.074334
2023-11-26 00:32:17,180 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.504610
==== completed _train_epoch train()
2023-11-26 00:32:17,804 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.4688785076141357
2023-11-26 00:32:17,804 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.4688785076141357
2023-11-26 00:32:17,805 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.3828277587890625e-05
2023-11-26 00:32:17,805 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.3828277587890625e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:17,805 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958737.8054597, tag: upload
2023-11-26 00:32:17,805 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:32:17,807 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:17,807 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:17,808 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:17,808 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:17,808 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:17,809 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:17,809 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:17,809 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:17,809 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:17,809 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:17,810 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:17,810 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:17,810 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:17,828 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:17,828 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:17,829 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:17,830 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:17,835 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:17,836 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,838 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:17,838 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,838 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,841 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:17,841 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,841 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,841 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:17,841 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,842 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,842 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,842 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:17,842 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:17,844 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:17,844 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,845 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:17,845 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,845 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,845 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:17,845 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,845 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,846 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:17,846 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,846 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,846 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,846 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:17,846 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:17,847 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:17,847 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,847 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:17,847 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,847 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,849 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:17,849 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,849 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,849 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:17,849 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,849 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:17,849 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:17,850 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:17,850 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:17,850 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04529762268066406
2023-11-26 00:32:17,850 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04529762268066406
2023-11-26 00:32:17,851 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:17,851 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 77.9
2023-11-26 00:32:17,852 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.872727272727273
2023-11-26 00:32:17,853 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:17,853 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:17,854 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:17,854 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 18.55237096221287
2023-11-26 00:32:17,854 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151328256
2023-11-26 00:32:17,854 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151344640
2023-11-26 00:32:17,855 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151328752.4848485
2023-11-26 00:32:17,855 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151328256.0
2023-11-26 00:32:17,856 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151328256.0
2023-11-26 00:32:17,856 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151328256.0
2023-11-26 00:32:17,856 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 2808.5424249600956
2023-11-26 00:32:17,857 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707350016
2023-11-26 00:32:17,857 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708201984
2023-11-26 00:32:17,857 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707375833.212122
2023-11-26 00:32:17,858 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:32:17,858 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:32:17,858 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:32:17,859 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 146044.20609792497
2023-11-26 00:32:17,859 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 31.210566520690918, 'train.runtime': 1.4688785076141357, 'evaluate.runtime': 1.3828277587890625e-05, 'send.bytes': 2154215, 'upload.runtime': 0.04529762268066406, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 77.9, 'mean.cpu_utilization': 4.872727272727273, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 18.55237096221287, 'min.cpu_memory_rss': 1151328256, 'max.cpu_memory_rss': 1151344640, 'mean.cpu_memory_rss': 1151328752.4848485, '25th_prcntl.cpu_memory_rss': 1151328256.0, '50th_prcntl.cpu_memory_rss': 1151328256.0, '75th_prcntl.cpu_memory_rss': 1151328256.0, 'std.cpu_memory_rss': 2808.5424249600956, 'min.cpu_memory_vsz': 13707350016, 'max.cpu_memory_vsz': 13708201984, 'mean.cpu_memory_vsz': 13707375833.212122, '25th_prcntl.cpu_memory_vsz': 13707350016.0, '50th_prcntl.cpu_memory_vsz': 13707350016.0, '75th_prcntl.cpu_memory_vsz': 13707350016.0, 'std.cpu_memory_vsz': 146044.20609792497, 'save_metrics.runtime': 0.008140325546264648}
2023-11-26 00:32:17,859 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:17,859 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.00883173942565918
2023-11-26 00:32:17,860 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.00883173942565918
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:17,860 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958737.860364, tag: fetch
2023-11-26 00:32:17,860 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:32:17,860 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:17,861 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:17,861 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:17,861 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:17,861 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:17,861 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:17,861 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:17,861 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:17,861 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:17,862 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:17,862 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:17,862 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:17,862 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:27,316 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:27,316 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:27,316 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:27,317 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,325 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,329 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,329 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,329 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,331 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,334 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,334 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,334 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,335 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,335 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:32:36,335 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,336 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048675
2023-11-26 00:32:36,337 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,339 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:36,339 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,340 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:36,340 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:32:36,340 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:36,340 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:32:36,341 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 1048677
2023-11-26 00:32:36,341 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372; len: 57155
2023-11-26 00:32:36,343 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:36,344 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:36,344 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:36,345 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:36,350 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:36,350 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:36,369 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 47
2023-11-26 00:32:36,369 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:36,369 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.50924324989319
2023-11-26 00:32:36,369 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.50924324989319
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:36,477 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/5929 (0%)]	loss: 2.134739
2023-11-26 00:32:37,274 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/5929 (54%)]	loss: 0.295714
==== completed _train_epoch train()
2023-11-26 00:32:37,892 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.5223712921142578
2023-11-26 00:32:37,892 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.5223712921142578
2023-11-26 00:32:37,893 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.5974044799804688e-05
2023-11-26 00:32:37,893 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.5974044799804688e-05
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:37,893 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958757.8938165, tag: upload
2023-11-26 00:32:37,894 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:32:37,895 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:37,895 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:37,895 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:37,896 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:37,896 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:37,896 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:37,897 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:37,897 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:37,897 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:37,897 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:37,897 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:37,897 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:37,898 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:37,915 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:37,916 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:37,916 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:37,916 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:37,919 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:37,920 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,921 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:37,921 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,921 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,924 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:37,924 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,924 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,924 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:37,924 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,924 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,925 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,925 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:37,925 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:37,926 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:37,926 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,927 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:37,927 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,927 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,928 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:37,928 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,928 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,928 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:37,928 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,929 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,929 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,929 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:37,929 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:37,929 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:37,929 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,929 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:37,929 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,929 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,931 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:37,931 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,931 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,932 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:37,932 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,932 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:37,932 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:37,932 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580372/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:37,932 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:37,932 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03911447525024414
2023-11-26 00:32:37,933 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03911447525024414
2023-11-26 00:32:37,933 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:37,933 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 70.9
2023-11-26 00:32:37,934 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.890000000000001
2023-11-26 00:32:37,935 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:37,936 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:37,937 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:32:37,937 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.349031673266378
2023-11-26 00:32:37,937 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151328256
2023-11-26 00:32:37,937 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151344640
2023-11-26 00:32:37,938 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151329075.2
2023-11-26 00:32:37,938 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151328256.0
2023-11-26 00:32:37,939 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151328256.0
2023-11-26 00:32:37,940 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151328256.0
2023-11-26 00:32:37,940 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3570.8100145485196
2023-11-26 00:32:37,940 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707350016
2023-11-26 00:32:37,941 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707804672
2023-11-26 00:32:37,941 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707372748.8
2023-11-26 00:32:37,942 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:32:37,942 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:32:37,943 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707350016.0
2023-11-26 00:32:37,943 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99089.97790372142
2023-11-26 00:32:37,944 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009158849716186523, 'load_data.runtime': 0.9422140121459961, 'init.runtime': 1.8828284740447998, 'recv.bytes': 2154204, 'fetch.runtime': 18.50924324989319, 'train.runtime': 1.5223712921142578, 'evaluate.runtime': 1.5974044799804688e-05, 'send.bytes': 2154215, 'upload.runtime': 0.03911447525024414, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 70.9, 'mean.cpu_utilization': 5.890000000000001, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 17.349031673266378, 'min.cpu_memory_rss': 1151328256, 'max.cpu_memory_rss': 1151344640, 'mean.cpu_memory_rss': 1151329075.2, '25th_prcntl.cpu_memory_rss': 1151328256.0, '50th_prcntl.cpu_memory_rss': 1151328256.0, '75th_prcntl.cpu_memory_rss': 1151328256.0, 'std.cpu_memory_rss': 3570.8100145485196, 'min.cpu_memory_vsz': 13707350016, 'max.cpu_memory_vsz': 13707804672, 'mean.cpu_memory_vsz': 13707372748.8, '25th_prcntl.cpu_memory_vsz': 13707350016.0, '50th_prcntl.cpu_memory_vsz': 13707350016.0, '75th_prcntl.cpu_memory_vsz': 13707350016.0, 'std.cpu_memory_vsz': 99089.97790372142, 'save_metrics.runtime': 0.00883173942565918}
2023-11-26 00:32:37,944 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:37,944 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.011345148086547852
2023-11-26 00:32:37,944 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.011345148086547852
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:37,945 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958757.9452398, tag: fetch
2023-11-26 00:32:37,945 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7efc176936d0>
2023-11-26 00:32:37,945 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:37,946 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:37,946 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:37,946 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:37,946 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:37,947 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:37,947 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:37,947 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:37,947 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:37,947 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:37,947 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580372, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580372': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:37,947 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:37,947 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:33:03,068 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,069 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,069 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,069 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,069 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,070 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,070 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,070 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 59
2023-11-26 00:33:03,070 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,071 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 59
2023-11-26 00:33:03,074 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 59
extracting weights from message
2023-11-26 00:33:03,077 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: True, round: 47
2023-11-26 00:33:03,078 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:33:03,078 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 25.133206605911255
2023-11-26 00:33:03,078 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 25.133206605911255
2023-11-26 00:33:03,078 | composer.py:145 | DEBUG | MainThread | run | end of run
2023-11-26 00:33:03,080 | channel_manager.py:187 | DEBUG | MainThread | cleanup | calling cleanup
2023-11-26 00:33:03,080 | channel_manager.py:189 | DEBUG | MainThread | cleanup | calling leave for channel param-channel
2023-11-26 00:33:03,080 | channel.py:414 | DEBUG | MainThread | leave | calling channel leave for param-channel
2023-11-26 00:33:03,081 | channel.py:420 | DEBUG | MainThread | leave |  channel leave done for param-channel
2023-11-26 00:33:03,082 | mqtt.py:552 | DEBUG | Thread-3 | misc_loop | misc_loop finished
2023-11-26 00:33:03,083 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-84
2023-11-26 00:33:03,083 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-2
2023-11-26 00:33:03,083 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-8
2023-11-26 00:33:03,083 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-7
2023-11-26 00:33:03,083 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-4
2023-11-26 00:33:03,084 | channel_manager.py:200 | DEBUG | Thread-3 | _inner | done with cleaning up asyncio tasks
