2023-11-26 00:27:23,269 | fedadagrad.py:27 | DEBUG | MainThread | FedAdaGrad | Initializing fedadagrad
2023-11-26 00:27:23,269 | fedadam.py:27 | DEBUG | MainThread | FedAdam | Initializing fedadam
2023-11-26 00:27:23,270 | fedyogi.py:27 | DEBUG | MainThread | FedYogi | Initializing fedyogi
2023-11-26 00:27:23,689 | metric_collector.py:52 | DEBUG | Thread-2 | gather_gpu_stats | could not start gpustat.nvml.pynvml; no GPU metrics will be collected
2023-11-26 00:27:26,415 | channel_manager.py:72 | INFO | MainThread | __new__ | creating a ChannelManager instance
2023-11-26 00:27:26,415 | selector_events.py:54 | DEBUG | MainThread | __init__ | Using selector: EpollSelector
2023-11-26 00:27:26,417 | mqtt.py:514 | DEBUG | Thread-3 | on_socket_open | Socket opened
2023-11-26 00:27:26,418 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,418 | mqtt.py:546 | DEBUG | Thread-3 | misc_loop | misc_loop started
2023-11-26 00:27:26,418 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,418 | channel_manager.py:146 | INFO | MainThread | join | no backend found for channel param-channel; use default
2023-11-26 00:27:26,419 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,419 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,419 | mqtt.py:294 | DEBUG | Thread-3 | on_connect | calling on_connect
2023-11-26 00:27:26,420 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,420 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,420 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,420 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,420 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/+
2023-11-26 00:27:26,421 | mqtt.py:531 | DEBUG | MainThread | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,421 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/+/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376
2023-11-26 00:27:26,421 | mqtt.py:349 | DEBUG | MainThread | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376
2023-11-26 00:27:26,421 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[internal_init.runtime] = 0.006299495697021484
2023-11-26 00:27:26,421 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,422 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of internal_init is 0.006299495697021484
2023-11-26 00:27:26,422 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,422 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,423 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,423 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,423 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580376, status: online
2023-11-26 00:27:26,463 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,464 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,464 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,464 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,465 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,507 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,508 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,508 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,509 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,509 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,509 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,509 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,510 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,510 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,510 | mqtt.py:234 | DEBUG | Thread-3 | _handle_notification | acknowledge notification
2023-11-26 00:27:26,510 | mqtt.py:349 | DEBUG | Thread-3 | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376
2023-11-26 00:27:26,511 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,511 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,511 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,512 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,512 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,512 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,512 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,512 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,513 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,513 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,513 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,556 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,622 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,623 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:26,623 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580374, status: online
2023-11-26 00:27:26,714 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,714 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,715 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:26,715 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:26,715 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,715 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:26,716 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:26,716 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:26,716 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
Files already downloaded and verified
2023-11-26 00:27:27,008 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,009 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:27,009 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580371, status: online
2023-11-26 00:27:27,106 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,107 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,107 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,108 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,108 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,108 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,109 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,109 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,109 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,110 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
indices:  tensor([37775, 29377, 15712,  ..., 11384, 43730,  2921])
2023-11-26 00:27:27,339 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[load_data.runtime] = 0.9175243377685547
2023-11-26 00:27:27,339 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of load_data is 0.9175243377685547
2023-11-26 00:27:29,204 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[init.runtime] = 1.8639791011810303
2023-11-26 00:27:29,205 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of init is 1.8639791011810303
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:29,205 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958449.205513, tag: fetch
2023-11-26 00:27:29,205 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:27:29,206 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:29,207 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:29,207 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:29,208 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:29,208 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:29,208 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:29,208 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:29,208 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': set()}
2023-11-26 00:27:29,209 | fedbuff.py:165 | DEBUG | Thread-3 | _handle_recv_state | let's select 1 ends
2023-11-26 00:27:29,210 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:29,211 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:29,211 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:29,211 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:30,587 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,596 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,597 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,605 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,605 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,605 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,606 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,606 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:27:30,606 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:27:30,609 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,612 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:30,612 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,613 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:30,613 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:27:30,613 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:30,613 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:27:30,613 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:27:30,614 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:27:30,616 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:30,617 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:30,617 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:30,618 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:30,622 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:30,623 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:30,656 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 1
2023-11-26 00:27:30,656 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:30,656 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 1.4508254528045654
2023-11-26 00:27:30,656 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 1.4508254528045654
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:31,200 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 2.345333
2023-11-26 00:27:32,054 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.649436
==== completed _train_epoch train()
2023-11-26 00:27:32,431 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.7754020690917969
2023-11-26 00:27:32,432 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.7754020690917969
2023-11-26 00:27:32,432 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:27:32,432 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:32,433 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958452.4330993, tag: upload
2023-11-26 00:27:32,433 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:27:32,434 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:32,434 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:32,435 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:32,435 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:32,435 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:32,436 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:32,436 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:32,436 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,436 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:32,436 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:32,436 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:32,436 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,436 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:32,454 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:32,454 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:32,455 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:32,455 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:32,461 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,462 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,464 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,464 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,464 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,468 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,468 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,468 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,468 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,468 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,468 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,468 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,469 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:32,469 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:32,470 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,470 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,471 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,471 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,471 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,472 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,472 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,472 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,472 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,472 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,472 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,472 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,472 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:32,472 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:32,473 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,473 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,473 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,473 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,473 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,475 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:32,475 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,475 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,475 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:32,475 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,475 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:32,476 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:32,476 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:32,476 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:32,476 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.043654441833496094
2023-11-26 00:27:32,476 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.043654441833496094
2023-11-26 00:27:32,477 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:32,478 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 378.0
2023-11-26 00:27:32,478 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 100.87999999999998
2023-11-26 00:27:32,481 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 44.15
2023-11-26 00:27:32,482 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 65.35
2023-11-26 00:27:32,482 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 101.175
2023-11-26 00:27:32,483 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 108.15700439638664
2023-11-26 00:27:32,483 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 68325376
2023-11-26 00:27:32,484 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1137807360
2023-11-26 00:27:32,484 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 706698854.4
2023-11-26 00:27:32,485 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 478712832.0
2023-11-26 00:27:32,486 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 803162112.0
2023-11-26 00:27:32,486 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 977989632.0
2023-11-26 00:27:32,487 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 365603533.7805209
2023-11-26 00:27:32,487 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 1881817088
2023-11-26 00:27:32,487 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13703172096
2023-11-26 00:27:32,487 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 9144836915.2
2023-11-26 00:27:32,488 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 6964280320.0
2023-11-26 00:27:32,489 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 9834708992.0
2023-11-26 00:27:32,489 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 12240859136.0
2023-11-26 00:27:32,490 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 4014653801.5030127
2023-11-26 00:27:32,490 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 1.4508254528045654, 'train.runtime': 1.7754020690917969, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.043654441833496094, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 378.0, 'mean.cpu_utilization': 100.87999999999998, '25th_prcntl.cpu_utilization': 44.15, '50th_prcntl.cpu_utilization': 65.35, '75th_prcntl.cpu_utilization': 101.175, 'std.cpu_utilization': 108.15700439638664, 'min.cpu_memory_rss': 68325376, 'max.cpu_memory_rss': 1137807360, 'mean.cpu_memory_rss': 706698854.4, '25th_prcntl.cpu_memory_rss': 478712832.0, '50th_prcntl.cpu_memory_rss': 803162112.0, '75th_prcntl.cpu_memory_rss': 977989632.0, 'std.cpu_memory_rss': 365603533.7805209, 'min.cpu_memory_vsz': 1881817088, 'max.cpu_memory_vsz': 13703172096, 'mean.cpu_memory_vsz': 9144836915.2, '25th_prcntl.cpu_memory_vsz': 6964280320.0, '50th_prcntl.cpu_memory_vsz': 9834708992.0, '75th_prcntl.cpu_memory_vsz': 12240859136.0, 'std.cpu_memory_vsz': 4014653801.5030127}
2023-11-26 00:27:32,491 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:32,491 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.014146804809570312
2023-11-26 00:27:32,491 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.014146804809570312
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:32,491 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958452.4916382, tag: fetch
2023-11-26 00:27:32,491 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:27:32,492 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:32,492 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:32,492 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:32,493 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:32,493 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:32,493 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:32,493 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:32,493 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,493 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:32,494 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:32,494 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:32,494 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:32,494 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:52,295 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:52,298 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:52,299 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:52,299 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:52,299 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:52,299 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:27:52,300 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:52,300 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:27:52,301 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:52,303 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:52,303 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:52,305 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:52,310 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:52,311 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:52,312 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:52,312 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:52,312 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:52,313 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:27:52,313 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:52,313 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:27:52,313 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:27:52,314 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:27:52,317 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:52,317 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:52,318 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:52,319 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:52,323 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:52,324 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:52,338 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 4
2023-11-26 00:27:52,339 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:52,339 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 19.84752893447876
2023-11-26 00:27:52,339 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 19.84752893447876
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:52,437 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.769849
2023-11-26 00:27:53,241 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.570083
==== completed _train_epoch train()
2023-11-26 00:27:53,598 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2588300704956055
2023-11-26 00:27:53,598 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2588300704956055
2023-11-26 00:27:53,599 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 6.198883056640625e-06
2023-11-26 00:27:53,599 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 6.198883056640625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:53,600 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958473.600053, tag: upload
2023-11-26 00:27:53,600 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:27:53,602 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:53,602 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:53,602 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:53,603 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:53,603 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:53,603 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:53,603 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:53,603 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:53,603 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:53,604 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:53,604 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:53,604 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:53,604 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:53,620 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:53,620 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:53,621 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:53,621 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:53,626 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:53,626 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,628 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:53,628 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,628 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,630 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:53,630 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,630 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,631 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:53,631 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,631 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,631 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,631 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:53,632 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:53,633 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:53,633 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,634 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:53,634 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,635 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,635 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:53,635 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,635 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,635 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:53,635 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,635 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,635 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,635 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:53,636 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:53,636 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:53,636 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,636 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:53,637 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,637 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,637 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:53,637 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,637 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,637 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:53,637 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,637 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:53,637 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:53,637 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:53,638 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:53,638 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03851485252380371
2023-11-26 00:27:53,638 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03851485252380371
2023-11-26 00:27:53,639 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:53,639 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 78.8
2023-11-26 00:27:53,640 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.657142857142857
2023-11-26 00:27:53,641 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:53,642 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:53,643 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:53,643 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 16.881902720244014
2023-11-26 00:27:53,643 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1142751232
2023-11-26 00:27:53,643 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149579264
2023-11-26 00:27:53,644 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1143133915.4285715
2023-11-26 00:27:53,644 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1142751232.0
2023-11-26 00:27:53,645 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1142751232.0
2023-11-26 00:27:53,645 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1142751232.0
2023-11-26 00:27:53,645 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 1463958.7471233306
2023-11-26 00:27:53,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13704749056
2023-11-26 00:27:53,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707464704
2023-11-26 00:27:53,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13704878372.571428
2023-11-26 00:27:53,646 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13704749056.0
2023-11-26 00:27:53,647 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13704749056.0
2023-11-26 00:27:53,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13704749056.0
2023-11-26 00:27:53,648 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 578321.2886629857
2023-11-26 00:27:53,649 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 19.84752893447876, 'train.runtime': 1.2588300704956055, 'evaluate.runtime': 6.198883056640625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03851485252380371, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 78.8, 'mean.cpu_utilization': 4.657142857142857, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 16.881902720244014, 'min.cpu_memory_rss': 1142751232, 'max.cpu_memory_rss': 1149579264, 'mean.cpu_memory_rss': 1143133915.4285715, '25th_prcntl.cpu_memory_rss': 1142751232.0, '50th_prcntl.cpu_memory_rss': 1142751232.0, '75th_prcntl.cpu_memory_rss': 1142751232.0, 'std.cpu_memory_rss': 1463958.7471233306, 'min.cpu_memory_vsz': 13704749056, 'max.cpu_memory_vsz': 13707464704, 'mean.cpu_memory_vsz': 13704878372.571428, '25th_prcntl.cpu_memory_vsz': 13704749056.0, '50th_prcntl.cpu_memory_vsz': 13704749056.0, '75th_prcntl.cpu_memory_vsz': 13704749056.0, 'std.cpu_memory_vsz': 578321.2886629857, 'save_metrics.runtime': 0.014146804809570312}
2023-11-26 00:27:53,649 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:53,649 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.010688543319702148
2023-11-26 00:27:53,649 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.010688543319702148
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:53,650 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958473.650243, tag: fetch
2023-11-26 00:27:53,650 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:27:53,650 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:53,650 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:53,651 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:53,651 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:53,651 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:53,651 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:53,651 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:53,651 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:53,651 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:53,651 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:53,651 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:53,651 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:53,652 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:18,363 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,367 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,367 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,367 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,369 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,372 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,373 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,373 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:18,373 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,374 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,374 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:18,375 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,377 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:18,378 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,379 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,379 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:18,379 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,379 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,379 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:18,380 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,382 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:18,382 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:18,383 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,383 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:18,384 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,384 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:18,384 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,388 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:18,388 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:18,405 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 8
2023-11-26 00:28:18,406 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:18,406 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 24.756022691726685
2023-11-26 00:28:18,406 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 24.756022691726685
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:18,562 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 2.655002
2023-11-26 00:28:19,403 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.547311
==== completed _train_epoch train()
2023-11-26 00:28:19,743 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3373467922210693
2023-11-26 00:28:19,744 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3373467922210693
2023-11-26 00:28:19,744 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:28:19,744 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:19,745 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958499.745011, tag: upload
2023-11-26 00:28:19,745 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:19,746 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:19,746 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:19,747 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:19,747 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:19,748 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:19,748 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:19,748 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:19,748 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:19,748 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:19,749 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:19,749 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:19,749 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:19,749 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:19,769 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:19,769 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:19,770 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:19,771 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:19,774 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:19,775 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,777 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:19,777 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,777 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,779 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:19,779 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,779 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,779 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:19,780 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,780 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,780 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,780 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:19,781 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:19,782 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:19,782 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,783 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:19,783 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,783 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,783 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:19,783 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,783 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,784 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:19,784 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,784 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,784 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,784 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:19,784 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:19,784 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:19,784 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,784 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:19,784 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,784 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,785 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:19,785 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,785 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,785 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:19,785 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,785 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:19,785 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:19,785 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:19,786 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:19,786 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.041461944580078125
2023-11-26 00:28:19,786 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.041461944580078125
2023-11-26 00:28:19,787 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:19,787 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 76.8
2023-11-26 00:28:19,787 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.2192307692307685
2023-11-26 00:28:19,788 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:19,789 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:19,789 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:19,790 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 15.53482487907954
2023-11-26 00:28:19,790 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149571072
2023-11-26 00:28:19,790 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150140416
2023-11-26 00:28:19,790 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149592969.8461537
2023-11-26 00:28:19,791 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149571072.0
2023-11-26 00:28:19,791 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149571072.0
2023-11-26 00:28:19,792 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149571072.0
2023-11-26 00:28:19,792 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 109489.23076923077
2023-11-26 00:28:19,792 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707010048
2023-11-26 00:28:19,792 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707857920
2023-11-26 00:28:19,793 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707042658.461538
2023-11-26 00:28:19,793 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:19,794 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:19,794 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:19,794 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 163052.3076923077
2023-11-26 00:28:19,795 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 24.756022691726685, 'train.runtime': 1.3373467922210693, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.041461944580078125, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 76.8, 'mean.cpu_utilization': 4.2192307692307685, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 15.53482487907954, 'min.cpu_memory_rss': 1149571072, 'max.cpu_memory_rss': 1150140416, 'mean.cpu_memory_rss': 1149592969.8461537, '25th_prcntl.cpu_memory_rss': 1149571072.0, '50th_prcntl.cpu_memory_rss': 1149571072.0, '75th_prcntl.cpu_memory_rss': 1149571072.0, 'std.cpu_memory_rss': 109489.23076923077, 'min.cpu_memory_vsz': 13707010048, 'max.cpu_memory_vsz': 13707857920, 'mean.cpu_memory_vsz': 13707042658.461538, '25th_prcntl.cpu_memory_vsz': 13707010048.0, '50th_prcntl.cpu_memory_vsz': 13707010048.0, '75th_prcntl.cpu_memory_vsz': 13707010048.0, 'std.cpu_memory_vsz': 163052.3076923077, 'save_metrics.runtime': 0.010688543319702148}
2023-11-26 00:28:19,795 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:19,795 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008624553680419922
2023-11-26 00:28:19,795 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008624553680419922
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:19,795 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958499.7959228, tag: fetch
2023-11-26 00:28:19,796 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:19,796 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:19,796 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:19,796 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:19,797 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:19,797 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:19,797 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:19,797 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:19,797 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:19,797 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:19,797 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:19,797 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:19,797 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:19,797 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:27,170 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:27,171 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:27,171 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:27,171 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,801 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,803 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,804 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,804 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,804 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,804 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:31,804 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,804 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:31,805 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,806 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,806 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:31,812 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,814 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,814 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,815 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,815 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,815 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:31,815 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,816 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:31,817 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,818 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:31,818 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,818 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,819 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,819 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,819 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,819 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:31,819 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:31,819 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:31,819 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:31,819 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:31,819 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:31,820 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:31,821 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:31,821 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:31,827 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 10
2023-11-26 00:28:31,828 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:31,828 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 12.032230138778687
2023-11-26 00:28:31,828 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 12.032230138778687
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:31,950 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.030576
2023-11-26 00:28:32,760 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.619446
==== completed _train_epoch train()
2023-11-26 00:28:33,133 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.304985761642456
2023-11-26 00:28:33,133 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.304985761642456
2023-11-26 00:28:33,134 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:28:33,134 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:33,134 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958513.1345835, tag: upload
2023-11-26 00:28:33,134 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:33,136 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:33,136 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:33,136 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:33,137 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:33,137 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:33,137 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:33,137 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:33,138 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,138 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:33,138 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:33,138 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:33,138 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,138 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:33,154 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:33,154 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:33,154 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:33,155 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:33,160 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,160 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,162 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,162 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,162 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,165 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,165 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,165 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,165 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,165 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,165 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,165 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,166 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:33,166 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:33,167 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,167 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,169 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,169 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,169 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,169 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,169 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,169 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,169 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,170 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,170 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,170 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,170 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:33,170 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:33,170 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,170 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,170 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,171 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,171 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,172 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:33,173 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,173 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,173 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:33,173 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,173 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:33,173 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:33,173 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:33,173 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:33,174 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03972029685974121
2023-11-26 00:28:33,174 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03972029685974121
2023-11-26 00:28:33,175 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:33,175 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 39.9
2023-11-26 00:28:33,175 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 6.061538461538461
2023-11-26 00:28:33,176 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:33,176 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:33,177 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:28:33,177 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 13.806271621791112
2023-11-26 00:28:33,178 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149730816
2023-11-26 00:28:33,178 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149878272
2023-11-26 00:28:33,178 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149742158.7692308
2023-11-26 00:28:33,178 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149730816.0
2023-11-26 00:28:33,179 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149730816.0
2023-11-26 00:28:33,179 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149730816.0
2023-11-26 00:28:33,180 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 39292.50521244252
2023-11-26 00:28:33,180 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707010048
2023-11-26 00:28:33,180 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707464704
2023-11-26 00:28:33,180 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707045021.538462
2023-11-26 00:28:33,181 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:33,181 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:33,182 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:33,182 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 121151.89107169777
2023-11-26 00:28:33,182 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 12.032230138778687, 'train.runtime': 1.304985761642456, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03972029685974121, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 39.9, 'mean.cpu_utilization': 6.061538461538461, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 13.806271621791112, 'min.cpu_memory_rss': 1149730816, 'max.cpu_memory_rss': 1149878272, 'mean.cpu_memory_rss': 1149742158.7692308, '25th_prcntl.cpu_memory_rss': 1149730816.0, '50th_prcntl.cpu_memory_rss': 1149730816.0, '75th_prcntl.cpu_memory_rss': 1149730816.0, 'std.cpu_memory_rss': 39292.50521244252, 'min.cpu_memory_vsz': 13707010048, 'max.cpu_memory_vsz': 13707464704, 'mean.cpu_memory_vsz': 13707045021.538462, '25th_prcntl.cpu_memory_vsz': 13707010048.0, '50th_prcntl.cpu_memory_vsz': 13707010048.0, '75th_prcntl.cpu_memory_vsz': 13707010048.0, 'std.cpu_memory_vsz': 121151.89107169777, 'save_metrics.runtime': 0.008624553680419922}
2023-11-26 00:28:33,182 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:33,182 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008314371109008789
2023-11-26 00:28:33,183 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008314371109008789
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:33,183 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958513.1833653, tag: fetch
2023-11-26 00:28:33,183 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:33,183 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:33,184 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:33,184 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:33,184 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:33,184 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:33,184 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:33,185 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:33,185 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,185 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:33,185 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:33,185 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:33,185 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:33,185 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:44,994 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:44,998 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:44,998 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:44,998 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:44,999 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,002 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,002 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,002 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,002 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,002 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:45,002 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,003 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:45,003 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,005 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,005 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,005 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:45,005 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,005 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:45,006 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,006 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,005 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:45,008 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:45,016 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,017 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,017 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,017 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,017 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:45,017 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:45,017 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:45,017 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:45,017 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:45,017 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:45,018 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:45,019 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:45,019 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:45,025 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 12
2023-11-26 00:28:45,025 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:45,025 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.84233021736145
2023-11-26 00:28:45,025 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.84233021736145
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:45,150 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.925307
2023-11-26 00:28:46,014 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.595629
==== completed _train_epoch train()
2023-11-26 00:28:46,405 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3792154788970947
2023-11-26 00:28:46,406 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3792154788970947
2023-11-26 00:28:46,406 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.76837158203125e-06
2023-11-26 00:28:46,406 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.76837158203125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:46,407 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958526.4070854, tag: upload
2023-11-26 00:28:46,407 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:46,408 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:46,408 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:46,408 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:46,409 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:46,409 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:46,409 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:46,409 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:46,409 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,410 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:46,410 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:46,410 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:46,410 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,410 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:46,428 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:46,429 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:46,429 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:46,430 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:46,434 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,434 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,436 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,436 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,437 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,438 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,438 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,439 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,439 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,439 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,439 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,439 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,439 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:46,440 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:46,442 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,442 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,443 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,443 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,443 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,443 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,444 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,444 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,444 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,444 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,444 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,444 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,444 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:46,444 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:46,445 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,445 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,445 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,445 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,445 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,446 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:46,446 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,446 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,446 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:46,446 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,446 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:46,446 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:46,446 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:46,447 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:46,447 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.040456533432006836
2023-11-26 00:28:46,447 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.040456533432006836
2023-11-26 00:28:46,448 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:46,448 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 86.8
2023-11-26 00:28:46,449 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 12.542857142857143
2023-11-26 00:28:46,450 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:46,450 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:46,451 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.75
2023-11-26 00:28:46,451 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 26.594245196113768
2023-11-26 00:28:46,452 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149870080
2023-11-26 00:28:46,452 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150414848
2023-11-26 00:28:46,452 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149947611.4285715
2023-11-26 00:28:46,453 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149870080.0
2023-11-26 00:28:46,454 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149870080.0
2023-11-26 00:28:46,454 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149870080.0
2023-11-26 00:28:46,455 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 189914.01655550572
2023-11-26 00:28:46,455 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707010048
2023-11-26 00:28:46,455 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:28:46,455 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707157504.0
2023-11-26 00:28:46,456 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:46,456 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:46,457 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707010048.0
2023-11-26 00:28:46,457 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 361191.9595118363
2023-11-26 00:28:46,457 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 11.84233021736145, 'train.runtime': 1.3792154788970947, 'evaluate.runtime': 4.76837158203125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.040456533432006836, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 86.8, 'mean.cpu_utilization': 12.542857142857143, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.75, 'std.cpu_utilization': 26.594245196113768, 'min.cpu_memory_rss': 1149870080, 'max.cpu_memory_rss': 1150414848, 'mean.cpu_memory_rss': 1149947611.4285715, '25th_prcntl.cpu_memory_rss': 1149870080.0, '50th_prcntl.cpu_memory_rss': 1149870080.0, '75th_prcntl.cpu_memory_rss': 1149870080.0, 'std.cpu_memory_rss': 189914.01655550572, 'min.cpu_memory_vsz': 13707010048, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707157504.0, '25th_prcntl.cpu_memory_vsz': 13707010048.0, '50th_prcntl.cpu_memory_vsz': 13707010048.0, '75th_prcntl.cpu_memory_vsz': 13707010048.0, 'std.cpu_memory_vsz': 361191.9595118363, 'save_metrics.runtime': 0.008314371109008789}
2023-11-26 00:28:46,458 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:46,458 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.010364294052124023
2023-11-26 00:28:46,458 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.010364294052124023
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:46,458 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958526.4586575, tag: fetch
2023-11-26 00:28:46,458 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:46,459 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:46,459 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:46,459 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:46,459 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:46,459 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:46,459 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:46,459 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:46,459 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,459 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:46,460 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:46,460 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:46,460 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:46,460 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:58,174 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:58,177 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:58,177 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:58,177 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:58,177 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:58,177 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:58,177 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:58,177 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:28:58,178 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:58,178 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:58,179 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:58,185 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:58,187 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:58,187 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:58,187 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:58,187 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:58,187 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:58,187 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:58,188 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:58,188 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:58,188 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:28:58,188 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:28:58,189 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:58,189 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:58,190 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:58,190 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:58,191 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:58,191 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:58,202 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 14
2023-11-26 00:28:58,202 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:58,203 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.744356870651245
2023-11-26 00:28:58,203 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.744356870651245
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:58,376 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 2.084794
2023-11-26 00:28:59,182 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.506910
==== completed _train_epoch train()
2023-11-26 00:28:59,507 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3036885261535645
2023-11-26 00:28:59,507 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3036885261535645
2023-11-26 00:28:59,508 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:28:59,508 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:59,508 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958539.5088687, tag: upload
2023-11-26 00:28:59,509 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:59,510 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:59,510 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:59,510 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:59,511 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:59,511 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:59,511 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:59,512 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:59,512 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:59,512 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:59,512 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:59,512 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:59,512 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:59,512 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:59,532 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:59,533 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:59,533 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:59,534 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:59,538 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:59,539 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,540 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:59,541 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,541 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,543 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:59,544 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,544 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,544 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:59,544 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,544 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,544 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,544 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:59,545 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:59,546 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:59,546 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,547 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:59,547 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,548 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,548 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:59,548 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,548 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,548 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:59,548 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,548 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,548 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,548 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:59,548 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:59,549 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:59,549 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,549 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:59,549 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,549 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,551 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:59,551 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,551 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,551 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:59,551 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,551 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:59,551 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:59,552 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:59,552 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:59,552 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04381990432739258
2023-11-26 00:28:59,552 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04381990432739258
2023-11-26 00:28:59,553 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:59,553 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 84.8
2023-11-26 00:28:59,553 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.753846153846154
2023-11-26 00:28:59,555 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:59,555 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:59,556 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:28:59,556 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 22.421576674973505
2023-11-26 00:28:59,556 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150394368
2023-11-26 00:28:59,556 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150414848
2023-11-26 00:28:59,557 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150397518.7692308
2023-11-26 00:28:59,557 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150394368.0
2023-11-26 00:28:59,558 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150394368.0
2023-11-26 00:28:59,558 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150394368.0
2023-11-26 00:28:59,558 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 7389.208827783372
2023-11-26 00:28:59,559 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:28:59,559 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708439552
2023-11-26 00:28:59,559 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707688093.538462
2023-11-26 00:28:59,559 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:28:59,560 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:28:59,560 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:28:59,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 248260.62238908882
2023-11-26 00:28:59,561 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 11.744356870651245, 'train.runtime': 1.3036885261535645, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04381990432739258, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 84.8, 'mean.cpu_utilization': 7.753846153846154, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 22.421576674973505, 'min.cpu_memory_rss': 1150394368, 'max.cpu_memory_rss': 1150414848, 'mean.cpu_memory_rss': 1150397518.7692308, '25th_prcntl.cpu_memory_rss': 1150394368.0, '50th_prcntl.cpu_memory_rss': 1150394368.0, '75th_prcntl.cpu_memory_rss': 1150394368.0, 'std.cpu_memory_rss': 7389.208827783372, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708439552, 'mean.cpu_memory_vsz': 13707688093.538462, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 248260.62238908882, 'save_metrics.runtime': 0.010364294052124023}
2023-11-26 00:28:59,561 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:59,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008668899536132812
2023-11-26 00:28:59,561 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008668899536132812
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:59,562 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958539.562098, tag: fetch
2023-11-26 00:28:59,562 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:28:59,562 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:59,562 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:59,563 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:59,563 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:59,563 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:59,563 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:59,563 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:59,564 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:59,564 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:59,564 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:59,564 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:59,564 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:59,564 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:18,017 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:18,021 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:18,022 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:18,022 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:18,023 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:18,027 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:18,027 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:18,028 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:29:18,028 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:18,028 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:18,029 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:29:18,030 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:18,032 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:18,033 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:18,034 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:18,034 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:29:18,034 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:18,034 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:18,034 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:29:18,041 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:18,042 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:18,042 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:29:18,043 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:18,043 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:29:18,043 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:18,043 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:18,045 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:18,045 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:18,045 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:18,052 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 17
2023-11-26 00:29:18,052 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:18,052 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.490614414215088
2023-11-26 00:29:18,052 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.490614414215088
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:18,139 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.627571
2023-11-26 00:29:18,992 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.414177
==== completed _train_epoch train()
2023-11-26 00:29:19,344 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2917475700378418
2023-11-26 00:29:19,345 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2917475700378418
2023-11-26 00:29:19,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.0531158447265625e-06
2023-11-26 00:29:19,345 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.0531158447265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:19,345 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958559.3458567, tag: upload
2023-11-26 00:29:19,346 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:29:19,347 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:19,347 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:19,347 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:19,348 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:19,348 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:19,348 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:19,348 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:19,348 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,349 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:19,349 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:19,349 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:19,349 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,349 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:19,364 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:19,364 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:19,364 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:19,365 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:19,370 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,370 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,372 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,372 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,372 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,375 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,375 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,375 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,375 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,375 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,375 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,376 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,376 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:19,376 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:19,377 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,377 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,378 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,378 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,378 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,378 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,379 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,379 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,379 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,379 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,379 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,379 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,379 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:19,379 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:19,379 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,379 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,380 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,380 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,380 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,382 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:19,382 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,382 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,382 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:19,382 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,382 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:19,382 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:19,382 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:19,383 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:19,383 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03757452964782715
2023-11-26 00:29:19,383 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03757452964782715
2023-11-26 00:29:19,384 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:19,384 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 26.0
2023-11-26 00:29:19,384 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 2.1052631578947367
2023-11-26 00:29:19,385 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:19,386 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:19,387 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:19,387 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 6.231454479553544
2023-11-26 00:29:19,387 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150398464
2023-11-26 00:29:19,387 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1150414848
2023-11-26 00:29:19,388 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150399326.3157895
2023-11-26 00:29:19,388 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150398464.0
2023-11-26 00:29:19,389 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150398464.0
2023-11-26 00:29:19,389 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150398464.0
2023-11-26 00:29:19,389 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3658.4960535664404
2023-11-26 00:29:19,390 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:29:19,390 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708439552
2023-11-26 00:29:19,390 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707632424.421053
2023-11-26 00:29:19,390 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:19,391 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:19,391 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:19,392 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 190241.7947854549
2023-11-26 00:29:19,392 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 18.490614414215088, 'train.runtime': 1.2917475700378418, 'evaluate.runtime': 4.0531158447265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03757452964782715, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 26.0, 'mean.cpu_utilization': 2.1052631578947367, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 6.231454479553544, 'min.cpu_memory_rss': 1150398464, 'max.cpu_memory_rss': 1150414848, 'mean.cpu_memory_rss': 1150399326.3157895, '25th_prcntl.cpu_memory_rss': 1150398464.0, '50th_prcntl.cpu_memory_rss': 1150398464.0, '75th_prcntl.cpu_memory_rss': 1150398464.0, 'std.cpu_memory_rss': 3658.4960535664404, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708439552, 'mean.cpu_memory_vsz': 13707632424.421053, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 190241.7947854549, 'save_metrics.runtime': 0.008668899536132812}
2023-11-26 00:29:19,392 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:19,392 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008875846862792969
2023-11-26 00:29:19,392 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008875846862792969
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:19,393 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958559.3932552, tag: fetch
2023-11-26 00:29:19,393 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:29:19,393 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:19,394 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:19,394 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:19,394 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:19,394 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:19,394 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:19,394 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:19,394 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,394 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:19,395 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:19,395 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:19,395 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:19,395 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:27,269 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:27,269 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:27,270 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:27,270 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,320 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,323 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,324 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,324 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,324 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,324 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:29:31,325 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,325 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:29:31,326 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,327 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:31,327 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,328 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,331 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,331 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,331 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,331 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,331 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,331 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,332 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,332 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,332 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:29:31,332 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,332 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:29:31,333 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,334 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:31,334 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,334 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:31,335 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:29:31,335 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:31,335 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:29:31,335 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:31,335 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:31,337 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:31,337 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:31,337 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:31,344 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 19
2023-11-26 00:29:31,344 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:31,344 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.951342344284058
2023-11-26 00:29:31,344 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.951342344284058
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:31,431 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.542997
2023-11-26 00:29:32,245 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.514738
==== completed _train_epoch train()
2023-11-26 00:29:32,585 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2407078742980957
2023-11-26 00:29:32,585 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2407078742980957
2023-11-26 00:29:32,586 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 7.152557373046875e-06
2023-11-26 00:29:32,586 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 7.152557373046875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:32,587 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958572.5870366, tag: upload
2023-11-26 00:29:32,587 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:29:32,588 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:32,589 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:32,589 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:32,590 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:32,590 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:32,590 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:32,590 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,591 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,591 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:32,591 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,591 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:32,592 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,592 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:32,609 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:32,610 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:32,610 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:32,611 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:32,617 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,617 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,619 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,619 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,619 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,622 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,622 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,622 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,622 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,622 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,622 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,622 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,622 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,623 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:32,624 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,624 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,625 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,625 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,625 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,625 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,625 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,625 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,626 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,626 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,626 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,626 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,626 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,626 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:32,626 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,626 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,626 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,627 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,627 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,628 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:32,629 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,629 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,629 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:32,629 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,629 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:32,629 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:32,629 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:32,629 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:32,630 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.043196916580200195
2023-11-26 00:29:32,630 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.043196916580200195
2023-11-26 00:29:32,631 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:32,631 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 86.8
2023-11-26 00:29:32,631 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 12.685714285714285
2023-11-26 00:29:32,632 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:32,633 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:32,633 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.75
2023-11-26 00:29:32,634 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 29.322708341655545
2023-11-26 00:29:32,634 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1150398464
2023-11-26 00:29:32,634 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151320064
2023-11-26 00:29:32,634 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1150530121.142857
2023-11-26 00:29:32,635 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1150398464.0
2023-11-26 00:29:32,635 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1150398464.0
2023-11-26 00:29:32,635 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1150398464.0
2023-11-26 00:29:32,636 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 322492.820992711
2023-11-26 00:29:32,636 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:29:32,636 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708439552
2023-11-26 00:29:32,636 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707709001.142857
2023-11-26 00:29:32,637 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:32,637 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:32,638 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:32,638 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 297411.0533652654
2023-11-26 00:29:32,638 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 11.951342344284058, 'train.runtime': 1.2407078742980957, 'evaluate.runtime': 7.152557373046875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.043196916580200195, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 86.8, 'mean.cpu_utilization': 12.685714285714285, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.75, 'std.cpu_utilization': 29.322708341655545, 'min.cpu_memory_rss': 1150398464, 'max.cpu_memory_rss': 1151320064, 'mean.cpu_memory_rss': 1150530121.142857, '25th_prcntl.cpu_memory_rss': 1150398464.0, '50th_prcntl.cpu_memory_rss': 1150398464.0, '75th_prcntl.cpu_memory_rss': 1150398464.0, 'std.cpu_memory_rss': 322492.820992711, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708439552, 'mean.cpu_memory_vsz': 13707709001.142857, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 297411.0533652654, 'save_metrics.runtime': 0.008875846862792969}
2023-11-26 00:29:32,639 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:32,639 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008477449417114258
2023-11-26 00:29:32,639 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008477449417114258
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:32,639 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958572.6396034, tag: fetch
2023-11-26 00:29:32,639 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:29:32,640 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:32,640 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:32,640 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:32,641 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:32,641 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:32,641 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:32,641 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:32,641 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,641 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:32,642 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:32,642 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:32,642 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:32,642 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:44,366 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:44,370 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:44,370 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:44,370 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:44,372 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:44,375 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:44,376 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:44,376 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:29:44,377 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:44,377 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:44,377 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:29:44,379 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:44,380 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:44,382 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:44,382 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:44,382 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:29:44,383 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:44,383 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:44,383 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:29:44,384 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:44,386 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:44,387 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:29:44,388 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:44,388 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:29:44,388 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:44,388 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:44,389 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:44,392 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:44,393 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:44,404 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 21
2023-11-26 00:29:44,405 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:44,405 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.765599489212036
2023-11-26 00:29:44,405 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.765599489212036
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:44,532 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 0.992784
2023-11-26 00:29:45,367 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.524831
==== completed _train_epoch train()
2023-11-26 00:29:45,693 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2882163524627686
2023-11-26 00:29:45,694 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2882163524627686
2023-11-26 00:29:45,694 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 5.245208740234375e-06
2023-11-26 00:29:45,694 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 5.245208740234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:45,695 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958585.6950371, tag: upload
2023-11-26 00:29:45,695 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:29:45,696 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:45,696 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:45,697 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:45,698 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:45,698 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:45,698 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:45,699 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:45,699 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:45,699 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:45,699 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:45,700 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:45,700 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:45,700 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:45,720 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:45,721 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:45,721 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:45,722 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:45,726 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:45,726 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,728 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:45,728 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,728 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,730 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:45,730 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,731 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,731 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:45,731 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,731 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,731 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,731 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:45,731 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:45,733 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:45,733 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,734 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:45,734 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,734 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,734 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:45,734 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,735 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,735 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:45,735 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,735 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,735 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,735 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:45,735 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:45,736 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:45,736 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,736 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:45,736 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,736 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,737 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:45,737 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,737 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,737 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:45,737 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,738 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:45,738 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:45,738 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:45,738 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:45,738 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04387259483337402
2023-11-26 00:29:45,739 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04387259483337402
2023-11-26 00:29:45,739 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:45,739 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 78.8
2023-11-26 00:29:45,740 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.753846153846154
2023-11-26 00:29:45,741 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:45,741 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:45,742 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:29:45,742 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 20.869286058505114
2023-11-26 00:29:45,742 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151303680
2023-11-26 00:29:45,742 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151328256
2023-11-26 00:29:45,742 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151306830.7692308
2023-11-26 00:29:45,743 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151303680.0
2023-11-26 00:29:45,743 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151303680.0
2023-11-26 00:29:45,744 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151303680.0
2023-11-26 00:29:45,744 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 7561.846153846154
2023-11-26 00:29:45,744 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:29:45,745 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:29:45,745 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707626968.615385
2023-11-26 00:29:45,745 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:45,746 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:45,746 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:29:45,746 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 120841.75589940784
2023-11-26 00:29:45,747 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 11.765599489212036, 'train.runtime': 1.2882163524627686, 'evaluate.runtime': 5.245208740234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04387259483337402, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 78.8, 'mean.cpu_utilization': 7.753846153846154, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 20.869286058505114, 'min.cpu_memory_rss': 1151303680, 'max.cpu_memory_rss': 1151328256, 'mean.cpu_memory_rss': 1151306830.7692308, '25th_prcntl.cpu_memory_rss': 1151303680.0, '50th_prcntl.cpu_memory_rss': 1151303680.0, '75th_prcntl.cpu_memory_rss': 1151303680.0, 'std.cpu_memory_rss': 7561.846153846154, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707626968.615385, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 120841.75589940784, 'save_metrics.runtime': 0.008477449417114258}
2023-11-26 00:29:45,747 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:45,747 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008103609085083008
2023-11-26 00:29:45,747 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008103609085083008
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:45,747 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958585.747795, tag: fetch
2023-11-26 00:29:45,747 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:29:45,748 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:45,748 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:45,748 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:45,749 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:45,749 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:45,749 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:45,749 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:45,749 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:45,749 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:45,749 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:45,749 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:45,749 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:45,749 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:04,493 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,496 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,496 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,496 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,497 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,497 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:04,497 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,497 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:04,498 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,500 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:04,500 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,501 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,503 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,503 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,504 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,504 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,504 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:04,504 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:04,504 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:04,504 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:04,504 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:04,505 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:04,505 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:04,507 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:04,507 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:04,507 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:04,511 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:04,511 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:04,525 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 24
2023-11-26 00:30:04,525 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:04,525 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.777673721313477
2023-11-26 00:30:04,525 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.777673721313477
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:04,674 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.567124
2023-11-26 00:30:05,528 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.540270
==== completed _train_epoch train()
2023-11-26 00:30:05,893 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3675782680511475
2023-11-26 00:30:05,893 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3675782680511475
2023-11-26 00:30:05,894 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:30:05,894 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:05,894 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958605.8945405, tag: upload
2023-11-26 00:30:05,894 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:05,896 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:05,896 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:05,896 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:05,897 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:05,897 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:05,897 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:05,897 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:05,897 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,898 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:05,898 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:05,898 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:05,898 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,898 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:05,910 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:05,910 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:05,910 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:05,911 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:05,914 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,914 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,915 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,915 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,916 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,919 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,919 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,919 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,919 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,919 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,919 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,919 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,919 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:05,920 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:05,921 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,921 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,923 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,923 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,923 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,923 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,923 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,923 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,924 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,924 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,924 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,924 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,924 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:05,924 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:05,925 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,925 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,925 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,925 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,925 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,926 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:05,927 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,927 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,927 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:05,927 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,927 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:05,927 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:05,927 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:05,927 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:05,928 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03379344940185547
2023-11-26 00:30:05,928 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03379344940185547
2023-11-26 00:30:05,929 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:05,929 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 73.9
2023-11-26 00:30:05,929 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.99
2023-11-26 00:30:05,930 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:05,930 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:05,931 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:30:05,931 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 16.568974017723612
2023-11-26 00:30:05,931 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151307776
2023-11-26 00:30:05,932 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151442944
2023-11-26 00:30:05,932 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151320268.8
2023-11-26 00:30:05,932 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151307776.0
2023-11-26 00:30:05,933 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151307776.0
2023-11-26 00:30:05,933 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151307776.0
2023-11-26 00:30:05,934 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 37618.03060448539
2023-11-26 00:30:05,934 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:30:05,934 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:30:05,934 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707610316.8
2023-11-26 00:30:05,934 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:05,935 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:05,935 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:05,936 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99089.97790372142
2023-11-26 00:30:05,936 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 18.777673721313477, 'train.runtime': 1.3675782680511475, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03379344940185547, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 73.9, 'mean.cpu_utilization': 4.99, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 16.568974017723612, 'min.cpu_memory_rss': 1151307776, 'max.cpu_memory_rss': 1151442944, 'mean.cpu_memory_rss': 1151320268.8, '25th_prcntl.cpu_memory_rss': 1151307776.0, '50th_prcntl.cpu_memory_rss': 1151307776.0, '75th_prcntl.cpu_memory_rss': 1151307776.0, 'std.cpu_memory_rss': 37618.03060448539, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707610316.8, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 99089.97790372142, 'save_metrics.runtime': 0.008103609085083008}
2023-11-26 00:30:05,936 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:05,936 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008143186569213867
2023-11-26 00:30:05,936 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008143186569213867
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:05,937 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958605.9371972, tag: fetch
2023-11-26 00:30:05,937 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:05,937 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:05,937 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:05,937 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:05,938 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:05,938 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:05,938 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:05,938 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:05,938 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,938 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:05,938 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:05,938 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:05,939 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:05,939 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:17,558 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,561 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,562 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,562 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,563 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,566 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,566 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,566 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:17,567 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,567 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,568 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:17,569 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,570 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:17,572 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,572 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,573 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:17,573 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,573 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,574 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:17,574 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:17,576 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:17,576 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:17,577 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:17,577 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:17,578 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:17,578 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:17,578 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:17,581 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:17,582 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:17,592 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 26
2023-11-26 00:30:17,592 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:17,592 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.65558910369873
2023-11-26 00:30:17,592 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.65558910369873
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:17,683 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.845560
2023-11-26 00:30:18,538 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.461726
==== completed _train_epoch train()
2023-11-26 00:30:18,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2912228107452393
2023-11-26 00:30:18,884 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2912228107452393
2023-11-26 00:30:18,885 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:30:18,885 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:18,885 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958618.8854427, tag: upload
2023-11-26 00:30:18,885 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:18,886 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:18,886 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:18,887 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:18,887 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:18,887 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:18,888 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:18,888 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:18,888 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,888 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:18,888 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:18,888 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:18,888 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,888 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:18,900 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:18,900 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:18,900 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:18,900 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:18,903 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,904 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,905 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,905 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,905 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,908 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,908 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,908 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,908 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,909 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,909 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,909 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,909 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:18,909 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:18,910 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,910 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,912 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,912 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,912 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,912 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,912 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,912 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,912 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,912 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,912 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,912 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,912 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:18,913 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:18,913 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,913 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,913 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,913 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,913 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,915 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:18,915 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,915 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,915 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:18,915 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,915 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:18,916 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:18,916 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:18,916 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:18,916 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.031241655349731445
2023-11-26 00:30:18,916 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.031241655349731445
2023-11-26 00:30:18,917 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:18,917 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 75.9
2023-11-26 00:30:18,917 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.600000000000001
2023-11-26 00:30:18,918 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:18,919 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:18,920 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:18,920 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 21.516255035884633
2023-11-26 00:30:18,920 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151422464
2023-11-26 00:30:18,920 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151438848
2023-11-26 00:30:18,921 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151423724.3076923
2023-11-26 00:30:18,921 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:18,922 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:18,922 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:18,923 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4365.833912493613
2023-11-26 00:30:18,923 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:30:18,923 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708439552
2023-11-26 00:30:18,924 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707653120.0
2023-11-26 00:30:18,924 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:18,924 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:18,925 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:18,925 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 227023.36344966787
2023-11-26 00:30:18,925 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 11.65558910369873, 'train.runtime': 1.2912228107452393, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.031241655349731445, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 75.9, 'mean.cpu_utilization': 8.600000000000001, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 21.516255035884633, 'min.cpu_memory_rss': 1151422464, 'max.cpu_memory_rss': 1151438848, 'mean.cpu_memory_rss': 1151423724.3076923, '25th_prcntl.cpu_memory_rss': 1151422464.0, '50th_prcntl.cpu_memory_rss': 1151422464.0, '75th_prcntl.cpu_memory_rss': 1151422464.0, 'std.cpu_memory_rss': 4365.833912493613, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708439552, 'mean.cpu_memory_vsz': 13707653120.0, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 227023.36344966787, 'save_metrics.runtime': 0.008143186569213867}
2023-11-26 00:30:18,925 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:18,926 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.00906825065612793
2023-11-26 00:30:18,926 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.00906825065612793
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:18,926 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958618.926435, tag: fetch
2023-11-26 00:30:18,926 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:18,926 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:18,927 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:18,927 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:18,927 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:18,927 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:18,927 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:18,927 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:18,927 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,928 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:18,928 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:18,928 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:18,928 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:18,928 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:27,357 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,357 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:27,357 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,358 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:31,075 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:31,078 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:31,079 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:31,079 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:31,080 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:31,083 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:31,083 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:31,083 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:31,084 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:31,084 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:31,084 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:31,085 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:31,087 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:31,088 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:31,089 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:31,089 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:31,089 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:31,089 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:31,089 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:31,090 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:31,092 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:31,092 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:31,093 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:31,093 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:31,094 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:31,094 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:31,094 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:31,097 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:31,098 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:31,108 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 28
2023-11-26 00:30:31,108 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:31,108 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 12.182556390762329
2023-11-26 00:30:31,109 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 12.182556390762329
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:31,225 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.147024
2023-11-26 00:30:32,094 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.624552
==== completed _train_epoch train()
2023-11-26 00:30:32,423 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3137843608856201
2023-11-26 00:30:32,423 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3137843608856201
2023-11-26 00:30:32,424 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.5299530029296875e-06
2023-11-26 00:30:32,424 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.5299530029296875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:32,424 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958632.4245846, tag: upload
2023-11-26 00:30:32,424 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:32,426 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:32,426 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:32,426 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:32,427 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:32,427 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:32,427 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:32,427 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:32,427 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:32,428 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:32,428 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:32,428 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:32,428 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:32,428 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:32,447 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:32,447 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:32,448 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:32,449 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:32,452 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:32,452 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,453 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:32,453 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,453 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,456 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:32,456 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,457 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,457 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:32,457 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,457 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,457 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,457 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:32,457 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:32,459 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:32,459 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,460 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:32,460 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,461 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,461 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:32,461 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,461 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,461 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:32,461 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,461 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,461 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,461 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:32,461 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:32,462 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:32,462 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,462 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:32,462 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,462 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,464 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:32,464 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,464 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,464 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:32,464 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,464 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:32,464 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:32,465 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:32,465 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:32,465 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04123640060424805
2023-11-26 00:30:32,466 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04123640060424805
2023-11-26 00:30:32,466 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:32,467 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 32.9
2023-11-26 00:30:32,467 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.061538461538461
2023-11-26 00:30:32,468 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:32,469 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:32,470 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:30:32,470 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 11.45617324089697
2023-11-26 00:30:32,470 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151422464
2023-11-26 00:30:32,471 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151438848
2023-11-26 00:30:32,471 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151423724.3076923
2023-11-26 00:30:32,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:32,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:32,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:32,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4365.833912493613
2023-11-26 00:30:32,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:30:32,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:30:32,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707622557.538462
2023-11-26 00:30:32,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:32,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:32,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:32,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 121151.89107169777
2023-11-26 00:30:32,475 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 12.182556390762329, 'train.runtime': 1.3137843608856201, 'evaluate.runtime': 4.5299530029296875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04123640060424805, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 32.9, 'mean.cpu_utilization': 5.061538461538461, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 11.45617324089697, 'min.cpu_memory_rss': 1151422464, 'max.cpu_memory_rss': 1151438848, 'mean.cpu_memory_rss': 1151423724.3076923, '25th_prcntl.cpu_memory_rss': 1151422464.0, '50th_prcntl.cpu_memory_rss': 1151422464.0, '75th_prcntl.cpu_memory_rss': 1151422464.0, 'std.cpu_memory_rss': 4365.833912493613, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707622557.538462, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 121151.89107169777, 'save_metrics.runtime': 0.00906825065612793}
2023-11-26 00:30:32,475 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:32,476 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009696722030639648
2023-11-26 00:30:32,476 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009696722030639648
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:32,476 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958632.476332, tag: fetch
2023-11-26 00:30:32,476 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:32,476 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:32,476 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:32,477 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:32,477 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:32,477 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:32,477 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:32,477 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:32,477 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:32,477 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:32,477 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:32,478 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:32,478 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:32,478 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:44,936 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,938 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,939 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,939 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,940 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,942 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,942 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,942 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:44,942 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,942 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,942 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:30:44,943 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,944 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:44,945 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,945 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,945 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:44,945 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,945 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,945 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:30:44,946 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,947 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:44,947 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:44,947 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,947 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:30:44,947 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,947 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:44,948 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,949 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:44,949 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:44,956 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 30
2023-11-26 00:30:44,956 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:44,956 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 12.48056697845459
2023-11-26 00:30:44,956 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 12.48056697845459
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:45,098 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 1.099784
2023-11-26 00:30:45,936 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.299516
==== completed _train_epoch train()
2023-11-26 00:30:46,307 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3502264022827148
2023-11-26 00:30:46,307 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3502264022827148
2023-11-26 00:30:46,308 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.0531158447265625e-06
2023-11-26 00:30:46,308 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.0531158447265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:46,308 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958646.3089685, tag: upload
2023-11-26 00:30:46,309 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:46,310 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:46,310 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:46,310 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:46,311 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:46,311 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:46,311 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:46,311 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:46,312 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:46,312 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:46,312 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:46,312 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:46,312 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:46,312 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:46,327 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:46,327 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:46,327 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:46,328 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:46,331 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:46,331 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,332 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:46,333 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,333 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,336 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:46,336 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,336 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,336 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:46,336 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,336 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,336 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,336 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:46,336 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:46,338 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:46,338 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,338 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:46,339 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,339 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,339 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:46,339 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,339 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,339 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:46,339 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,339 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,340 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,340 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:46,340 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:46,340 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:46,340 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,340 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:46,340 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,340 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,342 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:46,342 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,342 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,343 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:46,343 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,343 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:46,343 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:46,343 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:46,343 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:46,343 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03461933135986328
2023-11-26 00:30:46,343 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03461933135986328
2023-11-26 00:30:46,344 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:46,344 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 79.8
2023-11-26 00:30:46,344 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 9.335714285714285
2023-11-26 00:30:46,344 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:46,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:46,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:46,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 23.358804003839666
2023-11-26 00:30:46,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151422464
2023-11-26 00:30:46,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151438848
2023-11-26 00:30:46,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151423634.2857144
2023-11-26 00:30:46,345 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4219.525149800143
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708435456
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707648146.285715
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:46,346 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:46,347 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:30:46,347 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 218360.4265021574
2023-11-26 00:30:46,347 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 12.48056697845459, 'train.runtime': 1.3502264022827148, 'evaluate.runtime': 4.0531158447265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03461933135986328, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 79.8, 'mean.cpu_utilization': 9.335714285714285, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 23.358804003839666, 'min.cpu_memory_rss': 1151422464, 'max.cpu_memory_rss': 1151438848, 'mean.cpu_memory_rss': 1151423634.2857144, '25th_prcntl.cpu_memory_rss': 1151422464.0, '50th_prcntl.cpu_memory_rss': 1151422464.0, '75th_prcntl.cpu_memory_rss': 1151422464.0, 'std.cpu_memory_rss': 4219.525149800143, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708435456, 'mean.cpu_memory_vsz': 13707648146.285715, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 218360.4265021574, 'save_metrics.runtime': 0.009696722030639648}
2023-11-26 00:30:46,347 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:46,347 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.0037598609924316406
2023-11-26 00:30:46,347 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.0037598609924316406
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:46,347 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958646.3477616, tag: fetch
2023-11-26 00:30:46,347 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:30:46,348 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:46,348 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:46,348 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:46,348 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:46,348 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:46,348 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:46,348 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:46,348 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:46,348 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:46,348 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:46,348 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:46,349 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:46,349 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:03,663 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,666 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,667 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,667 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,667 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,668 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:31:03,668 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,668 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:31:03,669 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,671 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:03,672 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,672 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,676 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,676 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,677 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,677 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,677 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,678 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,678 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,678 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,678 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:31:03,678 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,678 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:31:03,679 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,681 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:03,681 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,682 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,682 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:31:03,682 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,682 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:31:03,682 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,682 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:03,684 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,684 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:03,684 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:03,699 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 33
2023-11-26 00:31:03,700 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:03,700 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 17.352341890335083
2023-11-26 00:31:03,700 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 17.352341890335083
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:03,800 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 2.291685
2023-11-26 00:31:04,640 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.889768
==== completed _train_epoch train()
2023-11-26 00:31:04,957 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2567267417907715
2023-11-26 00:31:04,957 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2567267417907715
2023-11-26 00:31:04,957 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.76837158203125e-06
2023-11-26 00:31:04,958 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.76837158203125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:04,958 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958664.95835, tag: upload
2023-11-26 00:31:04,958 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:31:04,959 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:04,960 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:04,960 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:04,960 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:04,961 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:04,961 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:04,961 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:04,961 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:04,961 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:04,961 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:04,961 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:04,962 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:04,962 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:04,977 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:04,977 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:04,978 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:04,979 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:04,983 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:04,984 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,985 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:04,986 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,986 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,989 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:04,989 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,989 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,989 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:04,989 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,989 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,989 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,989 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:04,990 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:04,991 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:04,991 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,992 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:04,992 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,992 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,993 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:04,993 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,993 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,993 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:04,993 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,993 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,994 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,994 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:04,994 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:04,994 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:04,994 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,995 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:04,995 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,995 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,996 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:04,996 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,996 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,996 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:04,997 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,997 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:04,997 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:04,997 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:04,997 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:04,998 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03992033004760742
2023-11-26 00:31:04,998 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03992033004760742
2023-11-26 00:31:04,999 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:04,999 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 77.9
2023-11-26 00:31:04,999 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.773684210526315
2023-11-26 00:31:05,000 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:05,001 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:05,001 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:05,002 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 22.383119628892878
2023-11-26 00:31:05,002 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151422464
2023-11-26 00:31:05,002 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151442944
2023-11-26 00:31:05,002 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151423541.8947368
2023-11-26 00:31:05,003 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:31:05,003 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:31:05,004 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151422464.0
2023-11-26 00:31:05,004 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4573.12006695805
2023-11-26 00:31:05,004 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:31:05,005 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:31:05,005 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707611513.263159
2023-11-26 00:31:05,005 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:05,006 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:05,006 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:05,006 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 101523.26548646874
2023-11-26 00:31:05,007 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 17.352341890335083, 'train.runtime': 1.2567267417907715, 'evaluate.runtime': 4.76837158203125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03992033004760742, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 77.9, 'mean.cpu_utilization': 7.773684210526315, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 22.383119628892878, 'min.cpu_memory_rss': 1151422464, 'max.cpu_memory_rss': 1151442944, 'mean.cpu_memory_rss': 1151423541.8947368, '25th_prcntl.cpu_memory_rss': 1151422464.0, '50th_prcntl.cpu_memory_rss': 1151422464.0, '75th_prcntl.cpu_memory_rss': 1151422464.0, 'std.cpu_memory_rss': 4573.12006695805, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707611513.263159, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 101523.26548646874, 'save_metrics.runtime': 0.0037598609924316406}
2023-11-26 00:31:05,007 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:05,007 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008797645568847656
2023-11-26 00:31:05,007 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008797645568847656
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:05,007 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958665.0078008, tag: fetch
2023-11-26 00:31:05,007 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:31:05,008 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:05,008 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:05,008 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:05,009 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:05,009 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:05,009 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:05,009 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:05,009 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:05,009 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:05,009 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:05,009 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:05,009 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:05,009 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:17,276 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,279 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,279 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,280 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,280 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,280 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:31:17,280 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,281 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:31:17,282 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,282 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:17,283 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,284 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,289 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,290 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,291 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,294 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,294 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:17,295 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:31:17,295 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:17,295 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:31:17,295 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:31:17,297 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:31:17,298 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:17,299 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:17,299 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:17,300 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:17,304 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:17,305 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:17,317 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 35
2023-11-26 00:31:17,317 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:17,318 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 12.31028437614441
2023-11-26 00:31:17,318 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 12.31028437614441
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:17,452 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 2.003584
2023-11-26 00:31:18,223 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.751414
==== completed _train_epoch train()
2023-11-26 00:31:18,514 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.1963655948638916
2023-11-26 00:31:18,514 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.1963655948638916
2023-11-26 00:31:18,515 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 1.9073486328125e-06
2023-11-26 00:31:18,515 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 1.9073486328125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:18,515 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958678.5152025, tag: upload
2023-11-26 00:31:18,515 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:31:18,517 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:18,518 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:18,518 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:18,518 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:18,518 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:18,519 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:18,519 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:18,519 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,519 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:18,519 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:18,519 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:18,519 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,519 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:18,537 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:18,537 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:18,538 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:18,539 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:18,543 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,543 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,545 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,545 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,545 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,548 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,548 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,548 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,548 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,548 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,548 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,549 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,549 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:18,549 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:18,550 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,550 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,551 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,551 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,551 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,552 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,552 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,552 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,552 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,552 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,552 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,552 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,552 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:18,552 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:18,553 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,553 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,553 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,553 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,553 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,555 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:18,555 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,555 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,555 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:18,555 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,555 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:18,555 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:18,555 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:18,556 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:18,556 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04135489463806152
2023-11-26 00:31:18,556 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04135489463806152
2023-11-26 00:31:18,557 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:18,557 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 34.9
2023-11-26 00:31:18,558 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 4.3
2023-11-26 00:31:18,559 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:18,559 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:18,560 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:31:18,560 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 10.155104817093413
2023-11-26 00:31:18,560 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151426560
2023-11-26 00:31:18,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151516672
2023-11-26 00:31:18,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151433491.6923077
2023-11-26 00:31:18,561 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151426560.0
2023-11-26 00:31:18,562 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151426560.0
2023-11-26 00:31:18,562 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151426560.0
2023-11-26 00:31:18,563 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 24012.08651871487
2023-11-26 00:31:18,563 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:31:18,563 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708439552
2023-11-26 00:31:18,563 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707653120.0
2023-11-26 00:31:18,564 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:18,564 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:18,565 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:18,565 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 227023.36344966787
2023-11-26 00:31:18,565 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 12.31028437614441, 'train.runtime': 1.1963655948638916, 'evaluate.runtime': 1.9073486328125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04135489463806152, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 34.9, 'mean.cpu_utilization': 4.3, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 10.155104817093413, 'min.cpu_memory_rss': 1151426560, 'max.cpu_memory_rss': 1151516672, 'mean.cpu_memory_rss': 1151433491.6923077, '25th_prcntl.cpu_memory_rss': 1151426560.0, '50th_prcntl.cpu_memory_rss': 1151426560.0, '75th_prcntl.cpu_memory_rss': 1151426560.0, 'std.cpu_memory_rss': 24012.08651871487, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708439552, 'mean.cpu_memory_vsz': 13707653120.0, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 227023.36344966787, 'save_metrics.runtime': 0.008797645568847656}
2023-11-26 00:31:18,566 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:18,566 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009228229522705078
2023-11-26 00:31:18,566 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009228229522705078
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:18,566 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958678.5666752, tag: fetch
2023-11-26 00:31:18,566 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:31:18,567 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:18,567 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:18,567 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:18,567 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:18,568 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:18,568 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:18,568 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:18,568 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,568 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:18,568 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:18,568 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:18,568 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:18,568 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:27,455 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:27,455 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:27,456 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:27,456 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:50,348 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:50,351 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:50,351 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:50,351 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:50,352 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:50,354 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:50,354 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:50,355 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:50,355 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:50,355 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:31:50,355 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:50,356 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:31:50,357 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:50,358 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:50,359 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:50,359 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:50,359 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:31:50,360 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:50,360 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:31:50,360 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:31:50,361 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:31:50,362 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:50,363 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:50,363 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:50,363 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:50,367 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:50,367 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:50,375 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 40
2023-11-26 00:31:50,375 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:50,375 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 31.808928966522217
2023-11-26 00:31:50,375 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 31.808928966522217
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:50,486 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 2.512878
2023-11-26 00:31:51,380 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.432092
==== completed _train_epoch train()
2023-11-26 00:31:51,733 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3571624755859375
2023-11-26 00:31:51,733 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3571624755859375
2023-11-26 00:31:51,733 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:31:51,734 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:51,734 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958711.7342525, tag: upload
2023-11-26 00:31:51,734 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:31:51,735 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:51,735 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:51,736 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:51,736 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:51,736 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:51,736 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:51,736 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:51,737 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:51,737 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:51,737 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:51,737 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:51,737 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:51,737 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:51,753 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:51,754 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:51,754 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:51,755 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:51,759 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:51,759 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,761 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:51,761 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,761 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,764 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:51,764 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,764 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,765 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:51,765 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,765 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,765 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,765 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:51,765 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:51,767 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:51,767 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,768 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:51,769 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,769 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,769 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:51,769 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,769 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,769 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:51,769 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,769 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,769 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,769 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:51,770 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:51,770 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:51,770 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,770 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:51,770 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,770 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,772 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:51,772 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,772 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,772 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:51,773 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,773 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:51,773 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:51,773 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:51,773 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:51,773 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03958296775817871
2023-11-26 00:31:51,773 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03958296775817871
2023-11-26 00:31:51,774 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:51,774 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 89.8
2023-11-26 00:31:51,775 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.811764705882353
2023-11-26 00:31:51,776 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:51,776 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:51,777 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:51,777 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 20.51117005160391
2023-11-26 00:31:51,777 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151504384
2023-11-26 00:31:51,777 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1151922176
2023-11-26 00:31:51,777 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151517274.3529413
2023-11-26 00:31:51,778 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151504384.0
2023-11-26 00:31:51,778 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151504384.0
2023-11-26 00:31:51,779 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151504384.0
2023-11-26 00:31:51,779 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 70569.13691754489
2023-11-26 00:31:51,780 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:31:51,780 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708836864
2023-11-26 00:31:51,780 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707649385.411764
2023-11-26 00:31:51,780 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:51,781 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:51,781 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:31:51,782 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 251857.21319805252
2023-11-26 00:31:51,782 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 31.808928966522217, 'train.runtime': 1.3571624755859375, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03958296775817871, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 89.8, 'mean.cpu_utilization': 5.811764705882353, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 20.51117005160391, 'min.cpu_memory_rss': 1151504384, 'max.cpu_memory_rss': 1151922176, 'mean.cpu_memory_rss': 1151517274.3529413, '25th_prcntl.cpu_memory_rss': 1151504384.0, '50th_prcntl.cpu_memory_rss': 1151504384.0, '75th_prcntl.cpu_memory_rss': 1151504384.0, 'std.cpu_memory_rss': 70569.13691754489, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708836864, 'mean.cpu_memory_vsz': 13707649385.411764, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 251857.21319805252, 'save_metrics.runtime': 0.009228229522705078}
2023-11-26 00:31:51,782 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:51,782 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008604764938354492
2023-11-26 00:31:51,782 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008604764938354492
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:51,783 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958711.783204, tag: fetch
2023-11-26 00:31:51,783 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:31:51,783 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:51,783 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:51,784 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:51,784 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:51,784 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:51,784 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:51,784 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:51,784 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:51,784 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:51,784 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:51,784 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:51,785 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:51,785 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:03,566 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,568 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,569 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,569 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,569 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,569 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:03,569 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,569 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:03,571 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,574 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:03,574 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,575 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,579 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,580 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,580 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,581 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,581 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,581 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:03,581 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,581 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:03,582 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:03,583 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:03,586 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:03,587 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,588 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:03,588 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,594 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:03,594 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:03,600 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 42
2023-11-26 00:32:03,600 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:03,600 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.817106246948242
2023-11-26 00:32:03,600 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.817106246948242
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:03,747 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 4.131599
2023-11-26 00:32:04,620 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.355770
==== completed _train_epoch train()
2023-11-26 00:32:04,970 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.370384693145752
2023-11-26 00:32:04,971 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.370384693145752
2023-11-26 00:32:04,971 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:32:04,971 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:04,971 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958724.9718323, tag: upload
2023-11-26 00:32:04,971 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:04,972 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:04,973 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:04,973 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:04,973 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:04,974 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:04,974 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:04,974 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:04,974 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:04,974 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:04,974 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:04,974 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:04,974 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:04,975 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:04,989 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:04,990 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:04,990 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:04,990 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:04,995 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:04,995 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:04,997 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:04,997 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:04,997 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,000 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:05,000 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,000 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,001 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:05,001 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,001 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,001 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,001 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:05,001 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:05,002 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:05,003 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,004 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:05,004 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,004 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,004 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:05,004 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,005 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,005 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:05,005 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,005 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,005 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,005 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:05,005 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:05,005 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:05,005 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,006 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:05,006 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,006 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,008 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:05,008 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,008 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,008 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:05,008 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,008 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:05,008 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:05,008 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:05,009 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:05,009 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03752589225769043
2023-11-26 00:32:05,009 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03752589225769043
2023-11-26 00:32:05,009 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:05,009 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 79.9
2023-11-26 00:32:05,010 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 7.376923076923077
2023-11-26 00:32:05,010 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:05,010 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:05,011 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:32:05,011 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 21.105163562362716
2023-11-26 00:32:05,011 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1151508480
2023-11-26 00:32:05,011 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152516096
2023-11-26 00:32:05,011 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1151662867.6923077
2023-11-26 00:32:05,011 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1151508480.0
2023-11-26 00:32:05,012 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1151508480.0
2023-11-26 00:32:05,012 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1151508480.0
2023-11-26 00:32:05,012 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 362074.79691173555
2023-11-26 00:32:05,012 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:32:05,012 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:32:05,012 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707626968.615385
2023-11-26 00:32:05,013 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:05,013 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:05,013 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:05,013 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 120841.75589940784
2023-11-26 00:32:05,014 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 11.817106246948242, 'train.runtime': 1.370384693145752, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03752589225769043, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 79.9, 'mean.cpu_utilization': 7.376923076923077, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 21.105163562362716, 'min.cpu_memory_rss': 1151508480, 'max.cpu_memory_rss': 1152516096, 'mean.cpu_memory_rss': 1151662867.6923077, '25th_prcntl.cpu_memory_rss': 1151508480.0, '50th_prcntl.cpu_memory_rss': 1151508480.0, '75th_prcntl.cpu_memory_rss': 1151508480.0, 'std.cpu_memory_rss': 362074.79691173555, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707626968.615385, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 120841.75589940784, 'save_metrics.runtime': 0.008604764938354492}
2023-11-26 00:32:05,014 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:05,014 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.004740476608276367
2023-11-26 00:32:05,014 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.004740476608276367
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:05,014 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958725.014585, tag: fetch
2023-11-26 00:32:05,014 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:05,015 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:05,015 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:05,015 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:05,015 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:05,015 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:05,015 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:05,016 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:05,016 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:05,016 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:05,016 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:05,016 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:05,016 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:05,016 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:27,527 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:27,527 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:27,527 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:27,528 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,525 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,529 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,530 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,530 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,531 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,533 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,533 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,534 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:29,534 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,534 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,534 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:29,535 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,538 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:29,539 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,539 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,539 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:29,539 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,540 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,540 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:29,541 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:29,543 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:29,544 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:29,544 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:29,544 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:29,544 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:29,544 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:29,545 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:29,550 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:29,550 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:29,585 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 46
2023-11-26 00:32:29,585 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:29,585 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 24.570731163024902
2023-11-26 00:32:29,585 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 24.570731163024902
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:29,665 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 0.534481
2023-11-26 00:32:30,455 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.395726
==== completed _train_epoch train()
2023-11-26 00:32:30,799 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2143189907073975
2023-11-26 00:32:30,800 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2143189907073975
2023-11-26 00:32:30,800 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:32:30,800 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:30,801 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958750.8010576, tag: upload
2023-11-26 00:32:30,801 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:30,801 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:30,802 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:30,802 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:30,802 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:30,802 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:30,802 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:30,802 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:30,802 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,802 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:30,802 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:30,802 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:30,802 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,802 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:30,813 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154213
2023-11-26 00:32:30,813 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154213
2023-11-26 00:32:30,813 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154213
2023-11-26 00:32:30,814 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:30,816 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,816 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,817 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,817 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,818 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,819 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,819 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,819 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,820 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,820 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,820 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,820 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,820 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:30,820 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:30,821 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,821 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,822 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,822 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,822 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,822 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,822 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,822 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,822 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,823 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,823 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,823 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,823 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:30,823 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57061
2023-11-26 00:32:30,823 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,823 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,823 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,823 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,823 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,825 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:30,825 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,825 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,825 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:30,825 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,825 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:30,825 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:30,825 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:30,826 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:30,826 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.025326967239379883
2023-11-26 00:32:30,826 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.025326967239379883
2023-11-26 00:32:30,827 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:30,827 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 88.7
2023-11-26 00:32:30,827 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.023076923076923
2023-11-26 00:32:30,828 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:30,829 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:30,829 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:30,829 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.63114176005949
2023-11-26 00:32:30,830 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152499712
2023-11-26 00:32:30,830 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152516096
2023-11-26 00:32:30,830 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152500972.3076923
2023-11-26 00:32:30,830 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:30,831 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:30,831 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:30,832 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4365.833912493613
2023-11-26 00:32:30,832 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:32:30,832 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708435456
2023-11-26 00:32:30,832 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707637681.23077
2023-11-26 00:32:30,833 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:30,833 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:30,833 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:30,834 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 181907.19959962417
2023-11-26 00:32:30,834 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 24.570731163024902, 'train.runtime': 1.2143189907073975, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154213, 'upload.runtime': 0.025326967239379883, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 88.7, 'mean.cpu_utilization': 5.023076923076923, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 17.63114176005949, 'min.cpu_memory_rss': 1152499712, 'max.cpu_memory_rss': 1152516096, 'mean.cpu_memory_rss': 1152500972.3076923, '25th_prcntl.cpu_memory_rss': 1152499712.0, '50th_prcntl.cpu_memory_rss': 1152499712.0, '75th_prcntl.cpu_memory_rss': 1152499712.0, 'std.cpu_memory_rss': 4365.833912493613, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708435456, 'mean.cpu_memory_vsz': 13707637681.23077, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 181907.19959962417, 'save_metrics.runtime': 0.004740476608276367}
2023-11-26 00:32:30,834 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:30,834 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008092164993286133
2023-11-26 00:32:30,834 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008092164993286133
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:30,835 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958750.8352578, tag: fetch
2023-11-26 00:32:30,835 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:30,835 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:30,835 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:30,835 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:30,836 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:30,836 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:30,836 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:30,836 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:30,836 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,836 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:30,836 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:30,836 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:30,836 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:30,836 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:49,628 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,631 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,632 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,632 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,632 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,635 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,635 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,635 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:49,635 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,636 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,636 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:49,637 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,638 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:49,644 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,644 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,644 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:49,644 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,644 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,645 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:49,645 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,646 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:49,652 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:49,652 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,652 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:49,652 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,652 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:49,655 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,658 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:49,658 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:49,669 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 49
2023-11-26 00:32:49,669 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:49,669 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 18.83442521095276
2023-11-26 00:32:49,669 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 18.83442521095276
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:49,802 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 4.382793
2023-11-26 00:32:50,669 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.360798
==== completed _train_epoch train()
2023-11-26 00:32:51,022 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.3530008792877197
2023-11-26 00:32:51,023 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.3530008792877197
2023-11-26 00:32:51,023 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.76837158203125e-06
2023-11-26 00:32:51,023 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.76837158203125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:51,024 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958771.024108, tag: upload
2023-11-26 00:32:51,024 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:51,025 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:51,025 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:51,025 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:51,026 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:51,026 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:51,026 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:51,026 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,026 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,026 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:51,026 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,026 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:51,026 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,027 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:51,037 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:51,037 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:51,037 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:51,038 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:51,041 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,041 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,043 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,043 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,043 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,046 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,046 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,046 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,046 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,047 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,047 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,047 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,047 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,047 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:51,048 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,048 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,049 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,049 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,049 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,050 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,050 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,050 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,050 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,050 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,050 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,050 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,050 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,051 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:51,051 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,051 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,051 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,051 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,051 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,053 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,053 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,054 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,054 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,054 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,054 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,054 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,054 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,055 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:51,055 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03169989585876465
2023-11-26 00:32:51,055 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03169989585876465
2023-11-26 00:32:51,056 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:51,056 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 86.8
2023-11-26 00:32:51,057 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.09
2023-11-26 00:32:51,058 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:51,058 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:51,059 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:32:51,059 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 18.84552732082602
2023-11-26 00:32:51,060 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152499712
2023-11-26 00:32:51,060 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152516096
2023-11-26 00:32:51,060 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152501145.6
2023-11-26 00:32:51,061 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:51,061 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:51,062 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:51,062 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 4349.288567110718
2023-11-26 00:32:51,062 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:32:51,062 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:32:51,062 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707613184.0
2023-11-26 00:32:51,063 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:51,063 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:51,064 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:51,064 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 99220.26322077563
2023-11-26 00:32:51,065 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 18.83442521095276, 'train.runtime': 1.3530008792877197, 'evaluate.runtime': 4.76837158203125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03169989585876465, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 86.8, 'mean.cpu_utilization': 5.09, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.25, 'std.cpu_utilization': 18.84552732082602, 'min.cpu_memory_rss': 1152499712, 'max.cpu_memory_rss': 1152516096, 'mean.cpu_memory_rss': 1152501145.6, '25th_prcntl.cpu_memory_rss': 1152499712.0, '50th_prcntl.cpu_memory_rss': 1152499712.0, '75th_prcntl.cpu_memory_rss': 1152499712.0, 'std.cpu_memory_rss': 4349.288567110718, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707613184.0, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 99220.26322077563, 'save_metrics.runtime': 0.008092164993286133}
2023-11-26 00:32:51,065 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:51,065 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009521961212158203
2023-11-26 00:32:51,065 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009521961212158203
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:51,066 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958771.0662715, tag: fetch
2023-11-26 00:32:51,066 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:51,066 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:51,067 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:51,067 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:51,067 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:51,067 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:51,068 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:51,068 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,068 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,068 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:51,068 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:51,068 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,068 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:51,068 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:56,348 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:56,351 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:56,351 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:56,351 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:56,352 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:56,354 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:56,354 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:56,354 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:56,355 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:56,355 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:56,355 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048675
2023-11-26 00:32:56,356 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:56,357 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:56,358 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:56,358 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:56,358 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:56,359 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:56,359 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:56,359 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 1048677
2023-11-26 00:32:56,360 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:56,361 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:56,361 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:56,362 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:56,362 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376; len: 57155
2023-11-26 00:32:56,362 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:56,362 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:56,362 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:56,365 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:56,365 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:56,373 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 50
2023-11-26 00:32:56,373 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:56,374 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 5.307852506637573
2023-11-26 00:32:56,374 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 5.307852506637573
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:56,503 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/4493 (0%)]	loss: 2.911005
2023-11-26 00:32:57,301 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/4493 (71%)]	loss: 0.483002
==== completed _train_epoch train()
2023-11-26 00:32:57,632 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 1.2580797672271729
2023-11-26 00:32:57,632 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 1.2580797672271729
2023-11-26 00:32:57,633 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:32:57,633 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:57,633 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958777.6336584, tag: upload
2023-11-26 00:32:57,633 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:57,634 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:57,635 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:57,635 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:57,636 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:57,636 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:57,636 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:57,636 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:57,636 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:57,636 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:57,636 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:57,637 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:57,637 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:57,637 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:57,652 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:57,652 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:57,653 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:57,653 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:57,658 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:57,658 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,660 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:57,660 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,660 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,663 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:57,663 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,663 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,663 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:57,663 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,664 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,664 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,664 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:57,664 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:57,665 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:57,665 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,667 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:57,667 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,667 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,667 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:57,667 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,667 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,667 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:57,668 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,668 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,668 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,668 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:57,668 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:57,668 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:57,668 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,669 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:57,669 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,669 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,671 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:57,671 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,671 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,671 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:57,671 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,671 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:57,671 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:57,671 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580376/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:57,671 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:57,672 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.038608551025390625
2023-11-26 00:32:57,672 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.038608551025390625
2023-11-26 00:32:57,672 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:57,673 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 29.0
2023-11-26 00:32:57,673 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 9.333333333333334
2023-11-26 00:32:57,674 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.25
2023-11-26 00:32:57,674 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:32:57,675 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 19.0
2023-11-26 00:32:57,675 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 12.552113589175153
2023-11-26 00:32:57,675 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152499712
2023-11-26 00:32:57,676 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152516096
2023-11-26 00:32:57,676 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152502442.6666667
2023-11-26 00:32:57,676 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:57,677 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:57,677 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152499712.0
2023-11-26 00:32:57,677 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 6105.956290559425
2023-11-26 00:32:57,678 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707587584
2023-11-26 00:32:57,678 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708042240
2023-11-26 00:32:57,678 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707663360.0
2023-11-26 00:32:57,678 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:57,679 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:57,679 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707587584.0
2023-11-26 00:32:57,680 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 169440.28706302406
2023-11-26 00:32:57,680 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.006299495697021484, 'load_data.runtime': 0.9175243377685547, 'init.runtime': 1.8639791011810303, 'recv.bytes': 2154204, 'fetch.runtime': 5.307852506637573, 'train.runtime': 1.2580797672271729, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.038608551025390625, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 29.0, 'mean.cpu_utilization': 9.333333333333334, '25th_prcntl.cpu_utilization': 0.25, '50th_prcntl.cpu_utilization': 1.0, '75th_prcntl.cpu_utilization': 19.0, 'std.cpu_utilization': 12.552113589175153, 'min.cpu_memory_rss': 1152499712, 'max.cpu_memory_rss': 1152516096, 'mean.cpu_memory_rss': 1152502442.6666667, '25th_prcntl.cpu_memory_rss': 1152499712.0, '50th_prcntl.cpu_memory_rss': 1152499712.0, '75th_prcntl.cpu_memory_rss': 1152499712.0, 'std.cpu_memory_rss': 6105.956290559425, 'min.cpu_memory_vsz': 13707587584, 'max.cpu_memory_vsz': 13708042240, 'mean.cpu_memory_vsz': 13707663360.0, '25th_prcntl.cpu_memory_vsz': 13707587584.0, '50th_prcntl.cpu_memory_vsz': 13707587584.0, '75th_prcntl.cpu_memory_vsz': 13707587584.0, 'std.cpu_memory_vsz': 169440.28706302406, 'save_metrics.runtime': 0.009521961212158203}
2023-11-26 00:32:57,680 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:57,680 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007987260818481445
2023-11-26 00:32:57,680 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007987260818481445
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:57,681 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958777.6810045, tag: fetch
2023-11-26 00:32:57,681 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f07359056a0>
2023-11-26 00:32:57,681 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:57,681 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:57,681 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:57,682 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:57,682 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:57,682 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:57,682 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:57,682 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:57,682 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:57,682 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:57,682 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580376, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580376': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:57,682 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:57,682 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:33:03,068 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,069 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,069 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,070 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,070 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,070 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,070 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,071 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,071 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 59
2023-11-26 00:33:03,071 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,072 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 59
2023-11-26 00:33:03,072 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 59
extracting weights from message
2023-11-26 00:33:03,073 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: True, round: 50
2023-11-26 00:33:03,073 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:33:03,073 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 5.392854452133179
2023-11-26 00:33:03,073 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 5.392854452133179
2023-11-26 00:33:03,074 | composer.py:145 | DEBUG | MainThread | run | end of run
2023-11-26 00:33:03,075 | channel_manager.py:187 | DEBUG | MainThread | cleanup | calling cleanup
2023-11-26 00:33:03,075 | channel_manager.py:189 | DEBUG | MainThread | cleanup | calling leave for channel param-channel
2023-11-26 00:33:03,075 | channel.py:414 | DEBUG | MainThread | leave | calling channel leave for param-channel
2023-11-26 00:33:03,076 | channel.py:420 | DEBUG | MainThread | leave |  channel leave done for param-channel
2023-11-26 00:33:03,077 | mqtt.py:552 | DEBUG | Thread-3 | misc_loop | misc_loop finished
2023-11-26 00:33:03,078 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-154
2023-11-26 00:33:03,078 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-2
2023-11-26 00:33:03,078 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-8
2023-11-26 00:33:03,078 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-7
2023-11-26 00:33:03,079 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-4
2023-11-26 00:33:03,079 | channel_manager.py:200 | DEBUG | Thread-3 | _inner | done with cleaning up asyncio tasks
