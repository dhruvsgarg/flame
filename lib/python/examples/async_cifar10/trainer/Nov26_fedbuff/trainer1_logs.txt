2023-11-26 00:27:23,447 | fedadagrad.py:27 | DEBUG | MainThread | FedAdaGrad | Initializing fedadagrad
2023-11-26 00:27:23,448 | fedadam.py:27 | DEBUG | MainThread | FedAdam | Initializing fedadam
2023-11-26 00:27:23,449 | fedyogi.py:27 | DEBUG | MainThread | FedYogi | Initializing fedyogi
2023-11-26 00:27:24,781 | metric_collector.py:52 | DEBUG | Thread-2 | gather_gpu_stats | could not start gpustat.nvml.pynvml; no GPU metrics will be collected
2023-11-26 00:27:26,997 | channel_manager.py:72 | INFO | MainThread | __new__ | creating a ChannelManager instance
2023-11-26 00:27:26,998 | selector_events.py:54 | DEBUG | MainThread | __init__ | Using selector: EpollSelector
2023-11-26 00:27:27,001 | mqtt.py:514 | DEBUG | Thread-3 | on_socket_open | Socket opened
2023-11-26 00:27:27,001 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,002 | mqtt.py:546 | DEBUG | Thread-3 | misc_loop | misc_loop started
2023-11-26 00:27:27,002 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,002 | channel_manager.py:146 | INFO | MainThread | join | no backend found for channel param-channel; use default
2023-11-26 00:27:27,003 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,003 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,004 | mqtt.py:294 | DEBUG | Thread-3 | on_connect | calling on_connect
2023-11-26 00:27:27,004 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,004 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,005 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,005 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,006 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/+
2023-11-26 00:27:27,006 | mqtt.py:531 | DEBUG | MainThread | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,006 | mqtt.py:322 | DEBUG | MainThread | subscribe | subscribe topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/+/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371
2023-11-26 00:27:27,006 | mqtt.py:349 | DEBUG | MainThread | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371
2023-11-26 00:27:27,007 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[internal_init.runtime] = 0.009078264236450195
2023-11-26 00:27:27,007 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of internal_init is 0.009078264236450195
2023-11-26 00:27:27,007 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,008 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,008 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,053 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,054 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,055 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,056 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb; len: 47
2023-11-26 00:27:27,056 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,056 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,056 | mqtt.py:206 | DEBUG | Thread-3 | _handle_health_message | end: 505f9fc483cf4df68a2409257b5fad7d3c580371, status: online
2023-11-26 00:27:27,057 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,106 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,107 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,107 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,107 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,108 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,108 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,108 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,108 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 97
2023-11-26 00:27:27,109 | mqtt.py:234 | DEBUG | Thread-3 | _handle_notification | acknowledge notification
2023-11-26 00:27:27,109 | mqtt.py:349 | DEBUG | Thread-3 | notify | notify: publish topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371
2023-11-26 00:27:27,110 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,110 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,152 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:27,152 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:27,152 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:27,153 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:27,153 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
Files already downloaded and verified
indices:  tensor([49857, 18045, 19756,  ..., 24444, 24083, 23272])
2023-11-26 00:27:27,911 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[load_data.runtime] = 0.9041342735290527
2023-11-26 00:27:27,911 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of load_data is 0.9041342735290527
2023-11-26 00:27:29,209 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[init.runtime] = 1.2976725101470947
2023-11-26 00:27:29,209 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of init is 1.2976725101470947
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:29,209 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958449.2099376, tag: fetch
2023-11-26 00:27:29,210 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:27:29,211 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:29,211 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:29,211 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:29,212 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:29,212 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:29,212 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:29,212 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:29,212 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': set()}
2023-11-26 00:27:29,212 | fedbuff.py:165 | DEBUG | Thread-3 | _handle_recv_state | let's select 1 ends
2023-11-26 00:27:29,213 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:29,213 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:29,213 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:29,214 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:27:45,565 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,575 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:45,576 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,583 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:45,583 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:45,583 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,585 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:45,586 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:27:45,586 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:27:45,603 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,604 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:27:45,604 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:45,604 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:45,604 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:27:45,605 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:27:45,606 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:27:45,607 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:27:45,608 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:27:45,608 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:45,608 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:27:45,608 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:27:45,608 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:27:45,609 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:45,611 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:27:45,611 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:27:45,624 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 3
2023-11-26 00:27:45,624 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:27:45,624 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 16.41430425643921
2023-11-26 00:27:45,624 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 16.41430425643921
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:27:46,136 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 8.250379
2023-11-26 00:27:47,148 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 1.337176
2023-11-26 00:27:47,988 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.932026
==== completed _train_epoch train()
2023-11-26 00:27:48,656 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 3.0315914154052734
2023-11-26 00:27:48,656 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 3.0315914154052734
2023-11-26 00:27:48,656 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.0531158447265625e-06
2023-11-26 00:27:48,657 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.0531158447265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:27:48,657 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958468.6573155, tag: upload
2023-11-26 00:27:48,657 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:27:48,658 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:48,658 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:48,658 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:48,659 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:48,659 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:48,659 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:48,659 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:48,659 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:48,659 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:27:48,659 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:48,659 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:48,659 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:48,659 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:48,673 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:27:48,673 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:27:48,673 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:27:48,673 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:27:48,678 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:48,678 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,680 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:48,680 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,680 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,684 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:48,684 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,684 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,684 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:48,684 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,684 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,685 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,685 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:48,685 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:27:48,686 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:48,686 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,687 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:48,687 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,687 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,688 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:48,688 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,688 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,688 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:48,688 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,688 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,688 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,688 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:48,688 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:27:48,688 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:48,688 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,688 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:48,688 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,688 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,691 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:27:48,691 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,691 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,691 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:27:48,691 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,691 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:27:48,691 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:27:48,691 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:27:48,691 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:27:48,692 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03480219841003418
2023-11-26 00:27:48,692 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03480219841003418
2023-11-26 00:27:48,693 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:27:48,693 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 497.0
2023-11-26 00:27:48,693 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 45.64
2023-11-26 00:27:48,695 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:48,695 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:27:48,696 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 45.9
2023-11-26 00:27:48,696 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 103.90827108560704
2023-11-26 00:27:48,696 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 68173824
2023-11-26 00:27:48,697 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1137119232
2023-11-26 00:27:48,697 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 876227624.96
2023-11-26 00:27:48,697 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 978259968.0
2023-11-26 00:27:48,698 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 978259968.0
2023-11-26 00:27:48,698 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 978259968.0
2023-11-26 00:27:48,699 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 274386956.13539565
2023-11-26 00:27:48,699 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 1881554944
2023-11-26 00:27:48,699 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13703684096
2023-11-26 00:27:48,699 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 10948752670.72
2023-11-26 00:27:48,700 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 12240900096.0
2023-11-26 00:27:48,700 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 12240900096.0
2023-11-26 00:27:48,700 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 12240900096.0
2023-11-26 00:27:48,701 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 3196658159.1400127
2023-11-26 00:27:48,701 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 16.41430425643921, 'train.runtime': 3.0315914154052734, 'evaluate.runtime': 4.0531158447265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03480219841003418, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 497.0, 'mean.cpu_utilization': 45.64, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 45.9, 'std.cpu_utilization': 103.90827108560704, 'min.cpu_memory_rss': 68173824, 'max.cpu_memory_rss': 1137119232, 'mean.cpu_memory_rss': 876227624.96, '25th_prcntl.cpu_memory_rss': 978259968.0, '50th_prcntl.cpu_memory_rss': 978259968.0, '75th_prcntl.cpu_memory_rss': 978259968.0, 'std.cpu_memory_rss': 274386956.13539565, 'min.cpu_memory_vsz': 1881554944, 'max.cpu_memory_vsz': 13703684096, 'mean.cpu_memory_vsz': 10948752670.72, '25th_prcntl.cpu_memory_vsz': 12240900096.0, '50th_prcntl.cpu_memory_vsz': 12240900096.0, '75th_prcntl.cpu_memory_vsz': 12240900096.0, 'std.cpu_memory_vsz': 3196658159.1400127}
2023-11-26 00:27:48,701 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:27:48,701 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009357929229736328
2023-11-26 00:27:48,701 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009357929229736328
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:27:48,702 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958468.7022393, tag: fetch
2023-11-26 00:27:48,702 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:27:48,702 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:27:48,702 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:27:48,703 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:27:48,703 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:27:48,703 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:27:48,703 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:27:48,703 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:27:48,703 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:48,703 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:27:48,704 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:27:48,704 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:27:48,704 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:27:48,704 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:18,434 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,437 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,438 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,438 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,440 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,444 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,444 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,444 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:28:18,444 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,445 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,445 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:28:18,446 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,448 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:28:18,449 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,449 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,449 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:28:18,449 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,450 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,450 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:28:18,451 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:28:18,453 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:28:18,453 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:28:18,454 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:18,454 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:28:18,454 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:18,454 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:28:18,455 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:18,460 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:28:18,460 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:28:18,468 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 8
2023-11-26 00:28:18,468 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:28:18,468 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 29.76619291305542
2023-11-26 00:28:18,468 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 29.76619291305542
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:28:18,625 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 2.651453
2023-11-26 00:28:19,485 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 1.179626
2023-11-26 00:28:20,205 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.780606
==== completed _train_epoch train()
2023-11-26 00:28:20,841 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.373297929763794
2023-11-26 00:28:20,842 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.373297929763794
2023-11-26 00:28:20,842 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:28:20,842 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:28:20,843 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958500.842979, tag: upload
2023-11-26 00:28:20,843 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:28:20,844 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:20,844 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:20,844 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:20,845 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:20,845 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:20,845 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:20,845 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:20,845 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:20,845 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:28:20,845 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:20,845 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:20,845 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:20,846 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:20,860 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:28:20,860 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:28:20,861 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:28:20,861 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:28:20,867 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:20,867 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,869 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:20,869 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,869 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,872 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:20,872 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,872 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:20,872 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,872 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,873 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,873 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:20,873 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:28:20,874 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:20,875 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,875 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:20,875 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,876 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,876 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:20,876 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,876 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,876 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:20,876 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,876 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,876 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,876 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:20,876 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:28:20,877 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:20,877 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,877 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:20,877 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,877 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,879 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:20,879 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,879 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,879 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:20,879 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,880 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:28:20,880 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:28:20,880 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:28:20,880 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:28:20,880 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03786897659301758
2023-11-26 00:28:20,881 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03786897659301758
2023-11-26 00:28:20,881 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:28:20,881 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 95.8
2023-11-26 00:28:20,882 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 6.20625
2023-11-26 00:28:20,883 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:20,883 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:20,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:28:20,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 20.39477472142068
2023-11-26 00:28:20,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1143828480
2023-11-26 00:28:20,884 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1148194816
2023-11-26 00:28:20,885 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1144101376.0
2023-11-26 00:28:20,885 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1143828480.0
2023-11-26 00:28:20,886 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1143828480.0
2023-11-26 00:28:20,886 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1143828480.0
2023-11-26 00:28:20,886 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 1056921.6632466193
2023-11-26 00:28:20,886 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13704871936
2023-11-26 00:28:20,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707984896
2023-11-26 00:28:20,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13705054080.0
2023-11-26 00:28:20,887 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13704871936.0
2023-11-26 00:28:20,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13704871936.0
2023-11-26 00:28:20,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13704871936.0
2023-11-26 00:28:20,888 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 707186.7249432784
2023-11-26 00:28:20,889 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 29.76619291305542, 'train.runtime': 2.373297929763794, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03786897659301758, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 95.8, 'mean.cpu_utilization': 6.20625, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 20.39477472142068, 'min.cpu_memory_rss': 1143828480, 'max.cpu_memory_rss': 1148194816, 'mean.cpu_memory_rss': 1144101376.0, '25th_prcntl.cpu_memory_rss': 1143828480.0, '50th_prcntl.cpu_memory_rss': 1143828480.0, '75th_prcntl.cpu_memory_rss': 1143828480.0, 'std.cpu_memory_rss': 1056921.6632466193, 'min.cpu_memory_vsz': 13704871936, 'max.cpu_memory_vsz': 13707984896, 'mean.cpu_memory_vsz': 13705054080.0, '25th_prcntl.cpu_memory_vsz': 13704871936.0, '50th_prcntl.cpu_memory_vsz': 13704871936.0, '75th_prcntl.cpu_memory_vsz': 13704871936.0, 'std.cpu_memory_vsz': 707186.7249432784, 'save_metrics.runtime': 0.009357929229736328}
2023-11-26 00:28:20,889 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:28:20,889 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008408069610595703
2023-11-26 00:28:20,889 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008408069610595703
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:28:20,890 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958500.8900342, tag: fetch
2023-11-26 00:28:20,890 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:28:20,890 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:28:20,890 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:28:20,891 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:28:20,891 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:28:20,891 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:28:20,891 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:28:20,891 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:28:20,891 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:20,892 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:28:20,892 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:28:20,892 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:28:20,892 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:28:20,892 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:28:27,322 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:28:27,323 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:28:27,323 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:28:27,323 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:04,797 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:04,800 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:04,801 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:04,801 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:04,803 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:04,805 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:04,806 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:04,806 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:04,806 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:04,806 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:29:04,806 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:04,807 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:29:04,808 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:04,810 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:04,811 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:04,811 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:04,812 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:29:04,812 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:04,812 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:29:04,812 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:29:04,813 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:29:04,815 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:04,816 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:04,817 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:04,817 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:04,820 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:04,821 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:04,835 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 15
2023-11-26 00:29:04,836 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:04,836 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 43.94619655609131
2023-11-26 00:29:04,836 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 43.94619655609131
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:04,984 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 2.726595
2023-11-26 00:29:05,841 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.757215
2023-11-26 00:29:06,618 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.846885
==== completed _train_epoch train()
2023-11-26 00:29:07,211 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.3751461505889893
2023-11-26 00:29:07,212 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.3751461505889893
2023-11-26 00:29:07,212 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.5762786865234375e-06
2023-11-26 00:29:07,212 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.5762786865234375e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:07,212 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958547.2127774, tag: upload
2023-11-26 00:29:07,212 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:29:07,213 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:07,214 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:07,214 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:07,215 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:07,215 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:07,215 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:07,215 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:07,215 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:07,215 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:07,215 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:07,216 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:07,216 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:07,216 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:07,234 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:07,235 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:07,235 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:07,236 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:07,239 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:07,239 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,241 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:07,241 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,241 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,244 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:07,244 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,244 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,244 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:07,244 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,244 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,245 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,245 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:07,245 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:07,246 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:07,246 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,247 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:07,247 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,247 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,248 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:07,248 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,248 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,248 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:07,248 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,248 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,248 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,248 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:07,248 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:07,249 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:07,249 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,249 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:07,249 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,249 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,251 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:07,251 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,251 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,251 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:07,251 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,251 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:07,251 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:07,252 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:07,252 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:07,252 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.039885759353637695
2023-11-26 00:29:07,252 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.039885759353637695
2023-11-26 00:29:07,253 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:07,253 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 94.9
2023-11-26 00:29:07,253 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.906382978723404
2023-11-26 00:29:07,254 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:07,255 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:07,255 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:07,256 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 21.268820494212406
2023-11-26 00:29:07,256 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1148235776
2023-11-26 00:29:07,256 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1148444672
2023-11-26 00:29:07,256 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1148249109.787234
2023-11-26 00:29:07,257 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1148235776.0
2023-11-26 00:29:07,257 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1148235776.0
2023-11-26 00:29:07,258 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1148235776.0
2023-11-26 00:29:07,258 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 51064.517387710985
2023-11-26 00:29:07,258 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:29:07,259 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707587584
2023-11-26 00:29:07,259 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707161948.595745
2023-11-26 00:29:07,259 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:29:07,260 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:29:07,260 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:29:07,261 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 111140.42019678272
2023-11-26 00:29:07,261 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 43.94619655609131, 'train.runtime': 2.3751461505889893, 'evaluate.runtime': 3.5762786865234375e-06, 'send.bytes': 2154215, 'upload.runtime': 0.039885759353637695, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 94.9, 'mean.cpu_utilization': 5.906382978723404, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 21.268820494212406, 'min.cpu_memory_rss': 1148235776, 'max.cpu_memory_rss': 1148444672, 'mean.cpu_memory_rss': 1148249109.787234, '25th_prcntl.cpu_memory_rss': 1148235776.0, '50th_prcntl.cpu_memory_rss': 1148235776.0, '75th_prcntl.cpu_memory_rss': 1148235776.0, 'std.cpu_memory_rss': 51064.517387710985, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13707587584, 'mean.cpu_memory_vsz': 13707161948.595745, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 111140.42019678272, 'save_metrics.runtime': 0.008408069610595703}
2023-11-26 00:29:07,261 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:07,261 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008695363998413086
2023-11-26 00:29:07,261 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008695363998413086
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:07,262 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958547.2621882, tag: fetch
2023-11-26 00:29:07,262 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:29:07,262 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:07,262 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:07,263 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:07,263 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:07,263 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:07,263 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:07,263 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:07,263 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:07,264 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:07,264 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:07,264 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:07,264 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:07,264 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:29:27,402 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:27,403 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:27,403 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:27,404 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,339 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,341 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,341 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,342 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,342 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,342 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:29:51,342 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,343 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:29:51,343 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,344 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:29:51,344 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,345 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,347 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,347 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,348 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,348 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,348 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:29:51,348 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,348 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:29:51,349 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,349 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:29:51,349 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,350 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,350 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,350 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,350 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,350 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:29:51,350 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:29:51,350 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:51,351 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:29:51,351 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:29:51,351 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:29:51,351 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:51,353 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:29:51,353 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:29:51,363 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 22
2023-11-26 00:29:51,364 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:29:51,364 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 44.102036476135254
2023-11-26 00:29:51,364 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 44.102036476135254
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:29:51,474 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 3.402117
2023-11-26 00:29:52,276 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.613658
2023-11-26 00:29:52,990 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.553118
==== completed _train_epoch train()
2023-11-26 00:29:53,554 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.1896040439605713
2023-11-26 00:29:53,554 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.1896040439605713
2023-11-26 00:29:53,554 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.337860107421875e-06
2023-11-26 00:29:53,555 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.337860107421875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:29:53,555 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958593.5552146, tag: upload
2023-11-26 00:29:53,555 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:29:53,556 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:53,556 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:53,557 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:53,557 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:53,557 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:53,558 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:53,558 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:53,558 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:53,558 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:29:53,558 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:53,559 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:53,559 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:53,559 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:53,574 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:29:53,574 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:29:53,574 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:29:53,575 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:29:53,581 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:53,581 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,583 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:53,583 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,583 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,586 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:53,586 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,586 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,586 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:53,587 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,587 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,587 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,587 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:53,588 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:29:53,589 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:53,589 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,590 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:53,590 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,590 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,591 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:53,591 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,591 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,591 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:53,591 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,591 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,592 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,592 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:53,592 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:29:53,592 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:53,592 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,593 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:53,593 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,593 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,594 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:29:53,594 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,594 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,595 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:29:53,595 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,595 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:29:53,595 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:29:53,595 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:29:53,595 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:29:53,596 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.0411372184753418
2023-11-26 00:29:53,596 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.0411372184753418
2023-11-26 00:29:53,597 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:29:53,597 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 87.8
2023-11-26 00:29:53,597 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 3.7543478260869563
2023-11-26 00:29:53,598 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:53,599 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:53,599 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:29:53,599 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 15.558636725259133
2023-11-26 00:29:53,600 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1148489728
2023-11-26 00:29:53,600 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1148506112
2023-11-26 00:29:53,600 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1148490440.347826
2023-11-26 00:29:53,600 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1148489728.0
2023-11-26 00:29:53,601 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1148489728.0
2023-11-26 00:29:53,601 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1148489728.0
2023-11-26 00:29:53,602 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3341.2074699542204
2023-11-26 00:29:53,602 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:29:53,602 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707587584
2023-11-26 00:29:53,602 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707152695.652174
2023-11-26 00:29:53,603 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:29:53,603 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:29:53,604 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:29:53,604 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 92718.50729122962
2023-11-26 00:29:53,604 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 44.102036476135254, 'train.runtime': 2.1896040439605713, 'evaluate.runtime': 3.337860107421875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.0411372184753418, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 87.8, 'mean.cpu_utilization': 3.7543478260869563, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 15.558636725259133, 'min.cpu_memory_rss': 1148489728, 'max.cpu_memory_rss': 1148506112, 'mean.cpu_memory_rss': 1148490440.347826, '25th_prcntl.cpu_memory_rss': 1148489728.0, '50th_prcntl.cpu_memory_rss': 1148489728.0, '75th_prcntl.cpu_memory_rss': 1148489728.0, 'std.cpu_memory_rss': 3341.2074699542204, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13707587584, 'mean.cpu_memory_vsz': 13707152695.652174, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 92718.50729122962, 'save_metrics.runtime': 0.008695363998413086}
2023-11-26 00:29:53,604 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:29:53,604 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008272171020507812
2023-11-26 00:29:53,605 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008272171020507812
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:29:53,605 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958593.605403, tag: fetch
2023-11-26 00:29:53,605 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:29:53,605 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:29:53,606 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:29:53,606 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:29:53,606 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:29:53,607 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:29:53,607 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:29:53,607 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:29:53,607 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:53,607 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:29:53,607 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:29:53,607 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:29:53,607 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:29:53,608 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:10,918 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:10,921 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:10,922 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:10,922 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:10,923 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:10,926 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:10,926 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:10,927 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:30:10,927 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:10,927 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:10,927 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:30:10,928 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:10,930 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:10,931 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:10,932 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:10,932 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:30:10,932 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:10,932 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:10,932 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:30:10,934 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:10,936 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:10,936 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:30:10,937 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:10,937 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:30:10,938 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:10,938 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:10,938 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:10,942 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:10,942 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:10,956 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 25
2023-11-26 00:30:10,957 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:10,957 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 17.35193181037903
2023-11-26 00:30:10,957 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 17.35193181037903
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:11,061 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 1.469363
2023-11-26 00:30:11,951 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.903731
2023-11-26 00:30:12,798 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.443097
==== completed _train_epoch train()
2023-11-26 00:30:13,425 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.4675042629241943
2023-11-26 00:30:13,425 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.4675042629241943
2023-11-26 00:30:13,426 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.0531158447265625e-06
2023-11-26 00:30:13,426 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.0531158447265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:13,426 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958613.426381, tag: upload
2023-11-26 00:30:13,426 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:30:13,427 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:13,427 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:13,428 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:13,428 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:13,429 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:13,429 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:13,429 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:13,429 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:13,429 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:13,429 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:13,429 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:13,430 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:13,430 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:13,445 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:13,446 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:13,446 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:13,447 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:13,454 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:13,454 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,456 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:13,456 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,456 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,459 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:13,460 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,460 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,460 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:13,460 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,460 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,460 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,460 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:13,461 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:13,462 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:13,462 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,463 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:13,463 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,463 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,463 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:13,464 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,464 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,464 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:13,464 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,464 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,464 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,464 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:13,464 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:13,464 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:13,464 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,465 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:13,465 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,465 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,467 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:13,467 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,467 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,467 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:13,467 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,467 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:13,468 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:13,468 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:13,468 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:13,468 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.042436838150024414
2023-11-26 00:30:13,468 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.042436838150024414
2023-11-26 00:30:13,469 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:13,469 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 88.8
2023-11-26 00:30:13,470 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 11.23
2023-11-26 00:30:13,470 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:13,471 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:13,471 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:30:13,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 26.094637380120844
2023-11-26 00:30:13,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1148497920
2023-11-26 00:30:13,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1148518400
2023-11-26 00:30:13,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1148500992.0
2023-11-26 00:30:13,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1148497920.0
2023-11-26 00:30:13,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1148497920.0
2023-11-26 00:30:13,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1148497920.0
2023-11-26 00:30:13,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 7312.822710827879
2023-11-26 00:30:13,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:30:13,474 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707984896
2023-11-26 00:30:13,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707240652.8
2023-11-26 00:30:13,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:13,475 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:13,476 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:13,476 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 266397.8067705513
2023-11-26 00:30:13,477 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 17.35193181037903, 'train.runtime': 2.4675042629241943, 'evaluate.runtime': 4.0531158447265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.042436838150024414, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 88.8, 'mean.cpu_utilization': 11.23, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 26.094637380120844, 'min.cpu_memory_rss': 1148497920, 'max.cpu_memory_rss': 1148518400, 'mean.cpu_memory_rss': 1148500992.0, '25th_prcntl.cpu_memory_rss': 1148497920.0, '50th_prcntl.cpu_memory_rss': 1148497920.0, '75th_prcntl.cpu_memory_rss': 1148497920.0, 'std.cpu_memory_rss': 7312.822710827879, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13707984896, 'mean.cpu_memory_vsz': 13707240652.8, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 266397.8067705513, 'save_metrics.runtime': 0.008272171020507812}
2023-11-26 00:30:13,477 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:13,477 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008133172988891602
2023-11-26 00:30:13,477 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008133172988891602
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:13,477 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958613.4776812, tag: fetch
2023-11-26 00:30:13,477 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:30:13,478 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:13,478 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:13,478 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:13,479 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:13,479 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:13,479 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:13,479 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:13,479 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:13,479 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:13,479 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:13,479 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:13,479 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:13,480 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:24,779 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:24,781 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:24,781 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:24,782 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:24,782 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:24,782 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:30:24,782 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:24,782 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:30:24,783 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:24,784 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:24,784 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:24,805 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:24,807 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:24,807 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:24,807 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:24,807 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:24,807 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:30:24,807 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:24,808 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:30:24,808 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:24,809 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:24,809 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:24,809 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:24,809 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:24,810 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:24,810 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:24,810 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:24,810 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:30:24,810 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:24,810 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:30:24,810 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:24,810 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:24,810 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:24,812 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:24,812 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:24,823 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 27
2023-11-26 00:30:24,824 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:24,824 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.346542119979858
2023-11-26 00:30:24,824 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.346542119979858
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:24,926 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 2.047355
2023-11-26 00:30:25,672 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.840088
2023-11-26 00:30:26,507 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 1.015309
==== completed _train_epoch train()
2023-11-26 00:30:27,139 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.3143935203552246
2023-11-26 00:30:27,139 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.3143935203552246
2023-11-26 00:30:27,139 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.337860107421875e-06
2023-11-26 00:30:27,139 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.337860107421875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:27,140 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958627.140184, tag: upload
2023-11-26 00:30:27,140 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:30:27,141 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:27,141 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:27,142 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:27,142 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:27,143 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:27,143 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:27,143 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:27,143 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:27,143 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:27,144 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:27,144 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:27,144 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:27,144 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:27,161 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:30:27,161 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:30:27,162 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:30:27,163 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:27,169 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,169 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,171 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,171 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,172 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,174 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,174 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,175 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,175 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,175 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,175 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,175 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,176 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:27,176 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:27,177 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,178 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,179 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,179 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,179 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,179 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,179 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,179 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,180 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,180 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,180 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,180 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,180 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:27,180 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:30:27,180 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,181 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,181 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,181 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,181 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,183 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,183 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,183 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,183 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,183 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,183 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:27,184 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:27,184 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:27,184 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:27,184 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04469776153564453
2023-11-26 00:30:27,185 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04469776153564453
2023-11-26 00:30:27,185 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:27,185 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 89.8
2023-11-26 00:30:27,186 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 16.585714285714285
2023-11-26 00:30:27,187 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:27,187 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:27,187 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 19.75
2023-11-26 00:30:27,188 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 30.701090188713334
2023-11-26 00:30:27,188 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149493248
2023-11-26 00:30:27,188 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149538304
2023-11-26 00:30:27,188 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149501147.4285715
2023-11-26 00:30:27,189 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149493248.0
2023-11-26 00:30:27,190 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149493248.0
2023-11-26 00:30:27,191 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149493248.0
2023-11-26 00:30:27,191 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 15671.017168711187
2023-11-26 00:30:27,191 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:30:27,191 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707587584
2023-11-26 00:30:27,192 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707197878.857143
2023-11-26 00:30:27,192 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:27,193 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:27,193 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:27,193 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 159096.4583564041
2023-11-26 00:30:27,194 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 11.346542119979858, 'train.runtime': 2.3143935203552246, 'evaluate.runtime': 3.337860107421875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04469776153564453, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 89.8, 'mean.cpu_utilization': 16.585714285714285, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 19.75, 'std.cpu_utilization': 30.701090188713334, 'min.cpu_memory_rss': 1149493248, 'max.cpu_memory_rss': 1149538304, 'mean.cpu_memory_rss': 1149501147.4285715, '25th_prcntl.cpu_memory_rss': 1149493248.0, '50th_prcntl.cpu_memory_rss': 1149493248.0, '75th_prcntl.cpu_memory_rss': 1149493248.0, 'std.cpu_memory_rss': 15671.017168711187, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13707587584, 'mean.cpu_memory_vsz': 13707197878.857143, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 159096.4583564041, 'save_metrics.runtime': 0.008133172988891602}
2023-11-26 00:30:27,194 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:27,194 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009184837341308594
2023-11-26 00:30:27,194 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009184837341308594
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:27,194 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958627.1948311, tag: fetch
2023-11-26 00:30:27,194 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:30:27,195 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:27,195 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:27,195 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:27,196 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:27,196 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:27,196 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:27,196 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:27,196 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:27,196 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:27,196 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:27,196 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:27,197 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:27,197 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:30:27,489 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:27,489 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:27,490 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:27,490 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,768 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,772 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,772 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,772 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,773 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,776 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,777 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,777 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:30:44,777 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,778 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,778 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:30:44,779 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,781 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:30:44,782 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,782 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,783 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:30:44,783 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,783 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,783 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:30:44,785 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:30:44,786 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:30:44,786 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:30:44,787 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:44,787 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:30:44,788 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:30:44,788 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:30:44,788 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:44,791 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:30:44,792 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:30:44,805 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 30
2023-11-26 00:30:44,806 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:30:44,806 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 17.611573219299316
2023-11-26 00:30:44,806 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 17.611573219299316
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:30:44,921 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 3.240997
2023-11-26 00:30:45,735 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 1.182649
2023-11-26 00:30:46,574 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.599518
==== completed _train_epoch train()
2023-11-26 00:30:47,223 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.416292667388916
2023-11-26 00:30:47,223 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.416292667388916
2023-11-26 00:30:47,223 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.337860107421875e-06
2023-11-26 00:30:47,224 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.337860107421875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:30:47,224 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958647.2241983, tag: upload
2023-11-26 00:30:47,224 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:30:47,225 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:47,225 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:47,225 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:47,226 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:47,226 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:47,226 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:47,227 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:47,227 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:47,227 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:30:47,227 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:47,227 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:47,227 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:47,227 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:47,243 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154213
2023-11-26 00:30:47,244 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154213
2023-11-26 00:30:47,244 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154213
2023-11-26 00:30:47,245 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:30:47,250 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:47,250 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,252 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:47,252 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,252 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,254 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:47,254 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,254 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,254 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:47,255 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,255 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,255 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,255 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:47,256 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:30:47,257 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:47,257 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,258 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:47,259 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,259 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,259 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:47,259 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,259 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,259 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:47,259 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,259 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,259 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,260 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:47,260 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57061
2023-11-26 00:30:47,261 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:47,261 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,261 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:47,261 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,261 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,261 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:30:47,261 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,261 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,262 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:30:47,262 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,262 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:30:47,262 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:30:47,262 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:30:47,262 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:30:47,262 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03878307342529297
2023-11-26 00:30:47,263 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03878307342529297
2023-11-26 00:30:47,263 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:30:47,263 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 87.8
2023-11-26 00:30:47,264 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 10.23
2023-11-26 00:30:47,265 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:47,265 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:30:47,266 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:30:47,266 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 25.870081174978942
2023-11-26 00:30:47,266 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149517824
2023-11-26 00:30:47,267 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149534208
2023-11-26 00:30:47,267 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149520281.6
2023-11-26 00:30:47,267 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149517824.0
2023-11-26 00:30:47,268 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149517824.0
2023-11-26 00:30:47,268 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149517824.0
2023-11-26 00:30:47,269 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 5850.2581686623025
2023-11-26 00:30:47,269 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:30:47,269 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707587584
2023-11-26 00:30:47,269 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707201126.4
2023-11-26 00:30:47,270 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:47,270 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:47,271 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:30:47,271 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 162344.6641803789
2023-11-26 00:30:47,271 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 17.611573219299316, 'train.runtime': 2.416292667388916, 'evaluate.runtime': 3.337860107421875e-06, 'send.bytes': 2154213, 'upload.runtime': 0.03878307342529297, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 87.8, 'mean.cpu_utilization': 10.23, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 25.870081174978942, 'min.cpu_memory_rss': 1149517824, 'max.cpu_memory_rss': 1149534208, 'mean.cpu_memory_rss': 1149520281.6, '25th_prcntl.cpu_memory_rss': 1149517824.0, '50th_prcntl.cpu_memory_rss': 1149517824.0, '75th_prcntl.cpu_memory_rss': 1149517824.0, 'std.cpu_memory_rss': 5850.2581686623025, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13707587584, 'mean.cpu_memory_vsz': 13707201126.4, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 162344.6641803789, 'save_metrics.runtime': 0.009184837341308594}
2023-11-26 00:30:47,271 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:30:47,272 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008672475814819336
2023-11-26 00:30:47,272 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008672475814819336
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:30:47,272 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958647.2724736, tag: fetch
2023-11-26 00:30:47,272 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:30:47,272 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:30:47,273 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:30:47,273 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:30:47,273 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:30:47,273 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:30:47,273 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:30:47,273 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:30:47,273 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:47,273 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:30:47,273 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:30:47,273 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:30:47,273 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:30:47,274 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:03,528 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,531 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,532 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,532 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,533 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,535 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,535 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,535 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:31:03,536 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,536 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,536 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:31:03,537 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,537 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:03,538 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,538 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,538 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:31:03,538 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,538 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,538 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:31:03,539 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:03,540 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:03,540 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:31:03,540 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:03,540 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:31:03,541 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:03,541 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:03,541 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:03,542 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:03,543 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:03,557 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 33
2023-11-26 00:31:03,557 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:03,557 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 16.285295486450195
2023-11-26 00:31:03,557 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 16.285295486450195
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:03,638 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 1.549873
2023-11-26 00:31:04,395 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.667094
2023-11-26 00:31:05,147 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.546343
==== completed _train_epoch train()
2023-11-26 00:31:05,782 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.224249839782715
2023-11-26 00:31:05,782 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.224249839782715
2023-11-26 00:31:05,783 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.291534423828125e-06
2023-11-26 00:31:05,783 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.291534423828125e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:05,783 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958665.7834754, tag: upload
2023-11-26 00:31:05,783 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:31:05,784 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:05,784 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:05,784 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:05,785 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:05,785 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:05,785 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:05,785 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:05,785 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:05,785 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:05,785 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:05,785 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:05,785 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:05,785 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:05,797 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:05,798 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:05,798 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:05,799 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:05,802 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:05,802 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,804 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:05,804 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,804 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,807 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:05,807 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,807 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,807 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:05,807 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,807 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,807 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,807 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:05,807 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:05,809 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:05,809 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,809 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:05,810 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,810 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,810 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:05,810 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,810 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,810 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:05,810 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,810 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,810 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,811 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:05,811 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:05,811 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:05,811 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,811 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:05,811 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,811 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,813 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:05,813 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,813 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,813 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:05,813 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,813 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:05,814 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:05,814 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:05,814 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:05,814 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.031145572662353516
2023-11-26 00:31:05,814 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.031145572662353516
2023-11-26 00:31:05,815 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:05,815 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 90.8
2023-11-26 00:31:05,815 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.372222222222222
2023-11-26 00:31:05,816 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:05,817 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:05,817 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:05,818 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 23.35517562329733
2023-11-26 00:31:05,818 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149517824
2023-11-26 00:31:05,818 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149538304
2023-11-26 00:31:05,818 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149519872.0
2023-11-26 00:31:05,818 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149517824.0
2023-11-26 00:31:05,819 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149517824.0
2023-11-26 00:31:05,819 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149517824.0
2023-11-26 00:31:05,820 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 5832.706556803434
2023-11-26 00:31:05,820 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:31:05,820 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707980800
2023-11-26 00:31:05,820 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707205290.666666
2023-11-26 00:31:05,821 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:31:05,821 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:31:05,821 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:31:05,822 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 214908.8446595181
2023-11-26 00:31:05,822 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 16.285295486450195, 'train.runtime': 2.224249839782715, 'evaluate.runtime': 4.291534423828125e-06, 'send.bytes': 2154215, 'upload.runtime': 0.031145572662353516, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 90.8, 'mean.cpu_utilization': 8.372222222222222, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 23.35517562329733, 'min.cpu_memory_rss': 1149517824, 'max.cpu_memory_rss': 1149538304, 'mean.cpu_memory_rss': 1149519872.0, '25th_prcntl.cpu_memory_rss': 1149517824.0, '50th_prcntl.cpu_memory_rss': 1149517824.0, '75th_prcntl.cpu_memory_rss': 1149517824.0, 'std.cpu_memory_rss': 5832.706556803434, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13707980800, 'mean.cpu_memory_vsz': 13707205290.666666, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 214908.8446595181, 'save_metrics.runtime': 0.008672475814819336}
2023-11-26 00:31:05,822 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:05,822 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.007742166519165039
2023-11-26 00:31:05,822 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.007742166519165039
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:05,823 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958665.823124, tag: fetch
2023-11-26 00:31:05,823 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:31:05,823 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:05,823 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:05,823 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:05,824 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:05,824 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:05,824 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:05,824 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:05,824 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:05,824 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:05,824 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:05,824 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:05,824 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:05,824 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:31:27,573 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:27,573 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:27,574 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:27,574 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,259 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,262 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,263 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,263 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,264 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,267 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,267 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,267 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:31:30,268 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,268 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,268 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:31:30,269 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,271 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:31:30,272 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,273 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,273 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:31:30,273 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,274 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,274 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:31:30,276 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:31:30,277 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:31:30,277 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:30,278 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:31:30,278 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:31:30,278 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:30,277 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:31:30,279 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:31:30,281 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:31:30,281 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:31:30,290 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 37
2023-11-26 00:31:30,290 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:31:30,290 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 24.467606782913208
2023-11-26 00:31:30,290 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 24.467606782913208
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:31:30,380 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 4.142978
2023-11-26 00:31:31,188 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.977000
2023-11-26 00:31:31,929 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.863060
==== completed _train_epoch train()
2023-11-26 00:31:32,472 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.1812965869903564
2023-11-26 00:31:32,472 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.1812965869903564
2023-11-26 00:31:32,473 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 4.5299530029296875e-06
2023-11-26 00:31:32,473 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 4.5299530029296875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:31:32,473 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958692.4735076, tag: upload
2023-11-26 00:31:32,473 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:31:32,474 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:32,474 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:32,475 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:32,476 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:32,476 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:32,476 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:32,476 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:32,476 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:32,476 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:31:32,476 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:32,476 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:32,477 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:32,477 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:32,492 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:31:32,493 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:31:32,493 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:31:32,493 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:31:32,497 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:32,498 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,500 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:32,500 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,500 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,501 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:32,502 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,502 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,502 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:32,502 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,502 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,502 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,502 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:32,503 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:31:32,504 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:32,504 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,505 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:32,505 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,505 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,505 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:32,505 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,505 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,505 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:32,506 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,506 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,506 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,506 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:32,506 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:31:32,506 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:32,506 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,506 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:32,506 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,507 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,508 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:31:32,508 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,508 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,508 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:31:32,508 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,508 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:31:32,509 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:31:32,509 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:31:32,509 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:31:32,509 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03627133369445801
2023-11-26 00:31:32,509 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03627133369445801
2023-11-26 00:31:32,510 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:31:32,510 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 83.8
2023-11-26 00:31:32,511 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.092592592592593
2023-11-26 00:31:32,512 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:32,512 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:31:32,513 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.5
2023-11-26 00:31:32,513 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 22.85984553147523
2023-11-26 00:31:32,514 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149575168
2023-11-26 00:31:32,514 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149595648
2023-11-26 00:31:32,514 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149576685.0370371
2023-11-26 00:31:32,514 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149575168.0
2023-11-26 00:31:32,515 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149575168.0
2023-11-26 00:31:32,516 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149575168.0
2023-11-26 00:31:32,516 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 5363.535881000183
2023-11-26 00:31:32,516 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:31:32,516 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13707984896
2023-11-26 00:31:32,516 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707181321.481482
2023-11-26 00:31:32,517 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:31:32,518 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:31:32,518 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:31:32,518 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 179436.30532068628
2023-11-26 00:31:32,519 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 24.467606782913208, 'train.runtime': 2.1812965869903564, 'evaluate.runtime': 4.5299530029296875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03627133369445801, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 83.8, 'mean.cpu_utilization': 8.092592592592593, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.5, 'std.cpu_utilization': 22.85984553147523, 'min.cpu_memory_rss': 1149575168, 'max.cpu_memory_rss': 1149595648, 'mean.cpu_memory_rss': 1149576685.0370371, '25th_prcntl.cpu_memory_rss': 1149575168.0, '50th_prcntl.cpu_memory_rss': 1149575168.0, '75th_prcntl.cpu_memory_rss': 1149575168.0, 'std.cpu_memory_rss': 5363.535881000183, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13707984896, 'mean.cpu_memory_vsz': 13707181321.481482, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 179436.30532068628, 'save_metrics.runtime': 0.007742166519165039}
2023-11-26 00:31:32,519 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:31:32,519 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.009482860565185547
2023-11-26 00:31:32,519 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.009482860565185547
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:31:32,520 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958692.5201375, tag: fetch
2023-11-26 00:31:32,520 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:31:32,520 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:31:32,520 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:31:32,521 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:31:32,521 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:31:32,521 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:31:32,521 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:31:32,521 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:31:32,521 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:32,521 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:31:32,521 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:31:32,522 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:31:32,522 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:31:32,522 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:03,640 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,642 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,642 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,642 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,642 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,642 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:32:03,642 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,643 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:32:03,643 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,644 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:03,644 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,649 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,651 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,651 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,651 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,652 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,652 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:03,652 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:32:03,652 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:03,652 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:32:03,652 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:32:03,653 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:32:03,653 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:03,654 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:03,653 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:03,654 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:03,656 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:03,656 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:03,665 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 42
2023-11-26 00:32:03,665 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:03,665 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 31.145446300506592
2023-11-26 00:32:03,665 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 31.145446300506592
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:03,779 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 1.802645
2023-11-26 00:32:04,590 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.700343
2023-11-26 00:32:05,358 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.655793
==== completed _train_epoch train()
2023-11-26 00:32:05,983 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.3180909156799316
2023-11-26 00:32:05,984 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.3180909156799316
2023-11-26 00:32:05,984 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.337860107421875e-06
2023-11-26 00:32:05,984 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.337860107421875e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:05,985 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958725.9850125, tag: upload
2023-11-26 00:32:05,985 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:32:05,985 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:05,986 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:05,986 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:05,986 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:05,986 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:05,986 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:05,986 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:05,986 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:05,987 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:05,987 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:05,987 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:05,987 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:05,987 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:05,998 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:05,998 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:05,998 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:05,999 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:06,003 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:06,003 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,004 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:06,005 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,005 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,007 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:06,008 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,008 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,008 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:06,008 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,008 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,008 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,008 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:06,008 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:06,009 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:06,009 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,010 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:06,010 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,010 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,011 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:06,011 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,011 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,011 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:06,011 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,011 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,011 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,011 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:06,011 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:06,011 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:06,011 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,012 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:06,012 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,012 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,014 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:06,014 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,014 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,014 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:06,014 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,015 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:06,015 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:06,015 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:06,015 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:06,016 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.031151533126831055
2023-11-26 00:32:06,016 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.031151533126831055
2023-11-26 00:32:06,016 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:06,017 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 89.8
2023-11-26 00:32:06,017 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 5.051515151515151
2023-11-26 00:32:06,018 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:06,018 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:06,019 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:06,019 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 17.684578476348655
2023-11-26 00:32:06,019 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149575168
2023-11-26 00:32:06,020 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1149591552
2023-11-26 00:32:06,020 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149576160.969697
2023-11-26 00:32:06,020 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149575168.0
2023-11-26 00:32:06,021 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149575168.0
2023-11-26 00:32:06,021 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149575168.0
2023-11-26 00:32:06,021 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 3909.3256062972578
2023-11-26 00:32:06,022 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:32:06,022 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708378112
2023-11-26 00:32:06,022 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707184438.30303
2023-11-26 00:32:06,022 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:32:06,023 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:32:06,023 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:32:06,024 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 224933.39072557038
2023-11-26 00:32:06,024 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 31.145446300506592, 'train.runtime': 2.3180909156799316, 'evaluate.runtime': 3.337860107421875e-06, 'send.bytes': 2154215, 'upload.runtime': 0.031151533126831055, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 89.8, 'mean.cpu_utilization': 5.051515151515151, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.0, 'std.cpu_utilization': 17.684578476348655, 'min.cpu_memory_rss': 1149575168, 'max.cpu_memory_rss': 1149591552, 'mean.cpu_memory_rss': 1149576160.969697, '25th_prcntl.cpu_memory_rss': 1149575168.0, '50th_prcntl.cpu_memory_rss': 1149575168.0, '75th_prcntl.cpu_memory_rss': 1149575168.0, 'std.cpu_memory_rss': 3909.3256062972578, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13708378112, 'mean.cpu_memory_vsz': 13707184438.30303, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 224933.39072557038, 'save_metrics.runtime': 0.009482860565185547}
2023-11-26 00:32:06,024 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:06,024 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008202075958251953
2023-11-26 00:32:06,024 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008202075958251953
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:06,025 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958726.0251415, tag: fetch
2023-11-26 00:32:06,025 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:32:06,025 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:06,025 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:06,025 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:06,026 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:06,026 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:06,026 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:06,026 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:06,026 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:06,026 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:06,026 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:06,026 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:06,026 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:06,026 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:22,561 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:22,563 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:22,564 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:22,564 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:22,564 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:22,564 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:32:22,564 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:22,564 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:32:22,565 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:22,566 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:22,566 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:22,580 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:22,582 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:22,582 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:22,582 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:22,582 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:22,582 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:32:22,583 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:22,583 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:32:22,583 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:22,583 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:22,584 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:22,585 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:22,585 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:22,585 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:22,585 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:22,585 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:22,586 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:32:22,586 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:22,586 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:32:22,586 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:22,586 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:22,587 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:22,589 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:22,589 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:22,595 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 45
2023-11-26 00:32:22,595 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:22,595 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 16.570151567459106
2023-11-26 00:32:22,595 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 16.570151567459106
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:22,711 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 3.892156
2023-11-26 00:32:23,528 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.750544
2023-11-26 00:32:24,366 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.681834
==== completed _train_epoch train()
2023-11-26 00:32:24,959 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.3641743659973145
2023-11-26 00:32:24,960 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.3641743659973145
2023-11-26 00:32:24,960 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:32:24,960 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:24,960 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958744.9608428, tag: upload
2023-11-26 00:32:24,961 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:32:24,961 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:24,962 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:24,962 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:24,963 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:24,963 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:24,963 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:24,963 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:24,963 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:24,963 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:24,964 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:24,964 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:24,964 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:24,964 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:24,978 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:24,979 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:24,979 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:24,980 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:24,986 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:24,986 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,988 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:24,988 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,988 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,991 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:24,991 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,991 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,992 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:24,992 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,992 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,992 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,992 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:24,992 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:24,994 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:24,994 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,994 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:24,995 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,995 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,995 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:24,995 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,995 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,995 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:24,995 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,995 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,995 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,995 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:24,996 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:24,996 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:24,996 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,996 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:24,996 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,996 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,998 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:24,998 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,998 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,998 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:24,999 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,999 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:24,999 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:24,999 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:24,999 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:24,999 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.03903651237487793
2023-11-26 00:32:25,000 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.03903651237487793
2023-11-26 00:32:25,000 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:25,000 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 84.8
2023-11-26 00:32:25,001 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 10.921052631578947
2023-11-26 00:32:25,002 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:25,002 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:25,002 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 1.0
2023-11-26 00:32:25,003 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 25.235283964851746
2023-11-26 00:32:25,003 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1149616128
2023-11-26 00:32:25,003 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152434176
2023-11-26 00:32:25,003 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1149891853.4736843
2023-11-26 00:32:25,004 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1149616128.0
2023-11-26 00:32:25,004 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1149616128.0
2023-11-26 00:32:25,005 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1149616128.0
2023-11-26 00:32:25,005 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 806450.674318638
2023-11-26 00:32:25,005 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707132928
2023-11-26 00:32:25,005 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708173312
2023-11-26 00:32:25,006 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707242442.105263
2023-11-26 00:32:25,006 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:32:25,006 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:32:25,007 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707132928.0
2023-11-26 00:32:25,007 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 319285.7397982491
2023-11-26 00:32:25,007 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 16.570151567459106, 'train.runtime': 2.3641743659973145, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.03903651237487793, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 84.8, 'mean.cpu_utilization': 10.921052631578947, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 1.0, 'std.cpu_utilization': 25.235283964851746, 'min.cpu_memory_rss': 1149616128, 'max.cpu_memory_rss': 1152434176, 'mean.cpu_memory_rss': 1149891853.4736843, '25th_prcntl.cpu_memory_rss': 1149616128.0, '50th_prcntl.cpu_memory_rss': 1149616128.0, '75th_prcntl.cpu_memory_rss': 1149616128.0, 'std.cpu_memory_rss': 806450.674318638, 'min.cpu_memory_vsz': 13707132928, 'max.cpu_memory_vsz': 13708173312, 'mean.cpu_memory_vsz': 13707242442.105263, '25th_prcntl.cpu_memory_vsz': 13707132928.0, '50th_prcntl.cpu_memory_vsz': 13707132928.0, '75th_prcntl.cpu_memory_vsz': 13707132928.0, 'std.cpu_memory_vsz': 319285.7397982491, 'save_metrics.runtime': 0.008202075958251953}
2023-11-26 00:32:25,008 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:25,008 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.008027315139770508
2023-11-26 00:32:25,008 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.008027315139770508
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:25,008 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958745.0086741, tag: fetch
2023-11-26 00:32:25,008 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:32:25,009 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:25,009 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:25,009 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:25,010 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:25,010 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:25,010 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:25,010 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:25,010 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:25,010 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:25,010 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:25,010 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:25,010 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:25,011 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:32:27,654 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:27,654 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:27,655 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:27,655 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,472 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,476 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,476 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,476 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,479 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,482 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,482 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,483 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,483 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,483 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:32:49,483 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,484 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048675
2023-11-26 00:32:49,485 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,487 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 1048576
2023-11-26 00:32:49,488 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,488 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:32:49,488 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:32:49,489 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:49,489 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:32:49,489 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 1048677
2023-11-26 00:32:49,490 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371; len: 57155
2023-11-26 00:32:49,492 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 1: 1048576
2023-11-26 00:32:49,493 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:32:49,493 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 2: 57052
2023-11-26 00:32:49,493 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:49,497 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 2154204
2023-11-26 00:32:49,497 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 2154204
extracting weights from message
2023-11-26 00:32:49,512 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: False, round: 49
2023-11-26 00:32:49,512 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:32:49,513 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 24.504324197769165
2023-11-26 00:32:49,513 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 24.504324197769165
~~ inside train, calling train_epoch
==== started _train_epoch train()
2023-11-26 00:32:49,637 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [0/8920 (0%)]	loss: 2.511576
2023-11-26 00:32:50,450 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [3200/8920 (36%)]	loss: 0.658771
2023-11-26 00:32:51,295 | main.py:197 | INFO | MainThread | _train_epoch | epoch: 1 [6400/8920 (72%)]	loss: 0.420585
==== completed _train_epoch train()
2023-11-26 00:32:51,915 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[train.runtime] = 2.4024951457977295
2023-11-26 00:32:51,916 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of train is 2.4024951457977295
2023-11-26 00:32:51,916 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[evaluate.runtime] = 3.814697265625e-06
2023-11-26 00:32:51,916 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of evaluate is 3.814697265625e-06
### SEND WEIGHTS for tag:  upload
2023-11-26 00:32:51,917 | trainer.py:174 | DEBUG | MainThread | _send_weights | calling _send_weights, time: 1700958771.9170299, tag: upload
2023-11-26 00:32:51,917 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | upload through param-channel
_send_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:32:51,918 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:51,918 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:51,918 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:51,919 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:51,919 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:51,919 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:51,919 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,920 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,920 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: recvd
2023-11-26 00:32:51,920 | fedbuff.py:126 | INFO | Thread-3 | _handle_send_state | c: 1, ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,920 | fedbuff.py:155 | DEBUG | Thread-3 | _handle_send_state | candidates: ['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'], all_selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:51,920 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,920 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:51,935 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[send.bytes] = 2154215
2023-11-26 00:32:51,935 | channel.py:213 | DEBUG | Thread-3 | _put | length of payload = 2154215
2023-11-26 00:32:51,936 | chunk_store.py:56 | DEBUG | Thread-3 | set_data | setting data of size 2154215
2023-11-26 00:32:51,937 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 0: 1048576
2023-11-26 00:32:51,942 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,942 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,944 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,944 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,944 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,947 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,947 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,948 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,948 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,948 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,948 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,948 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,948 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 0 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,948 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 1: 1048576
2023-11-26 00:32:51,950 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,951 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,953 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,953 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,953 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,953 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,953 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,953 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,953 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,953 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,953 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,954 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,954 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 1 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,954 | chunk_store.py:89 | DEBUG | Thread-3 | get_chunk | chunk 2: 57063
2023-11-26 00:32:51,954 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,954 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,954 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,954 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,954 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,956 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:32:51,956 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,957 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,957 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:32:51,957 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,957 | mqtt.py:469 | DEBUG | Thread-3 | send_chunk | waiting for publish completion: rc = 0
2023-11-26 00:32:51,957 | mqtt.py:471 | DEBUG | Thread-3 | send_chunk | retval from loop = 0
2023-11-26 00:32:51,957 | mqtt.py:473 | DEBUG | Thread-3 | send_chunk | sending chunk 2 to /flame/622a358619ab59012eabeefb/param-channel/default/UNICAST/trainer/505f9fc483cf4df68a2409257b5fad7d3c580371/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742 is done
2023-11-26 00:32:51,957 | trainer.py:200 | DEBUG | MainThread | _send_weights | sending weights done
2023-11-26 00:32:51,958 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[upload.runtime] = 0.04116415977478027
2023-11-26 00:32:51,958 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of upload is 0.04116415977478027
2023-11-26 00:32:51,958 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_utilization] = 0.0
2023-11-26 00:32:51,959 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_utilization] = 89.8
2023-11-26 00:32:51,959 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_utilization] = 8.355555555555556
2023-11-26 00:32:51,960 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:51,960 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_utilization] = 0.0
2023-11-26 00:32:51,961 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_utilization] = 0.5
2023-11-26 00:32:51,961 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_utilization] = 23.523547435508476
2023-11-26 00:32:51,962 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_rss] = 1152016384
2023-11-26 00:32:51,962 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_rss] = 1152245760
2023-11-26 00:32:51,962 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_rss] = 1152033374.8148148
2023-11-26 00:32:51,962 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_rss] = 1152016384.0
2023-11-26 00:32:51,963 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_rss] = 1152016384.0
2023-11-26 00:32:51,963 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_rss] = 1152016384.0
2023-11-26 00:32:51,964 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_rss] = 60071.601867202044
2023-11-26 00:32:51,964 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[min.cpu_memory_vsz] = 13707718656
2023-11-26 00:32:51,964 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[max.cpu_memory_vsz] = 13708173312
2023-11-26 00:32:51,964 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[mean.cpu_memory_vsz] = 13707752334.222221
2023-11-26 00:32:51,965 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[25th_prcntl.cpu_memory_vsz] = 13707718656.0
2023-11-26 00:32:51,965 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[50th_prcntl.cpu_memory_vsz] = 13707718656.0
2023-11-26 00:32:51,966 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[75th_prcntl.cpu_memory_vsz] = 13707718656.0
2023-11-26 00:32:51,966 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[std.cpu_memory_vsz] = 119070.49655820405
2023-11-26 00:32:51,966 | trainer.py:207 | DEBUG | MainThread | save_metrics | saving metrics: {'internal_init.runtime': 0.009078264236450195, 'load_data.runtime': 0.9041342735290527, 'init.runtime': 1.2976725101470947, 'recv.bytes': 2154204, 'fetch.runtime': 24.504324197769165, 'train.runtime': 2.4024951457977295, 'evaluate.runtime': 3.814697265625e-06, 'send.bytes': 2154215, 'upload.runtime': 0.04116415977478027, 'min.cpu_utilization': 0.0, 'max.cpu_utilization': 89.8, 'mean.cpu_utilization': 8.355555555555556, '25th_prcntl.cpu_utilization': 0.0, '50th_prcntl.cpu_utilization': 0.0, '75th_prcntl.cpu_utilization': 0.5, 'std.cpu_utilization': 23.523547435508476, 'min.cpu_memory_rss': 1152016384, 'max.cpu_memory_rss': 1152245760, 'mean.cpu_memory_rss': 1152033374.8148148, '25th_prcntl.cpu_memory_rss': 1152016384.0, '50th_prcntl.cpu_memory_rss': 1152016384.0, '75th_prcntl.cpu_memory_rss': 1152016384.0, 'std.cpu_memory_rss': 60071.601867202044, 'min.cpu_memory_vsz': 13707718656, 'max.cpu_memory_vsz': 13708173312, 'mean.cpu_memory_vsz': 13707752334.222221, '25th_prcntl.cpu_memory_vsz': 13707718656.0, '50th_prcntl.cpu_memory_vsz': 13707718656.0, '75th_prcntl.cpu_memory_vsz': 13707718656.0, 'std.cpu_memory_vsz': 119070.49655820405, 'save_metrics.runtime': 0.008027315139770508}
2023-11-26 00:32:51,967 | trainer.py:210 | DEBUG | MainThread | save_metrics | saving metrics done
2023-11-26 00:32:51,967 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[save_metrics.runtime] = 0.00861501693725586
2023-11-26 00:32:51,967 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of save_metrics is 0.00861501693725586
### FETCH WEIGHTS start for tag:  fetch
2023-11-26 00:32:51,967 | trainer.py:117 | DEBUG | MainThread | _fetch_weights | calling _fetch_weights, time: 1700958771.9676104, tag: fetch
2023-11-26 00:32:51,967 | channel_manager.py:170 | DEBUG | MainThread | get_by_tag | fetch through param-channel
_fetch_weights: waiting for someone to join channel:  <flame.channel.Channel object at 0x7f2c2ca1a670>
2023-11-26 00:32:51,968 | channel.py:435 | DEBUG | Thread-3 | _inner | waiting for join
2023-11-26 00:32:51,968 | channel.py:441 | DEBUG | Thread-3 | _inner | at least one peer joined
2023-11-26 00:32:51,968 | channel.py:445 | DEBUG | MainThread | await_join | timeouted = False
2023-11-26 00:32:51,969 | fedbuff.py:63 | DEBUG | Thread-3 | select | calling fedbuff select
2023-11-26 00:32:51,969 | fedbuff.py:64 | DEBUG | Thread-3 | select | len(ends): 1, c: 10
2023-11-26 00:32:51,969 | fedbuff.py:99 | DEBUG | Thread-3 | _cleanup_recvd_ends | clean up recvd ends
2023-11-26 00:32:51,969 | fedbuff.py:100 | DEBUG | Thread-3 | _cleanup_recvd_ends | ends: dict_keys(['49d06b7526964db86cf37c70e8e0cdb6bd7aa742'])
2023-11-26 00:32:51,969 | fedbuff.py:101 | DEBUG | Thread-3 | _cleanup_recvd_ends | selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,969 | fedbuff.py:114 | DEBUG | Thread-3 | _cleanup_recvd_ends | end id 49d06b7526964db86cf37c70e8e0cdb6bd7aa742 state: 
2023-11-26 00:32:51,969 | fedbuff.py:179 | DEBUG | Thread-3 | _handle_recv_state | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}
2023-11-26 00:32:51,969 | fedbuff.py:90 | DEBUG | Thread-3 | select | requester: 505f9fc483cf4df68a2409257b5fad7d3c580371, selected ends: {'505f9fc483cf4df68a2409257b5fad7d3c580371': {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742'}}
2023-11-26 00:32:51,969 | fedbuff.py:93 | INFO | Thread-3 | select | results: {'49d06b7526964db86cf37c70e8e0cdb6bd7aa742': None}
2023-11-26 00:32:51,970 | channel.py:222 | DEBUG | MainThread | recv | will receive data from 49d06b7526964db86cf37c70e8e0cdb6bd7aa742
2023-11-26 00:33:03,068 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,069 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,069 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,070 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,070 | mqtt.py:517 | DEBUG | Thread-3 | cb | Socket is readable, calling loop_read
2023-11-26 00:33:03,070 | mqtt.py:306 | DEBUG | Thread-3 | on_message | topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,071 | mqtt.py:531 | DEBUG | Thread-3 | on_socket_register_write | Watching socket for writability.
2023-11-26 00:33:03,071 | mqtt.py:275 | DEBUG | Thread-3 | _rx_task | _rx_task - topic: /flame/622a358619ab59012eabeefb/param-channel/default/BROADCAST/aggregator/49d06b7526964db86cf37c70e8e0cdb6bd7aa742; len: 156
2023-11-26 00:33:03,071 | mqtt.py:534 | DEBUG | Thread-3 | cb | Socket is writable, calling loop_write
2023-11-26 00:33:03,072 | chunk_store.py:103 | DEBUG | Thread-4 | assemble | chunk 0: 59
2023-11-26 00:33:03,072 | mqtt.py:541 | DEBUG | Thread-3 | on_socket_unregister_write | Stop watching socket for writability.
2023-11-26 00:33:03,073 | chunk_manager.py:71 | DEBUG | Thread-3 | inner | fully assembled data size = 59
2023-11-26 00:33:03,073 | metric_collector.py:120 | DEBUG | Thread-3 | accumulate | Accumulating metric state_dict[recv.bytes] = 59
extracting weights from message
2023-11-26 00:33:03,074 | trainer.py:164 | DEBUG | MainThread | _fetch_weights | work_done: True, round: 49
2023-11-26 00:33:03,074 | trainer.py:165 | DEBUG | MainThread | _fetch_weights | fetch weight success: True
2023-11-26 00:33:03,074 | metric_collector.py:115 | DEBUG | MainThread | save | Saving state_dict[fetch.runtime] = 11.107091426849365
2023-11-26 00:33:03,074 | runtime.py:33 | DEBUG | MainThread | wrapper | Runtime of fetch is 11.107091426849365
2023-11-26 00:33:03,075 | composer.py:145 | DEBUG | MainThread | run | end of run
2023-11-26 00:33:03,077 | channel_manager.py:187 | DEBUG | MainThread | cleanup | calling cleanup
2023-11-26 00:33:03,077 | channel_manager.py:189 | DEBUG | MainThread | cleanup | calling leave for channel param-channel
2023-11-26 00:33:03,078 | channel.py:414 | DEBUG | MainThread | leave | calling channel leave for param-channel
2023-11-26 00:33:03,078 | channel.py:420 | DEBUG | MainThread | leave |  channel leave done for param-channel
2023-11-26 00:33:03,079 | mqtt.py:552 | DEBUG | Thread-3 | misc_loop | misc_loop finished
2023-11-26 00:33:03,079 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-2
2023-11-26 00:33:03,079 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-8
2023-11-26 00:33:03,080 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-7
2023-11-26 00:33:03,080 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-98
2023-11-26 00:33:03,080 | channel_manager.py:198 | DEBUG | Thread-3 | _inner | successfully cancelled Task-4
2023-11-26 00:33:03,080 | channel_manager.py:200 | DEBUG | Thread-3 | _inner | done with cleaning up asyncio tasks
